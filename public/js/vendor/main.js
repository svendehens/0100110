function GridElement(t,e){this.index=t,this.window=e,this.mode="search",this.window.getContainer().find(".change_to_wiki").css("display","none"),this.window.getContainer().find(".grid_index").val(t)}GridElement.prototype.getX=function(){return this.window.getContainer().css("top")},GridElement.prototype.getY=function(){return this.window.getContainer().css("left")},GridElement.prototype.getResultContainer=function(){return this.window.getContainer().find(".result_container")},GridElement.prototype.getSearchBox=function(){return this.window.getContainer().find(".search_box")},GridElement.prototype.getNoteBox=function(){return this.window.getContainer().find(".note_box")},GridElement.prototype.getTextContent=function(){return this.window.getContainer().find(".results_box p").text()},GridElement.prototype.changeMode=function(t){if(t!=this.mode){var e=this.window.getContainer();switch(t){case"search_result":e.find(".change_to_note").css("display","none"),e.find(".change_to_wiki").css("display","inline");break;case"note":e.find(".search_box").remove(),e.find(".results_box").remove(),$("<textarea/>").addClass("note_box").insertAfter(e.find(".checkboxes")),e.find(".change_to_note").css("display","none"),e.find(".change_to_wiki").css("display","none")}this.mode=t}},GridElement.prototype.toJson=function(){var t=this;return t.x=Math.round(this.getX().replace("px","")),t.y=Math.round(this.getY().replace("px","")),t.html_content=this.window.getContainer().find(".result_container").html(),t.scroll=Math.round(this.window.getContainer().find(".window_frame").scrollTop()),t};var txtwiki=function(){function t(t,e,n,i){if(t.slice(e,e+n.length)==n){e+=n.length;var o=t.indexOf(i,e);return-1==o&&(o=t.length),{text:t.slice(e,o),pos:o+i.length}}return{text:null,pos:e}}function e(t,n){if("[["==t.slice(n,n+2)){var i="";for(n+=2;"]]"!=t.slice(n,n+2);)if("[["==t.slice(n,n+2)){var o=e(t,n);i+=o.text,n=o.pos}else i+=t[n],n++;n+=2;var r=i.split("|");return 1==r.length?{text:r[0],pos:n}:"File:"==r[0].slice(0,5)?{text:"",pos:n}:{text:r[1],pos:n}}return{text:null,pos:n}}function n(t,e){if("<ref"==t.slice(e,e+4)){e+=4;var n=t.slice(e),i=n.search(/<\/ref>|\/>/);return"</ref>"==n.slice(i,i+6)?{text:n.slice(0,i),pos:e+i+6}:{text:n.slice(0,i),pos:e+i+2}}return{text:null,pos:e}}function i(t){for(var e=[],n=0,i=0,o=t,r=0,a=0;-1!==(r=o.search(/''([^']|$)/));)a+=r,"'''"===o.slice(r-3,r)?(e.push({pos:a-3,type:"b"}),e.push({pos:a,type:"i"}),i+=1,n+=1):"'"===o[r-1]?(e.push({pos:a-1,type:"b"}),i+=1):(e.push({pos:a,type:"i"}),n+=1),a+=2,o=o.slice(r+2);if(i%2+n%2==2)for(r=0;r<e.length;r++)if("b"===e[r].type&&(void 0===e[r+1]||e[r+1].pos-e[r].pos!=3)){(" "===t[(a=e[r].pos)-2]&&" "!==t[a-2]||" "!==t[a-2]&&" "!==t[a-2]||" "===t[a-2])&&(e[r].pos+=1,e[r].type="i",i-=1,n+=1);break}n%2==1&&(e.push({pos:t.length,type:"i"}),t+="''"),i%2==1&&e.push({pos:t.length,type:"b"});var s="";if(0!==e.length){for(a=0,r=0;r<e.length;r++)s+=t.slice(a,e[r].pos),a="b"===e[r].type?e[r].pos+3:e[r].pos+2;"''"!==t.slice(t.length-2,t.length)&&(s+=t.slice(a,t.length))}else s=t;return s}function o(t){for(var e="",n=(t=t.replace(/ +/g," ")).split("\n"),i=0;i<n.length;i++)n[i].match(/^\s*$/)?e+="\n\n":n[i].match(/^==+.+==+$/)?e+=n[i]+"\n":e+=n[i];return e=(e=e.replace(/\n\n+/g,"\n\n")).replace(/(^\n*|\n*$)/g,"")}var r={parseWikitext:function(r){var a="";r=function(e){var n,i="",o=0;for(;o<e.length;)!("<"==e[o]&&null!=(n=t(e,o,"\x3c!--","--\x3e")).text||"{"==e[o]&&null!=(n=t(e,o,"{|","|}")).text)?(i+=e[o],o++):o=n.pos;return i}(r=o(r)),r=function(t){var i,o="",r=0;for(;r<t.length;)"<"!=t[r]||null==(i=n(t,r)).text?"["!=t[r]||null==(i=e(t,r)).text?(o+=t[r],r++):(r=i.pos,o+=i.text):r=i.pos;return o}(r);for(var s=r.split("\n"),l=0;l<s.length;l++)0!==s[l].length?(s[l]=i(s[l]),a+=s[l]+"\n"):a+="\n";return a=o(a)}};if("undefined"==typeof module||!module.exports)return r;module.exports=r}();function init(){switch(sourceMode){case 2:document.getElementById("sourceMode_html").checked=!0;break;case 3:document.getElementById("sourceMode_wiki").checked=!0;break;default:document.getElementById("sourceMode_auto").checked=!0}switch(repeatMode){case 0:document.getElementById("repeatMode_all").checked=!0;break;case 1:document.getElementById("repeatMode_first").checked=!0;break;default:document.getElementById("repeatMode_fis").checked=!0}var t=document.getElementById("tab_rawHtml");if(null!=t){var e=t.innerHTML;(i=e.indexOf(">"))>0&&(e=e.substring(i+1)),(o=e.lastIndexOf("<"))>0&&(e=e.substring(0,o)),e=(e=e.replace(/</g,"&lt;")).replace(/>/g,"&gt;"),t.innerHTML=e}var n=document.getElementById("tab_wiki");if(null!=n){var i,o,r=n.innerHTML;(i=r.indexOf(">"))>0&&(r=r.substring(i+1)),(o=r.lastIndexOf("<"))>0&&(r=r.substring(0,o));for(var a,s="",l=0,c=/\[\[(.*?)(|.*?)\]\]/g;null!=(a=c.exec(r));)s=(s+=r.substring(l,a.index))+'<a href="http://www.en.wikipedia.org/wiki/'+getDestination(a[0])+'">'+a[0]+"</a>",l=c.lastIndex;s+=r.substring(l),n.innerHTML=s}0==sourceMode&&2==repeatMode&&.5==minProbability&&""==bannedTopics||showOptions(),addTooltipsToAllLinks($("#tab_renderedHtml")),addTooltipsToAllLinks($(n)),addTooltipsToAllLinks($("#tab_topics"))}function getDestination(t){var e=t.indexOf("|");return e>0?t.substring(2,e):t.substring(2,t.length-2)}function selectTab(t){for(var e=document.getElementsByName("tab"),n=0;n<e.length;n++)e[n].className="tabDeselected";var i=document.getElementsByName("outputBox");for(n=0;n<e.length;n++)i[n].style.display="none";document.getElementById("tab_"+t).className="tabSelected",document.getElementById("box_"+t).style.display="block"}function showOptions(){$("#inputBox_container").css("margin-right","430px"),$("#options").show(),$("#hideOptions").show(),$("#showOptions").hide()}function hideOptions(){$("#inputBox_container").css("margin-right","12px"),$("#options").hide(),$("#hideOptions").hide(),$("#showOptions").show()}function getPageDimensions(){var t=0,e=0;return"number"==typeof window.innerWidth?(t=window.innerWidth,e=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(t=document.body.clientWidth,e=document.body.clientHeight),new Dimension(t,e)}function Dimension(t,e){this.width=t,this.height=e}function addTooltipsToAllLinks(t){if(null!=t)for(var e=t.find("a"),n=0;n<e.length;n++){var i=$(e[n]),o=i.attr("href"),r=i.attr("linkProb");null!=o&&"http://www.en.wikipedia.org/wiki/"==o.substr(0,33)&&(i.unbind("mouseover"),i.bind("mouseover",{id:idsByTitle[o.substr(33).toLowerCase()],object:i,linkProb:r},(function(t){showTooltip(t.data.id,t.data.object,t.data.linkProb)})),i.unbind("mouseout"),i.bind("mouseout",(function(t){$("#tooltip").hide()})))}}function showTooltip(t,e,n){var i=$("#tooltip"),o=e.offset().top+e.height(),r=e.offset().left;r+i.width()>$(window).width()&&(r=$(window).width()-i.width()-30),i.css("top",o+"px"),i.css("left",r+"px"),i.html("<div class='loading'></div>"),i.show(),console.log("accessing showtooltip wikify 216")}function processTooltipResponse(t,e,n){var i=$("#tooltip");i.empty();var o=$(e).find("Image");o.length>0&&i.append("<img src='"+o.attr("url")+"'></img>");var r=$(e).find("Definition");r.length>0?i.append(r.text()):i.append("no definition avaliable"),null!=n&&i.append("<p><em>"+n+"</em> probability of being a link"),$(i).append("<br/>")}!function(t){t.fn.dragscrollable=function(e){var n=t.extend({dragSelector:">:first",acceptPropagatedEvent:!0,preventDefault:!0},e||{}),i={mouseDownHandler:function(e){return!(1!=e.which||!e.data.acceptPropagatedEvent&&e.target!=this)&&(e.data.lastCoord={left:e.clientX,top:e.clientY},t.event.add(document,"mouseup",i.mouseUpHandler,e.data),t.event.add(document,"mousemove",i.mouseMoveHandler,e.data),e.data.preventDefault?(e.preventDefault(),!1):void 0)},mouseMoveHandler:function(t){var e=t.clientX-t.data.lastCoord.left,n=t.clientY-t.data.lastCoord.top;if(t.data.scrollable.scrollLeft(t.data.scrollable.scrollLeft()-e),t.data.scrollable.scrollTop(t.data.scrollable.scrollTop()-n),t.data.lastCoord={left:t.clientX,top:t.clientY},t.data.preventDefault)return t.preventDefault(),!1},mouseUpHandler:function(e){if(t.event.remove(document,"mousemove",i.mouseMoveHandler),t.event.remove(document,"mouseup",i.mouseUpHandler),e.data.preventDefault)return e.preventDefault(),!1}};this.each((function(){var e={scrollable:t(this),acceptPropagatedEvent:n.acceptPropagatedEvent,preventDefault:n.preventDefault};t(this).find(n.dragSelector).bind("mousedown",e,i.mouseDownHandler)}))}}(jQuery),jQuery.extend({highlight:function(t,e,n,i){if(3===t.nodeType){var o=t.data.match(e);if(o){var r=document.createElement(n||"span");r.className=i||"highlight";var a=t.splitText(o.index);a.splitText(o[0].length);var s=a.cloneNode(!0);return r.appendChild(s),a.parentNode.replaceChild(r,a),1}}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName)&&(t.tagName!==n.toUpperCase()||t.className!==i))for(var l=0;l<t.childNodes.length;l++)l+=jQuery.highlight(t.childNodes[l],e,n,i);return 0}}),jQuery.fn.unhighlight=function(t){var e={className:"highlight",element:"span"};return jQuery.extend(e,t),this.find(e.element+"."+e.className).each((function(){var t=this.parentNode;t.replaceChild(this.firstChild,this),t.normalize()})).end()},jQuery.fn.highlight=function(t,e){var n={className:"highlight",element:"span",caseSensitive:!1,wordsOnly:!1};if(jQuery.extend(n,e),t.constructor===String&&(t=[t]),t=jQuery.grep(t,(function(t,e){return""!=t})),0==(t=jQuery.map(t,(function(t,e){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}))).length)return this;var i=n.caseSensitive?"":"i",o="("+t.join("|")+")";n.wordsOnly&&(o="\\b"+o+"\\b");var r=new RegExp(o,i);return this.each((function(){jQuery.highlight(this,r,n.element,n.className)}))},function(t){var e={},n="doTimeout",i=Array.prototype.slice;function o(n){var o,r=this,a={},s=n?t.fn:t,l=arguments,c=4,u=l[1],d=l[2],p=l[3];function h(){n?o.removeData(n):u&&delete e[u]}function f(){a.id=setTimeout((function(){a.fn()}),d)}if("string"!=typeof u&&(c--,u=n=0,d=l[1],p=l[2]),n?(o=r.eq(0)).data(n,a=o.data(n)||{}):u&&(a=e[u]||(e[u]={})),a.id&&clearTimeout(a.id),delete a.id,p)a.fn=function(t){"string"==typeof p&&(p=s[p]),!0!==p.apply(r,i.call(l,c))||t?h():f()},f();else{if(a.fn)return void 0===d?h():a.fn(!1===d),!0;h()}}t[n]=function(){return o.apply(window,[0].concat(i.call(arguments)))},t.fn[n]=function(){var t=i.call(arguments),e=o.apply(this,[n+t[0]].concat(t));return"number"==typeof t[0]||"number"==typeof t[1]?this:e}}(jQuery),function(t,e,n){t.fn.jScrollPane=function(e){function i(e,i){var o,r,a,s,l,c,u,d,p,h,f,g,m,v,y,b,w,C,j,P,x,E,D,S,I,_,M,k,O,A,L,T,W,z,H=this,F=!0,B=!0,U=!1,R=!1,$=e.clone(!1,!1).empty(),N=t.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";function V(i){var P,F,B,U,R,$,ut,dt=!1,pt=!1;if(o=i,r===n)R=e.scrollTop(),$=e.scrollLeft(),e.css({overflow:"hidden",padding:0}),a=e.innerWidth()+W,s=e.innerHeight(),e.width(a),r=t('<div class="jspPane" />').css("padding",T).append(e.children()),l=t('<div class="jspContainer" />').css({width:a+"px",height:s+"px"}).append(r).appendTo(e);else{if(e.css("width",""),dt=o.stickToBottom&&((ut=u-s)>20&&ut-at()<10),pt=o.stickToRight&&function(){var t=c-a;return t>20&&t-rt()<10}(),(U=e.innerWidth()+W!=a||e.outerHeight()!=s)&&(a=e.innerWidth()+W,s=e.innerHeight(),l.css({width:a+"px",height:s+"px"})),!U&&z==c&&r.outerHeight()==u)return void e.width(a);z=c,r.css("width",""),e.width(a),l.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}r.css("overflow","auto"),c=i.contentWidth?i.contentWidth:r[0].scrollWidth,u=r[0].scrollHeight,r.css("overflow",""),h=(p=u/s)>1,(f=(d=c/a)>1)||h?(e.addClass("jspScrollable"),(P=o.maintainPosition&&(v||w))&&(F=rt(),B=at()),h&&(l.append(t('<div class="jspVerticalBar" />').append(t('<div class="jspCap jspCapTop" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragTop" />'),t('<div class="jspDragBottom" />'))),t('<div class="jspCap jspCapBottom" />'))),C=l.find(">.jspVerticalBar"),j=C.find(">.jspTrack"),g=j.find(">.jspDrag"),o.showArrows&&(D=t('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",Z(0,-1)).bind("click.jsp",st),S=t('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",Z(0,1)).bind("click.jsp",st),o.arrowScrollOnHover&&(D.bind("mouseover.jsp",Z(0,-1,D)),S.bind("mouseover.jsp",Z(0,1,S))),X(j,o.verticalArrowPositions,D,S)),x=s,l.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each((function(){x-=t(this).outerHeight()})),g.hover((function(){g.addClass("jspHover")}),(function(){g.removeClass("jspHover")})).bind("mousedown.jsp",(function(e){t("html").bind("dragstart.jsp selectstart.jsp",st),g.addClass("jspActive");var n=e.pageY-g.position().top;return t("html").bind("mousemove.jsp",(function(t){K(t.pageY-n,!1)})).bind("mouseup.jsp mouseleave.jsp",Q),!1})),G()),f&&(l.append(t('<div class="jspHorizontalBar" />').append(t('<div class="jspCap jspCapLeft" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragLeft" />'),t('<div class="jspDragRight" />'))),t('<div class="jspCap jspCapRight" />'))),I=l.find(">.jspHorizontalBar"),_=I.find(">.jspTrack"),y=_.find(">.jspDrag"),o.showArrows&&(O=t('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",Z(-1,0)).bind("click.jsp",st),A=t('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",Z(1,0)).bind("click.jsp",st),o.arrowScrollOnHover&&(O.bind("mouseover.jsp",Z(-1,0,O)),A.bind("mouseover.jsp",Z(1,0,A))),X(_,o.horizontalArrowPositions,O,A)),y.hover((function(){y.addClass("jspHover")}),(function(){y.removeClass("jspHover")})).bind("mousedown.jsp",(function(e){t("html").bind("dragstart.jsp selectstart.jsp",st),y.addClass("jspActive");var n=e.pageX-y.position().left;return t("html").bind("mousemove.jsp",(function(t){tt(t.pageX-n,!1)})).bind("mouseup.jsp mouseleave.jsp",Q),!1})),M=l.innerWidth(),Y()),function(){if(f&&h){var e=_.outerHeight(),n=j.outerWidth();x-=e,t(I).find(">.jspCap:visible,>.jspArrow").each((function(){M+=t(this).outerWidth()})),M-=n,s-=n,a-=e,_.parent().append(t('<div class="jspCorner" />').css("width",e+"px")),G(),Y()}f&&r.width(l.outerWidth()-W+"px");u=r.outerHeight(),p=u/s,f&&((k=Math.ceil(1/d*M))>o.horizontalDragMaxWidth?k=o.horizontalDragMaxWidth:k<o.horizontalDragMinWidth&&(k=o.horizontalDragMinWidth),y.width(k+"px"),b=M-k,et(w));h&&((E=Math.ceil(1/p*x))>o.verticalDragMaxHeight?E=o.verticalDragMaxHeight:E<o.verticalDragMinHeight&&(E=o.verticalDragMinHeight),g.height(E+"px"),m=x-E,J(v))}(),P&&(it(pt?c-a:F,!1),nt(dt?u-s:B,!1)),r.find(":input,a").unbind("focus.jsp").bind("focus.jsp",(function(t){ot(t.target,!1)})),l.unbind(N).bind(N,(function(t,e,n,i){var r=w,a=v;return H.scrollBy(n*o.mouseWheelSpeed,-i*o.mouseWheelSpeed,!1),r==w&&a==v})),function(){var t,e,n,i,o,r=!1;l.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",(function(a){var s=a.originalEvent.touches[0];t=rt(),e=at(),n=s.pageX,i=s.pageY,o=!1,r=!0})).bind("touchmove.jsp",(function(a){if(r){var s=a.originalEvent.touches[0],l=w,c=v;return H.scrollTo(t+n-s.pageX,e+i-s.pageY),o=o||Math.abs(n-s.pageX)>5||Math.abs(i-s.pageY)>5,l==w&&c==v}})).bind("touchend.jsp",(function(t){r=!1})).bind("click.jsp-touchclick",(function(t){if(o)return o=!1,!1}))}(),o.enableKeyboardNavigation&&function(){var n,i,a=[];f&&a.push(I[0]),h&&a.push(C[0]),r.focus((function(){e.focus()})),e.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",(function(e){if(e.target===this||a.length&&t(e.target).closest(a).length){var o=w,r=v;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:n=e.keyCode,c();break;case 35:nt(u-s),n=null;break;case 36:nt(0),n=null}return!(i=e.keyCode==n&&o!=w||r!=v)}})).bind("keypress.jsp",(function(t){return t.keyCode==n&&c(),!i})),o.hideFocus?(e.css("outline","none"),"hideFocus"in l[0]&&e.attr("hideFocus",!0)):(e.css("outline",""),"hideFocus"in l[0]&&e.attr("hideFocus",!1));function c(){var t=w,e=v;switch(n){case 40:H.scrollByY(o.keyboardSpeed,!1);break;case 38:H.scrollByY(-o.keyboardSpeed,!1);break;case 34:case 32:H.scrollByY(s*o.scrollPagePercent,!1);break;case 33:H.scrollByY(-s*o.scrollPagePercent,!1);break;case 39:H.scrollByX(o.keyboardSpeed,!1);break;case 37:H.scrollByX(-o.keyboardSpeed,!1)}return i=t!=w||e!=v}}(),o.clickOnTrack&&function(){q(),h&&j.bind("mousedown.jsp",(function(e){if(e.originalTarget===n||e.originalTarget==e.currentTarget){var i,r=t(this),a=r.offset(),l=e.pageY-a.top-v,c=!0,d=function(){var t=r.offset(),n=e.pageY-t.top-E/2,a=s*o.scrollPagePercent,h=m*a/(u-s);if(l<0)v-h>n?H.scrollByY(-a):K(n);else{if(!(l>0))return void p();v+h<n?H.scrollByY(a):K(n)}i=setTimeout(d,c?o.initialDelay:o.trackClickRepeatFreq),c=!1},p=function(){i&&clearTimeout(i),i=null,t(document).unbind("mouseup.jsp",p)};return d(),t(document).bind("mouseup.jsp",p),!1}}));f&&_.bind("mousedown.jsp",(function(e){if(e.originalTarget===n||e.originalTarget==e.currentTarget){var i,r=t(this),s=r.offset(),l=e.pageX-s.left-w,u=!0,d=function(){var t=r.offset(),n=e.pageX-t.left-k/2,s=a*o.scrollPagePercent,h=b*s/(c-a);if(l<0)w-h>n?H.scrollByX(-s):tt(n);else{if(!(l>0))return void p();w+h<n?H.scrollByX(s):tt(n)}i=setTimeout(d,u?o.initialDelay:o.trackClickRepeatFreq),u=!1},p=function(){i&&clearTimeout(i),i=null,t(document).unbind("mouseup.jsp",p)};return d(),t(document).bind("mouseup.jsp",p),!1}}))}(),function(){if(location.hash&&location.hash.length>1){var e,n,i=escape(location.hash);try{e=t(i)}catch(t){return}e.length&&r.find(i)&&(0===l.scrollTop()?n=setInterval((function(){l.scrollTop()>0&&(ot(i,!0),t(document).scrollTop(l.position().top),clearInterval(n))}),50):(ot(i,!0),t(document).scrollTop(l.position().top)))}}(),o.hijackInternalLinks&&ct()):(e.removeClass("jspScrollable"),r.css({top:0,width:l.width()-W}),l.unbind(N),r.find(":input,a").unbind("focus.jsp"),e.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),q(),lt()),o.autoReinitialise&&!L?L=setInterval((function(){V(o)}),o.autoReinitialiseDelay):!o.autoReinitialise&&L&&clearInterval(L),R&&e.scrollTop(0)&&nt(R,!1),$&&e.scrollLeft(0)&&it($,!1),e.trigger("jsp-initialised",[f||h])}function G(){j.height(x+"px"),v=0,P=o.verticalGutter+j.outerWidth(),r.width(a-P-W);try{0===C.position().left&&r.css("margin-left",P+"px")}catch(t){}}function Y(){l.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each((function(){M-=t(this).outerWidth()})),_.width(M+"px"),w=0}function X(t,e,n,i){var o,r="before",a="after";"os"==e&&(e=/Mac/.test(navigator.platform)?"after":"split"),e==r?a=e:e==a&&(r=e,o=n,n=i,i=o),t[r](n)[a](i)}function Z(e,n,i){return function(){return function(e,n,i,r){i=t(i).addClass("jspActive");var a,s,l=!0,c=function(){0!==e&&H.scrollByX(e*o.arrowButtonSpeed),0!==n&&H.scrollByY(n*o.arrowButtonSpeed),s=setTimeout(c,l?o.initialDelay:o.arrowRepeatFreq),l=!1};c(),a=r?"mouseout.jsp":"mouseup.jsp",(r=r||t("html")).bind(a,(function(){i.removeClass("jspActive"),s&&clearTimeout(s),s=null,r.unbind(a)}))}(e,n,this,i),this.blur(),!1}}function q(){_&&_.unbind("mousedown.jsp"),j&&j.unbind("mousedown.jsp")}function Q(){t("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),g&&g.removeClass("jspActive"),y&&y.removeClass("jspActive")}function K(t,e){h&&(t<0?t=0:t>m&&(t=m),e===n&&(e=o.animateScroll),e?H.animate(g,"top",t,J):(g.css("top",t),J(t)))}function J(t){t===n&&(t=g.position().top),l.scrollTop(0);var i=0===(v=t),a=v==m,c=-(t/m)*(u-s);F==i&&U==a||(F=i,U=a,e.trigger("jsp-arrow-change",[F,U,B,R])),function(t,e){o.showArrows&&(D[t?"addClass":"removeClass"]("jspDisabled"),S[e?"addClass":"removeClass"]("jspDisabled"))}(i,a),r.css("top",c),e.trigger("jsp-scroll-y",[-c,i,a]).trigger("scroll")}function tt(t,e){f&&(t<0?t=0:t>b&&(t=b),e===n&&(e=o.animateScroll),e?H.animate(y,"left",t,et):(y.css("left",t),et(t)))}function et(t){t===n&&(t=y.position().left),l.scrollTop(0);var i=0===(w=t),s=w==b,u=-(t/b)*(c-a);B==i&&R==s||(B=i,R=s,e.trigger("jsp-arrow-change",[F,U,B,R])),function(t,e){o.showArrows&&(O[t?"addClass":"removeClass"]("jspDisabled"),A[e?"addClass":"removeClass"]("jspDisabled"))}(i,s),r.css("left",u),e.trigger("jsp-scroll-x",[-u,i,s]).trigger("scroll")}function nt(t,e){K(t/(u-s)*m,e)}function it(t,e){tt(t/(c-a)*b,e)}function ot(e,n,i){var r,c,u,d,p,h,f,g,m,v=0,y=0;try{r=t(e)}catch(t){return}for(c=r.outerHeight(),u=r.outerWidth(),l.scrollTop(0),l.scrollLeft(0);!r.is(".jspPane");)if(v+=r.position().top,y+=r.position().left,r=r.offsetParent(),/^body|html$/i.test(r[0].nodeName))return;h=(d=at())+s,v<d||n?g=v-o.verticalGutter:v+c>h&&(g=v-s+c+o.verticalGutter),g&&nt(g,i),f=(p=rt())+a,y<p||n?m=y-o.horizontalGutter:y+u>f&&(m=y-a+u+o.horizontalGutter),m&&it(m,i)}function rt(){return-r.position().left}function at(){return-r.position().top}function st(){return!1}function lt(){t("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function ct(){lt(),t("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",(function(){var t,e=this.href.split("#");if(e.length>1&&(t=e[1]).length>0&&r.find("#"+t).length>0)return ot("#"+t,!0),!1}))}T=e.css("paddingTop")+" "+e.css("paddingRight")+" "+e.css("paddingBottom")+" "+e.css("paddingLeft"),W=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0),t.extend(H,{reinitialise:function(e){V(e=t.extend({},o,e))},scrollToElement:function(t,e,n){ot(t,e,n)},scrollTo:function(t,e,n){it(t,n),nt(e,n)},scrollToX:function(t,e){it(t,e)},scrollToY:function(t,e){nt(t,e)},scrollToPercentX:function(t,e){it(t*(c-a),e)},scrollToPercentY:function(t,e){nt(t*(u-s),e)},scrollBy:function(t,e,n){H.scrollByX(t,n),H.scrollByY(e,n)},scrollByX:function(t,e){tt((rt()+Math[t<0?"floor":"ceil"](t))/(c-a)*b,e)},scrollByY:function(t,e){K((at()+Math[t<0?"floor":"ceil"](t))/(u-s)*m,e)},positionDragX:function(t,e){tt(t,e)},positionDragY:function(t,e){K(t,e)},animate:function(t,e,n,i){var r={};r[e]=n,t.animate(r,{duration:o.animateDuration,easing:o.animateEase,queue:!1,step:i})},getContentPositionX:function(){return rt()},getContentPositionY:function(){return at()},getContentWidth:function(){return c},getContentHeight:function(){return u},getPercentScrolledX:function(){return rt()/(c-a)},getPercentScrolledY:function(){return at()/(u-s)},getIsScrollableH:function(){return f},getIsScrollableV:function(){return h},getContentPane:function(){return r},scrollToBottom:function(t){K(m,t)},hijackInternalLinks:function(){ct()},destroy:function(){var t,n;t=at(),n=rt(),e.removeClass("jspScrollable").unbind(".jsp"),e.replaceWith($.append(r.children())),$.scrollTop(t),$.scrollLeft(n)}}),V(i)}return e=t.extend({},t.fn.jScrollPane.defaults,e),t.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],(function(){e[this]=e[this]||e.speed})),this.each((function(){var n=t(this),o=n.data("jsp");o?o.reinitialise(e):(o=new i(n,e),n.data("jsp",o))}))},t.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery),$.window=function(t){return $.Window.getInstance(null,t)},$.fn.window=function(t){return $.Window.getInstance($(this),t)},$.Window=function(){function t(){return navigator.userAgent.toLowerCase().indexOf("msie")>=0}function e(t,e){null==t?(null!=w&&w!=e?(w.unselect(),e.select()):null==w&&e.select(),w=e):(null!=t.get(0)._lastSelectedWindow&&t.get(0)._lastSelectedWindow!=e?(t.get(0)._lastSelectedWindow.unselect(),e.select()):null==t.get(0)._lastSelectedWindow&&e.select(),t.get(0)._lastSelectedWindow=e)}function n(t){for(var e=0,n=C.length;n>e;e++){if(C[e]==t){C.splice(e--,1);break}}}function i(t,e){null!=D.dockArea&&(t=$(D.dockArea)),null!=t?t.get(0)._minWinData.storage.push(e):E.storage.push(e)}function o(t,e){for(var n=!1,i=null!=(t=null!=D.dockArea?$(D.dockArea):t)?t.get(0)._minWinData.storage:E.storage,o=0;o<i.length;o++){var r=i[o];r!=e?n&&r._decreaseMiniIndex():(i.splice(o--,1),n=!0)}}function r(t){return(null!=(t=null!=D.dockArea?$(D.dockArea):t)?t.get(0)._minWinData.storage:E.storage).length}function a(t,e){var n=null,i=null;null!=D.dockArea&&(t=$(D.dockArea)),null!=t?(n={width:t.innerWidth(),height:t.innerHeight()},i=t.get(0)._minWinData):(n=u(),i=E);var o=r(t);"left"==D.dock||"right"==D.dock?e?(o+1)*i.long>n.height&&(i.long=n.height/(o+1),s(t)):i.long<D.minWinLong&&(i.long=o*D.minWinLong<n.height?D.minWinLong:n.height/o):("top"==D.dock||"bottom"==D.dock)&&(e?(o+1)*i.long>n.width&&(i.long=n.width/(o+1),s(t)):i.long<D.minWinLong&&(i.long=o*D.minWinLong<n.width?D.minWinLong:n.width/o))}function s(t){for(var e=null!=(t=null!=D.dockArea?$(D.dockArea):t)?t.get(0)._minWinData.storage:E.storage,n=0;n<e.length;n++)e[n]._adjustMinimizedPos(!1)}function l(){D.handleScrollbar&&(y.indexOf("msie 7")>=0?$("body").attr("scroll","no"):document.body.style.overflow="hidden")}function c(){D.handleScrollbar&&(y.indexOf("msie 7")>=0?$("body").removeAttr("scroll"):document.body.style.overflow="auto")}function u(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}function d(){var t=0,e=0;return"number"==typeof window.pageYOffset?(e=window.pageYOffset,t=window.pageXOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(e=document.body.scrollTop,t=document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(e=document.documentElement.scrollTop,t=document.documentElement.scrollLeft),{left:t,top:e}}function p(t,e){var n=null;if(null!=t){if("absolute"==t.css("position")&&!e)n={left:0,top:0};else{n=t.offset();var i=parseInt(t.css("borderTopWidth")),o=parseInt(t.css("borderLeftWidth"));n.left+=o,n.top+=i}f("start pos: "+n.left+","+n.top)}return n}function h(t,e){var n={},i=u(),o=null,r=D.minWinNarrow,a=E.long;if(null!=D.dockArea){var s={left:0,top:0};if(null!=t)"absolute"==t.css("position")&&(s=p(t,!0));(o=p(t=$(D.dockArea),!0)).left-=s.left,o.top-=s.top,a=t.get(0)._minWinData.long}else null!=t&&(o=p(t),a=t.get(0)._minWinData.long);return"left"==D.dock||"right"==D.dock?(n.width=r,n.height=a-1,n.top=e*a,"left"==D.dock?null!=t?(n.top+=o.top,n.left=o.left):n.left=0:"right"==D.dock&&(null!=t?(n.top+=o.top,n.left=o.left+t.width()-r-2):n.left=i.width-r)):("top"==D.dock||"bottom"==D.dock)&&(n.width=a-1,n.height=r,n.left=e*a,"top"==D.dock?null!=t?(n.top=o.top,n.left+=o.left):n.top=0:"bottom"==D.dock&&(null!=t?(n.top=o.top+t.height()-r-2,n.left+=o.left):n.top=i.height-r)),f(n),n}function f(t){D.showLog&&null!=window.console&&console.log(t)}function g(g,y){function w(t){if(y.icon=t,"auto"==y.icon&&(y.icon=j()),null!=y.icon){var e=at.children(".window_title_icon");null!=e.get(0)?(C(),e.attr("src",y.icon)):function(){if(null!=y.icon&&""!=y.icon){var t="<img class='window_title_icon' src='"+y.icon+"' style='display:none;' onload='javascript:$.Window._iconOnLoad(this);'/>";at.prepend(t)}}()}}function C(){var t=at.children(".window_title_icon");null!=t.get(0)&&(t.hide(),at.children(".window_title_text").css("margin-left","-20px"),ot=0,_())}function j(){if(null!=y.url&&""!=$.trim(y.url)){var t=function(t){var e=t.match(/:\/\/(.[^/]+)/);return null!=e&&e.length>=2?e[1]:null}(y.url);if(null!=t)return"http://"+t+"/favicon.ico"}return null}function P(t){y.content=t,"object"==typeof t&&(t=$(t).clone(!0)),st.empty(),st.append(t)}function x(t){y.showFooter&&(y.footerContent=t,"object"==typeof t&&(t=$(t).clone(!0)),lt.children("div").empty(),lt.children("div").append(t))}function E(){var t=$("#window_overlay");null==t.get(0)&&($("body").append("<div id='window_overlay'>&nbsp;</div>"),(t=$("#window_overlay")).css("z-index",y.z+1)),t.css(y.showModal?{opacity:y.modalOpacity}:{opacity:0}),t.show()}function S(t){(0==y.showModal||t)&&$("#window_overlay").hide()}function I(t,e){it=!0,J=h(g,nt),t?(rt.css(J),it=!1,$.isFunction(e)&&e()):rt.animate(J,D.animationSpeed,"swing",(function(){it=!1,$.isFunction(e)&&e()}))}function _(){at.children("div.window_title_text").width(at.width()-et-ot)}function M(){var t=rt.width(),e=A(rt.height());st.width(t),st.height(e)}function k(){var t=st.css("backgroundColor");null!=t&&"transparent"!=t&&"rgba(0, 0, 0, 0)"!=t&&rt.css("backgroundColor",t),st.hide(),y.showFooter&&lt.hide(),rt.css("opacity",v)}function O(){st.show(),y.showFooter&&lt.show(),rt.css("opacity",1)}function A(t){return t-20-(y.showFooter?16:0)-4}function L(){if("top"!=D.dock&&"bottom"!=D.dock){var t=at.children("div.window_title_text"),e=at.children(".window_title_icon");t.addClass(e.is(":visible")?"window_title_text_vertical_with_icon":"window_title_text_vertical");for(var n=y.title,i="",o=0;o<n.length;o++){var r=n.charAt(o);("-"==r||"_"==r)&&(r="|")," "==r?i+=r="<div style='height:5px; line-height:5px;'>&nbsp;</div>":i+=r+"<br>"}t.html(i)}}function T(){var t=0,e=0;if(null!=g){var n=p(g);t=n.left+(g.width()-rt.width())/2,e=n.top+(g.height()-rt.height())/2}else{var i=d(),o=u();t=i.left+(o.width-rt.width())/2,e=i.top+(o.height-rt.height())/2}y.createRandomOffset.x>0&&(t+=(Math.random()-.5)*y.createRandomOffset.x),y.createRandomOffset.y>0&&(e+=(Math.random()-.5)*y.createRandomOffset.y),rt.css({left:t,top:e})}function W(){var t=0;if(null!=g)t=p(g).left+(g.width()-rt.width())/2;else{var e=d(),n=u();t=e.left+(n.width-rt.width())/2}rt.css({left:t})}function z(){var t=0;if(null!=g)t=p(g).top+(g.height()-rt.height())/2;else{var e=d(),n=u();t=e.top+(n.height-rt.height())/2}rt.css({top:t})}function H(e,n){t()||null!=g||l(),G=!0,rt.draggable("disable"),rt.resizable("disable"),1!=n&&(Z.left=rt.css("left"),Z.top=rt.css("top"),q.w=rt.width(),q.h=rt.height()),rt.addClass("no-resizable");var i=d(),o=u();if(null!=g){var r=p(g);J={left:r.left,top:r.top,width:g.width(),height:g.height(),opacity:1}}else J={left:i.left,top:i.top,width:o.width,height:o.height,opacity:1};e?(rt.css(J),_(),M(),at.removeClass("window_header_normal"),at.addClass("window_header_maximize"),tt.children(".maximizeImg").hide(),tt.children(".cascadeImg").show()):(k(),rt.animate(J,D.animationSpeed,"swing",(function(){t()&&null==g&&l(),O(),_(),M(),at.removeClass("window_header_normal"),at.addClass("window_header_maximize"),tt.children(".maximizeImg").hide(),tt.children(".cascadeImg").show(),$.isFunction(y.afterMaximize)&&y.afterMaximize(R)})),rt.css("z-index",y.z+3)),$.isFunction(y.onMaximize)&&y.onMaximize(R)}function F(){S(!0),c(),V=!0,rt.draggable("disable"),rt.resizable("disable"),Q.left=rt.css("left"),Q.top=rt.css("top"),K.w=rt.width(),K.h=rt.height(),nt=r(g),J={opacity:v},rt.addClass("no-resizable"),null==g&&null==D.dockArea&&function(){var t=rt.offset(),e=d();rt.css({position:"fixed",left:t.left-e.left,top:t.top-e.top})}(),tt.hide(),k(),a(g,!0),I(!1,(function(){rt.css("z-index",y.z),at.children("div.window_title_text").width("96%"),at.attr("title",y.title),at.removeClass("window_header_normal"),at.removeClass("window_header_maximize"),at.addClass("window_header_minimize"),("left"==D.dock||"right"==D.dock)&&at.addClass("window_header_minimize_vertical"),y.showRoundCorner&&(at.removeClass("ui-corner-top"),at.addClass("ui-corner-all")),L(),at.click((function(){it||B()})),$.isFunction(y.afterMinimize)&&y.afterMinimize(R)})),rt.mouseover((function(){$(this).css("opacity",1)})),rt.mouseout((function(){$(this).css("opacity",v)})),$.isFunction(y.onMinimize)&&y.onMinimize(R),i(g,R)}function B(){y.showModal&&E();var t=null,e=null,n=y.z+2;if(V)if(t=Q,e=K,null==g&&function(){var t=rt.offset();rt.css({position:"absolute",left:t.left,top:t.top})}(),function(){var t=at.children("div.window_title_text");t.removeClass("window_title_text_vertical"),t.removeClass("window_title_text_vertical_with_icon"),t.text(y.title)}(),at.removeAttr("title"),at.removeClass("window_header_minimize"),at.removeClass("window_header_minimize_vertical"),G){if(at.addClass("window_header_maximize"),null!=g)t=p(g);else{var i=d();t={left:i.left,top:i.top}}n=y.z+3,rt.css("z-index",n)}else at.addClass("window_header_normal"),rt.removeClass("no-resizable");else G&&(G=!1,t=Z,e=q,at.removeClass("window_header_maximize"),at.addClass("window_header_normal"),rt.removeClass("no-resizable"));y.showRoundCorner&&(at.removeClass("ui-corner-all"),at.addClass("ui-corner-top")),rt.unbind("mouseover"),rt.unbind("mouseout"),J={left:t.left,top:t.top,width:e.w,height:e.h,opacity:1},k(),rt.animate(J,D.animationSpeed,"swing",(function(){rt.css("z-index",n),O(),at.unbind("click"),_(),M(),G?(null==g&&l(),tt.children(".maximizeImg").hide(),tt.children(".cascadeImg").show()):(c(),rt.draggable("enable"),rt.resizable("enable"),tt.children(".maximizeImg").show(),tt.children(".cascadeImg").hide()),tt.show(),V&&(V=!1,o(g,R),a(g,!1),s(g)),$.isFunction(y.afterCascade)&&y.afterCascade(R)})),$.isFunction(y.onCascade)&&y.onCascade(R)}function U(t){!t&&$.isFunction(y.onClose)&&y.onClose(R),X=!1,G&&c(),n(R),rt.remove(),S(!0)}var R=null,N="window_"+b++,V=!1,G=!1,Y=!1,X=!1,Z=new Object,q=new Object,Q=new Object,K=new Object,J={},tt=null,et=0,nt=-1,it=!1,ot=0,rt=null,at=null,st=null,lt=null;y=$.extend({icon:"auto",title:"",url:"",content:"",footerContent:"",containerClass:"",headerClass:"",frameClass:"",footerClass:"",selectedHeaderClass:"",x:-1,y:-1,z:2e3,width:400,height:300,minWidth:200,minHeight:150,maxWidth:800,maxHeight:600,showModal:!1,modalOpacity:.5,showFooter:!0,showRoundCorner:!1,closable:!0,minimizable:!0,maximizable:!0,draggable:!0,resizable:!0,scrollable:!0,checkBoundary:!1,withinBrowserWindow:!1,custBtns:null,onOpen:null,onShow:null,onClose:null,onSelect:null,onUnselect:null,onDrag:null,afterDrag:null,onResize:null,afterResize:null,onMinimize:null,afterMinimize:null,onMaximize:null,afterMaximize:null,onCascade:null,afterCascade:null,onIframeStart:null,onIframeEnd:null,iframeRedirectCheckMsg:null,createRandomOffset:{x:0,y:0}},y);return{initialize:function(n){R=n,y.showModal&&E();var i=null!=g?g:$("body"),o=y.showRoundCorner?"ui-corner-all ":"";if(i.append("<div id='"+N+"' class='window_panel "+o+y.containerClass+"'></div>"),rt=i.children("div#"+N),$.isFunction(y.onOpen)&&y.onOpen(R),q.w=y.width,q.h=y.height,rt.width(y.width),rt.height(y.height),rt.css("z-index",y.z),t()&&rt.css({paddingRight:1,paddingBottom:1}),y.x>=0||y.y>=0){var r=d();if(y.x>=0){var a=0;if(null!=g){var s=p(g);a=y.x+s.left}else a=y.x+r.left;rt.css("left",a)}else W();if(y.y>=0){var l=0;if(null!=g){s=p(g);l=y.y+s.top}else l=y.y+r.top;rt.css("top",l)}else z()}else T();var c=rt.position();rt.css({left:c.left,top:c.top}),"auto"==y.icon&&(y.icon=j());var u="";null!=y.icon&&(u="<img class='window_title_icon' src='"+y.icon+"' style='display:none;' onload='javascript:$.Window._iconOnLoad(this);'/>");var h="<div class='window_header window_header_normal ui-widget-header "+(o=y.showRoundCorner?"ui-corner-top ":"")+"no-resizable "+y.headerClass+"'>"+u+"<div class='window_title_text'>"+y.title+"</div><div class='window_function_bar'></div></div>";rt.append(h),at=rt.children("div.window_header"),C(),y.maximizable&&at.dblclick((function(){G?B():H()})),tt=at.children("div.window_function_bar"),y.closable&&(tt.append("<div title='close window' class='closeImg window_icon_button no-draggable'></div>"),tt.children(".closeImg").click((function(){U()})),et+=m),y.maximizable&&(tt.append("<div title='maximize window' class='maximizeImg window_icon_button no-draggable'></div>"),tt.append("<div title='cascade window' class='cascadeImg window_icon_button no-draggable' style='display:none;'></div>"),tt.children(".maximizeImg").click((function(){H()})),tt.children(".cascadeImg").click((function(){B()})),et+=m),y.minimizable&&(tt.append("<div title='minimize window' class='minimizeImg window_icon_button no-draggable'></div>"),tt.children(".minimizeImg").click((function(){F()})),et+=m),function(t){if(null!=y.custBtns&&"object"==typeof y.custBtns)for(var e=0;e<y.custBtns.length;e++){var n=y.custBtns[e];if(null!=n&&"object"==typeof n)if(null!=n.id&&null!=n.callback){var i=null!=n.id?n.id:"",o=null!=n.clazz?n.clazz:"",r=null!=n.title?n.title:"",a=null!=n.style?n.style:"",s=null!=n.image?n.image:"",l=null!=n.callback?n.callback:"";t.append(null!=n.image&&""!=n.image?"<img id='"+i+"' src='"+s+"' title='"+r+"' class='"+o+" window_icon_button no-draggable' style='"+a+"'/>":"<div id='"+i+"' src='"+s+"' title='"+r+"' class='"+o+" window_icon_button no-draggable' style='"+a+"'></div>"),(c=t.children("[id="+i+"]")).get(0).clickCb=l,$.isFunction(l)&&c.click((function(){this.clickCb($(this),R)}))}else{var c;(c=$(n).clone(!0)).addClass("window_icon_button no-draggable cust_button"),t.append(c),c.show()}et+=m}}(tt),$(".window_icon_button").dblclick((function(){return!1})),_(),tt.width(et);var v=A(q.h);if(null!=y.url&&""!=$.trim(y.url)){$.isFunction(y.onIframeStart)&&(f("start connecting iframe: "+y.url),y.onIframeStart(R,y.url)),y.iframeRedirectCheckMsg&&(X=!0,window.onbeforeunload=function(){if(X)return y.iframeRedirectCheckMsg.replace("{url}",y.url)}),rt.append("<div class='frame_loading'>Loading...</div>");var b=rt.children(".frame_loading");b.css("marginLeft","-"+b.outerWidth()/2-20+"px"),b.click((function(){b.remove()}));var w=y.scrollable?"yes":"no";rt.append("<iframe style='display:none;' class='window_frame ui-widget-content no-draggable no-resizable "+y.frameClass+"' scrolling='"+w+"' src='"+y.url+"' width='100%' height='"+v+"px' frameborder='0'></iframe>"),(st=rt.children(".window_frame")).ready((function(){st.show()})),st.load((function(){X=!1,b.remove(),f("load iframe finished: "+y.url),$.isFunction(y.onIframeEnd)&&y.onIframeEnd(R,y.url)}))}else rt.append("<div class='window_frame ui-widget-content no-draggable no-resizable "+y.frameClass+"' style='width:100%; height:"+v+"px;'></div>"),st=rt.children(".window_frame"),null!=y.content&&(P(y.content),st.children().show()),st.css({overflow:y.scrollable?"auto":"hidden"});y.showFooter?(o=y.showRoundCorner?"ui-corner-bottom ":"",rt.append("<div class='window_footer ui-widget-content "+o+"no-draggable no-resizable "+y.footerClass+"'><div></div></div>"),lt=rt.children("div.window_footer"),null!=y.footerContent&&(x(y.footerContent),lt.children("div").children().show())):(o=y.showRoundCorner?"ui-corner-bottom ":"",st.addClass(o)),rt.mousedown((function(){e(g,R)})),y.draggable&&(rt.draggable({cancel:".no-draggable",start:function(){f("drag start"),(V||G)&&(rt.css("position","fixed"),rt.css(J)),E(),k(),y.onDrag&&y.onDrag(R)},stop:function(){f("drag stop"),(V||G)&&(rt.css("position","fixed"),rt.css(J)),S(),O(),y.afterDrag&&y.afterDrag(R)}}),y.checkBoundary&&(y.withinBrowserWindow&&null==g?rt.draggable("option","containment","window"):rt.draggable("option","containment","parent"))),y.resizable&&(rt.resizable({cancel:".no-resizable",alsoResize:st,start:function(){return f("resize start"),!V&&!G&&(E(),k(),void(y.onResize&&y.onResize(R)))},stop:function(){return f("resize stop"),!V&&!G&&(S(),_(),O(),void(y.afterResize&&y.afterResize(R)))}}),y.checkBoundary,y.maxWidth>=0&&rt.resizable("option","maxWidth",y.maxWidth),y.maxHeight>=0&&rt.resizable("option","maxHeight",y.maxHeight),y.minWidth>=0&&rt.resizable("option","minWidth",y.minWidth),y.minHeight>=0&&rt.resizable("option","minHeight",y.minHeight)),$.isFunction(y.onShow)&&y.onShow(R)},getTargetCssStyle:function(){return J},getWindowId:function(){return N},getCaller:function(){return g},getContainer:function(){return rt},getHeader:function(){return at},getFrame:function(){return st},getFooter:function(){return lt},alignCenter:T,alignHorizontalCenter:W,alignVerticalCenter:z,select:function(){Y=!0,0==G&&(rt.css("z-index",y.z+2),y.selectedHeaderClass&&at.addClass(y.selectedHeaderClass)),$.isFunction(y.onSelect)&&y.onSelect()},unselect:function(){Y=!1,0==G&&(rt.css("z-index",y.z),y.selectedHeaderClass&&at.removeClass(y.selectedHeaderClass)),$.isFunction(y.onUnselect)&&y.onUnselect()},move:function(t,e,n){if(!G&&!V){var i={};if("number"==typeof t){if(n)t+=rt.offset().left;i.left=t}if("number"==typeof e){if(i.top=e,n)e+=rt.offset().top;i.top=e}rt.css(i)}},resize:function(t,e){if(!G&&!V){var n={};t>0&&(n.width=t),e>0&&(n.height=e),rt.css(n),_()}},maximize:H,minimize:F,restore:B,close:U,hide:function(){rt.hide()},show:function(){rt.show()},setTitle:function(t){y.title=t,at.children(".window_title_text").text(t),V&&L()},setUrl:function(t){y.url=t,st.attr("src",t),null!=y.icon&&w("auto")},setContent:P,setFooterContent:x,getTitle:function(){return y.title},getUrl:function(){return y.url},getContent:function(){return st.html()},getFooterContent:function(){return lt.children("div").html()},isMaximized:function(){return G},isMinimized:function(){return V},isSelected:function(){return Y},setIcon:w,showIcon:function(){var t=at.children(".window_title_icon");null!=t.get(0)&&(t.show(),at.children(".window_title_text").css("margin-left","0"),ot=20,_())},hideIcon:C,_decreaseMiniIndex:function(){nt--},_adjustMinimizedPos:I,_setOrgWH:function(t){K.w=t.width,K.h=t.height},_transformTitleText:L,toString:function(){return"[Window] id="+N+", title="+y.title}}}var m=20,v=.7,y=navigator.userAgent.toLowerCase(),b=0,w=null,C=[],j=!1,P=null,x=[],E={long:120,storage:[]},D={dock:"left",dockArea:null,animationSpeed:400,minWinNarrow:24,minWinLong:120,handleScrollbar:!0,showLog:!1};return{getInstance:function(t,n){var i=g(t,n);return i.initialize(i),e(t,i),function(t){C.push(t)}(i),null!=t&&(null==t.get(0)._minWinData&&(t.get(0)._minWinData={long:D.minWinLong,storage:[]}),x.push(t)),j||($(window).resize((function(){null!=P&&clearTimeout(P),P=window.setTimeout((function(){for(var t=u(),e=0,n=C.length;n>e;e++){var i=C[e];i.isMaximized()&&(i.isMinimized()?i._setOrgWH(t):i.maximize(!0,!0)),i.isMinimized()&&i._adjustMinimizedPos(!0)}}),200)})),j=!0),i},getVersion:function(){return"5.0.4"},prepare:function(t){if($.extend(D,t),E.long=D.minWinLong,null!=D.dockArea){var e=$(D.dockArea);null==e.get(0)._minWinData&&(e.get(0)._minWinData={long:D.minWinLong,storage:[]})}},closeAll:function(t){for(var e=C.length,n=0;e>n;n++){C[0].close(t)}C=[],E.storage=[],E.long=D.minWinLong;for(n=0;n<x.length;n++){var i=x[n].get(0)._minWinData;i.storage=[],i.long=D.minWinLong}},hideAll:function(){for(var t=0,e=C.length;e>t;t++)C[t].getContainer().hide()},showAll:function(){for(var t=0,e=C.length;e>t;t++)C[t].getContainer().show()},getAll:function(){return C},getWindow:function(t){for(var e=0,n=C.length;n>e;e++){var i=C[e];if(i.getWindowId()==t)return i}},getSelectedWindow:function(){for(var t=0,e=C.length;e>t;t++){var n=C[t];if(n.isSelected())return n}},_iconOnLoad:function(t){var e=$(t).parent().parent().attr("id");if(f("_iconOnLoad: "+e),null!=e){var n=$.Window.getWindow(e);null!=n&&n.showIcon()}else!function(t){null!=window.console&&console.warn(t)}("[_iconOnLoad] lost window id!!!")}}}(),$.window.getVersion=$.Window.getVersion,$.window.prepare=$.Window.prepare,$.window.closeAll=$.Window.closeAll,$.window.hideAll=$.Window.hideAll,$.window.showAll=$.Window.showAll,$.window.getAll=$.Window.getAll,$.window.getWindow=$.Window.getWindow,$.window.getSelectedWindow=$.Window.getSelectedWindow,jsPlumbUtil={isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isString:function(t){return"string"==typeof t},isBoolean:function(t){return"boolean"==typeof t},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isDate:function(t){return"[object Date]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},clone:function(t){if(this.isString(t))return new String(t);if(this.isBoolean(t))return new Boolean(t);if(this.isDate(t))return new Date(t.getTime());if(this.isFunction(t))return t;if(this.isArray(t)){for(var e=[],n=0;n<t.length;n++)e.push(this.clone(t[n]));return e}if(this.isObject(t)){e={};for(var n in t)e[n]=this.clone(t[n]);return e}return t},merge:function(t,e){var n=this.clone(t);for(var i in e)if(null==n[i]||this.isString(e[i])||this.isBoolean(e[i]))n[i]=e[i];else if(this.isArray(e[i])&&this.isArray(n[i])){var o=[];o.push.apply(o,n[i]),o.push.apply(o,e[i]),n[i]=o}else if(this.isObject(n[i])&&this.isObject(e[i]))for(var r in e[i])n[i][r]=e[i][r];return n},convertStyle:function(t,e){if("transparent"===t)return t;var n=t,i=function(t){return 1==(e=Number(t).toString(16)).length?"0"+e:e;var e},o=/(rgb[a]?\()(.*)(\))/;if(t.match(o)){var r=t.match(o)[2].split(",");n="#"+i(r[0])+i(r[1])+i(r[2]),e||4!=r.length||(n+=i(r[3]))}return n},gradient:function(t,e){return t=jsPlumbUtil.isArray(t)?t:[t.x,t.y],((e=jsPlumbUtil.isArray(e)?e:[e.x,e.y])[1]-t[1])/(e[0]-t[0])},normal:function(t,e){return-1/jsPlumbUtil.gradient(t,e)},lineLength:function(t,e){return t=jsPlumbUtil.isArray(t)?t:[t.x,t.y],e=jsPlumbUtil.isArray(e)?e:[e.x,e.y],Math.sqrt(Math.pow(e[1]-t[1],2)+Math.pow(e[0]-t[0],2))},segment:function(t,e){return t=jsPlumbUtil.isArray(t)?t:[t.x,t.y],(e=jsPlumbUtil.isArray(e)?e:[e.x,e.y])[0]>t[0]?e[1]>t[1]?2:1:e[1]>t[1]?3:4},intersects:function(t,e){var n=t.x,i=t.x+t.w,o=t.y,r=t.y+t.h,a=e.x,s=e.x+e.w,l=e.y,c=e.y+e.h;return n<=a&&a<=i&&o<=l&&l<=r||n<=s&&s<=i&&o<=l&&l<=r||n<=a&&a<=i&&o<=c&&c<=r||n<=s&&a<=i&&o<=c&&c<=r||a<=n&&n<=s&&l<=o&&o<=c||a<=i&&i<=s&&l<=o&&o<=c||a<=n&&n<=s&&l<=r&&r<=c||a<=i&&n<=s&&l<=r&&r<=c},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(t,e,n){var i=jsPlumbUtil.gradient(t,e),o=jsPlumbUtil.segment(t,e),r=n>0?jsPlumbUtil.segmentMultipliers[o]:jsPlumbUtil.inverseSegmentMultipliers[o],a=Math.atan(i),s=Math.abs(n*Math.sin(a))*r[1],l=Math.abs(n*Math.cos(a))*r[0];return{x:t.x+l,y:t.y+s}},perpendicularLineTo:function(t,e,n){var i=jsPlumbUtil.gradient(t,e),o=Math.atan(-1/i),r=n/2*Math.sin(o),a=n/2*Math.cos(o);return[{x:e.x+a,y:e.y+r},{x:e.x-a,y:e.y-r}]},findWithFunction:function(t,e){if(t)for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1},indexOf:function(t,e){return jsPlumbUtil.findWithFunction(t,(function(t){return t==e}))},removeWithFunction:function(t,e){var n=jsPlumbUtil.findWithFunction(t,e);return n>-1&&t.splice(n,1),-1!=n},remove:function(t,e){var n=jsPlumbUtil.indexOf(t,e);return n>-1&&t.splice(n,1),-1!=n},addWithFunction:function(t,e,n){-1==jsPlumbUtil.findWithFunction(t,n)&&t.push(e)},addToList:function(t,e,n){var i=t[e];return null==i&&(i=[],t[e]=i),i.push(n),i},EventGenerator:function(){var t={},e=this,n=["ready"];this.bind=function(n,i){return jsPlumbUtil.addToList(t,n,i),e},this.fire=function(i,o,r){if(t[i])for(var a=0;a<t[i].length;a++)if(-1!=jsPlumbUtil.findWithFunction(n,(function(t){return t===i})))t[i][a](o,r);else try{t[i][a](o,r)}catch(t){jsPlumbUtil.log("jsPlumb: fire failed for event "+i+" : "+t)}return e},this.unbind=function(n){return n?delete t[n]:t={},e},this.getListener=function(e){return t[e]}},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&"undefined"!=typeof console)try{var t=arguments[arguments.length-1];console.log(t)}catch(t){}},group:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.group(t)},groupEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.groupEnd(t)},time:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.time(t)},timeEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.timeEnd(t)}},function(){var t=!!document.createElement("canvas").getContext,e=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),n=function(){if(null==n.vml){var t=document.body.appendChild(document.createElement("div"));t.innerHTML='<v:shape id="vml_flag1" adj="1" />';var e=t.firstChild;e.style.behavior="url(#default#VML)",n.vml=!e||"object"==typeof e.adj,t.parentNode.removeChild(t)}return n.vml},i=function(t){var e={},n=[],i={},o={};this.register=function(r){var a=jsPlumb.CurrentLibrary;r=a.getElementObject(r);var s=t.getId(r),l=a.getDOMElement(r),c=a.getOffset(r);e[s]||(e[s]=r,n.push(r),i[s]={});var u=function(e,n){if(e)for(var r=0;r<e.childNodes.length;r++)if(3!=e.childNodes[r].nodeType){var l=a.getElementObject(e.childNodes[r]),d=t.getId(l,null,!0);if(d&&o[d]&&o[d]>0){var p=a.getOffset(l);i[s][d]={id:d,offset:{left:p.left-c.left,top:p.top-c.top}}}u(e.childNodes[r])}};u(l)},this.updateOffsets=function(e){var n=jsPlumb.CurrentLibrary,o=n.getElementObject(e),r=t.getId(o),a=i[r],s=n.getOffset(o);if(a)for(var l in a){var c=n.getElementObject(l),u=n.getOffset(c);i[r][l]={id:l,offset:{left:u.left-s.left,top:u.top-s.top}}}},this.endpointAdded=function(n){var r=jsPlumb.CurrentLibrary,a=document.body,s=t.getId(n),l=r.getDOMElement(n).parentNode;for(o[s]=o[s]?o[s]+1:1;l!=a;){var c=t.getId(l,null,!0);if(c&&e[c]){var u=r.getElementObject(l),d=r.getOffset(u);if(null==i[c][s]){var p=jsPlumb.CurrentLibrary.getOffset(n);i[c][s]={id:s,offset:{left:p.left-d.left,top:p.top-d.top}}}break}l=l.parentNode}},this.endpointDeleted=function(t){if(o[t.elementId]&&(o[t.elementId]--,o[t.elementId]<=0))for(var e in i)delete i[e][t.elementId]},this.getElementsForDraggable=function(t){return i[t]},this.reset=function(){e={},n=[],i={},o={}}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}),window.jsPlumbAdapter={headless:!1,appendToRoot:function(t){document.body.appendChild(t)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(i){return{canvas:t,svg:e,vml:n()}[i]},getDragManager:function(t){return new i(t)},setRenderMode:function(t){var e;if(t){t=t.toLowerCase();var n=this.isRenderModeAvailable("canvas"),i=this.isRenderModeAvailable("svg"),o=this.isRenderModeAvailable("vml");"svg"===t?i?e="svg":n?e="canvas":o&&(e="vml"):"canvas"===t&&n?e="canvas":o&&(e="vml")}return e}}}(),function(){var t=jsPlumbUtil.findWithFunction,e=jsPlumbUtil.indexOf,n=jsPlumbUtil.removeWithFunction,i=(jsPlumbUtil.remove,jsPlumbUtil.addWithFunction),o=(jsPlumbUtil.addToList,jsPlumbUtil.isArray),r=jsPlumbUtil.isString,a=jsPlumbUtil.isObject,s=function(t,e){return C.CurrentLibrary.getAttribute(d(t),e)},l=function(t,e,n){C.CurrentLibrary.setAttribute(d(t),e,n)},c=function(t,e){C.CurrentLibrary.addClass(d(t),e)},u=function(t,e){C.CurrentLibrary.removeClass(d(t),e)},d=function(t){return C.CurrentLibrary.getElementObject(t)},p=function(t,e){var n=C.CurrentLibrary.getOffset(d(t));if(null!=e){var i=e.getZoom();return{left:n.left/i,top:n.top/i}}return n},h=function(t){return C.CurrentLibrary.getSize(d(t))},f=jsPlumbUtil.log,g=(jsPlumbUtil.group,jsPlumbUtil.groupEnd,jsPlumbUtil.time,jsPlumbUtil.timeEnd,function(){return""+(new Date).getTime()}),m=function(t){var e=this,n=arguments,i=!1,o=t.parameters||{},r=e.idPrefix,a=r+(new Date).getTime(),s=null,l=null;e._jsPlumb=t._jsPlumb,e.getId=function(){return a},e.tooltip=t.tooltip,e.hoverClass=t.hoverClass||e._jsPlumb.Defaults.HoverClass||C.Defaults.HoverClass,jsPlumbUtil.EventGenerator.apply(this),this.clone=function(){var t=new Object;return e.constructor.apply(t,n),t},this.getParameter=function(t){return o[t]},this.getParameters=function(){return o},this.setParameter=function(t,e){o[t]=e},this.setParameters=function(t){o=t},this.overlayPlacements=[];var c=t.beforeDetach;this.isDetachAllowed=function(t){var n=e._jsPlumb.checkCondition("beforeDetach",t);if(c)try{n=c(t)}catch(t){f("jsPlumb: beforeDetach callback failed",t)}return n};var u=t.beforeDrop;this.isDropAllowed=function(t,n,i,o,r){var a=e._jsPlumb.checkCondition("beforeDrop",{sourceId:t,targetId:n,scope:i,connection:o,dropEndpoint:r});if(u)try{a=u({sourceId:t,targetId:n,scope:i,connection:o,dropEndpoint:r})}catch(t){f("jsPlumb: beforeDrop callback failed",t)}return a};var d=function(){if(s&&l){var t={};C.extend(t,s),C.extend(t,l),delete e.hoverPaintStyle,t.gradient&&s.fillStyle&&delete t.gradient,l=t}};this.setPaintStyle=function(t,n){s=t,e.paintStyleInUse=s,d(),n||e.repaint()},this.getPaintStyle=function(){return s},this.setHoverPaintStyle=function(t,n){l=t,d(),n||e.repaint()},this.getHoverPaintStyle=function(){return l},this.setHover=function(t,n,o){e._jsPlumb.currentlyDragging||e._jsPlumb.isHoverSuspended()||(i=t,null!=e.hoverClass&&null!=e.canvas&&(t?h.addClass(e.canvas,e.hoverClass):h.removeClass(e.canvas,e.hoverClass)),null!=l&&(e.paintStyleInUse=t?l:s,o=o||g(),e.repaint({timestamp:o,recalc:!1})),e.getAttachedElements&&!n&&w(t,g(),e))},this.isHover=function(){return i};var p=null;this.setZIndex=function(t){p=t},this.getZIndex=function(){return p};var h=C.CurrentLibrary,m=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],v={mouseout:"mouseexit"},y=function(t,e,n){var i=v[n]||n;h.bind(t,n,(function(t){e.fire(i,e,t)}))},b=function(t,e){v[e];h.unbind(t,e)};this.attachListeners=function(t,e){for(var n=0;n<m.length;n++)y(t,e,m[n])};var w=function(t,n,i){var o=e.getAttachedElements();if(o)for(var r=0;r<o.length;r++)i&&i==o[r]||o[r].setHover(t,!0,n)};this.reattachListenersForElement=function(t){if(arguments.length>1){for(var n=0;n<m.length;n++)b(t,m[n]);for(n=1;n<arguments.length;n++)e.attachListeners(t,arguments[n])}};var j=[],P=function(t){return null==t?null:t.split(" ")},x=function(t){if(e.getDefaultType){for(var n=e.getTypeDescriptor(),i=jsPlumbUtil.merge({},e.getDefaultType()),o=0;o<j.length;o++)i=jsPlumbUtil.merge(i,e._jsPlumb.getType(j[o],n));e.applyType(i),t||e.repaint()}};e.setType=function(t,e){j=P(t)||[],x(e)},e.getType=function(){return j},e.hasType=function(t){return-1!=jsPlumbUtil.indexOf(j,t)},e.addType=function(t,n){var i=P(t),o=!1;if(null!=i){for(var r=0;r<i.length;r++)e.hasType(i[r])||(j.push(i[r]),o=!0);o&&x(n)}},e.removeType=function(t,e){var n,i,o=P(t),r=!1;if(null!=o){for(var a=0;a<o.length;a++)n=o[a],i=void 0,r=-1!=(i=jsPlumbUtil.indexOf(j,n))&&(j.splice(i,1),!0)||r;r&&x(e)}},e.toggleType=function(t,e){var n=P(t);if(null!=n){for(var i=0;i<n.length;i++){var o=jsPlumbUtil.indexOf(j,n[i]);-1!=o?j.splice(o,1):j.push(n[i])}x(e)}},this.applyType=function(t){if(e.setPaintStyle(t.paintStyle),e.setHoverPaintStyle(t.hoverPaintStyle),t.parameters)for(var n in t.parameters)e.setParameter(n,t.parameters[n])}},v=function(t){m.apply(this,arguments);var e=this;this.overlays=[];var n=function(t){var n=null;if(o(t)){var i=t[0],r=C.extend({component:e,_jsPlumb:e._jsPlumb},t[1]);if(3==t.length&&C.extend(r,t[2]),n=new(C.Overlays[e._jsPlumb.getRenderMode()][i])(r),r.events)for(var a in r.events)n.bind(a,r.events[a])}else n=t.constructor==String?new(C.Overlays[e._jsPlumb.getRenderMode()][t])({component:e,_jsPlumb:e._jsPlumb}):t;e.overlays.push(n)},i=function(t){var n,i=e.defaultOverlayKeys||[],o=t.overlays;o||(o=[]);for(var r=0;r<i.length;r++)o.unshift.apply(o,(n=i[r],e._jsPlumb.Defaults[n]||C.Defaults[n]||[]));return o},r=i(t);if(r)for(var a=0;a<r.length;a++)n(r[a]);var s=function(t){for(var n=-1,i=0;i<e.overlays.length;i++)if(t===e.overlays[i].id){n=i;break}return n};this.addOverlay=function(t,i){n(t),i||e.repaint()},this.getOverlay=function(t){var n=s(t);return n>=0?e.overlays[n]:null},this.getOverlays=function(){return e.overlays},this.hideOverlay=function(t){var n=e.getOverlay(t);n&&n.hide()},this.hideOverlays=function(){for(var t=0;t<e.overlays.length;t++)e.overlays[t].hide()},this.showOverlay=function(t){var n=e.getOverlay(t);n&&n.show()},this.showOverlays=function(){for(var t=0;t<e.overlays.length;t++)e.overlays[t].show()},this.removeAllOverlays=function(){for(var t=0;t<e.overlays.length;t++)e.overlays[t].cleanup&&e.overlays[t].cleanup();e.overlays.splice(0,e.overlays.length),e.repaint()},this.removeOverlay=function(t){var n=s(t);if(-1!=n){var i=e.overlays[n];i.cleanup&&i.cleanup(),e.overlays.splice(n,1)}},this.removeOverlays=function(){for(var t=0;t<arguments.length;t++)e.removeOverlay(arguments[t])};var l="__label",c=function(t){var n={cssClass:t.cssClass,labelStyle:this.labelStyle,id:l,component:e,_jsPlumb:e._jsPlumb},i=C.extend(n,t);return new(C.Overlays[e._jsPlumb.getRenderMode()].Label)(i)};if(t.label){var u=t.labelLocation||e.defaultLabelLocation||.5,d=t.labelStyle||e._jsPlumb.Defaults.LabelStyle||C.Defaults.LabelStyle;this.overlays.push(c({label:t.label,location:u,labelStyle:d}))}this.setLabel=function(t){var n=e.getOverlay(l);if(n)t.constructor==String||t.constructor==Function?n.setLabel(t):(t.label&&n.setLabel(t.label),t.location&&n.setLocation(t.location));else{var i=t.constructor==String||t.constructor==Function?{label:t}:t;n=c(i),this.overlays.push(n)}e._jsPlumb.isSuspendDrawing()||e.repaint()},this.getLabel=function(){var t=e.getOverlay(l);return null!=t?t.getLabel():null},this.getLabelOverlay=function(){return e.getOverlay(l)};var p=this.applyType;this.applyType=function(t){if(p(t),e.removeAllOverlays(),t.overlays)for(var n=0;n<t.overlays.length;n++)e.addOverlay(t.overlays[n],!0)}},y=function(t,e,n){t.bind("click",(function(t,n){e.fire("click",e,n)})),t.bind("dblclick",(function(t,n){e.fire("dblclick",e,n)})),t.bind("contextmenu",(function(t,n){e.fire("contextmenu",e,n)})),t.bind("mouseenter",(function(t,i){e.isHover()||(n(!0),e.fire("mouseenter",e,i))})),t.bind("mouseexit",(function(t,i){e.isHover()&&(n(!1),e.fire("mouseexit",e,i))}))},b=0,w=function(w){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",ConnectorZIndex:null,Container:null,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},w&&C.extend(this.Defaults,w),this.logEnabled=this.Defaults.LogEnabled;var j={},P={};this.registerConnectionType=function(t,e){j[t]=C.extend({},e)},this.registerConnectionTypes=function(t){for(var e in t)j[e]=C.extend({},t[e])},this.registerEndpointType=function(t,e){P[t]=C.extend({},e)},this.registerEndpointTypes=function(t){for(var e in t)P[e]=C.extend({},t[e])},this.getType=function(t,e){return"connection"===e?j[t]:P[t]},jsPlumbUtil.EventGenerator.apply(this);var x=this,E=function(){var t=b+1;return b++,t}(),D=x.bind,S={},I=1;for(var _ in this.setZoom=function(t,e){I=t,e&&x.repaintEverything()},this.getZoom=function(){return I},this.Defaults)S[_]=this.Defaults[_];this.bind=function(t,e){"ready"===t&&k?e():D.apply(x,[t,e])},x.importDefaults=function(t){for(var e in t)x.Defaults[e]=t[e]},x.restoreDefaults=function(){x.Defaults=C.extend({},S)};var M=null,k=!1,O={},A={},L={},T={},W={},z={},H={},F=[],B=this.Defaults.Scope,U=null,R=function(t,e,n){var i=t[e];return null==i&&(i=[],t[e]=i),i.push(n),i},$=function(t,e){x.Defaults.Container?C.CurrentLibrary.appendElement(t,x.Defaults.Container):e?C.CurrentLibrary.appendElement(t,e):jsPlumbAdapter.appendToRoot(t)},N=1,V=function(){return""+N++},G=function(t){return t._nodes?t._nodes:t},Y=function(t,e,n){if(!jsPlumbAdapter.headless&&!Ut){var i=s(t,"id"),o=x.dragManager.getElementsForDraggable(i);if(null==n&&(n=g()),x.anchorManager.redraw(i,e,n),o)for(var r in o)x.anchorManager.redraw(o[r].id,e,n,o[r].offset)}},X=function(t,e){var n=null;if(o(t)){n=[];for(var i=0;i<t.length;i++){var r=d(t[i]),a=s(r,"id");n.push(e(r,a))}}else{n=e(r=d(t),a=s(r,"id"))}return n},Z=function(t){return L[t]},q=function(t,e,n){if(!jsPlumbAdapter.headless){var i=null!=e&&e,o=C.CurrentLibrary;if(i&&o.isDragSupported(t)){var r=n||x.Defaults.DragOptions||C.Defaults.DragOptions;r=C.extend({},r);var a=o.dragEvents.drag,s=o.dragEvents.stop,l=o.dragEvents.start;r[l]=ut(r[l],(function(){x.setHoverSuspended(!0)})),r[a]=ut(r[a],(function(){var e=o.getUIPosition(arguments,x.getZoom());Y(t,e),c(t,"jsPlumb_dragged")})),r[s]=ut(r[s],(function(){var e=o.getUIPosition(arguments,x.getZoom());Y(t,e),u(t,"jsPlumb_dragged"),x.setHoverSuspended(!1)}));var d=ct(t);H[d]=!0;i=H[d];r.disabled=null!=i&&!i,o.initDraggable(t,r,!1),x.dragManager.register(t)}}},Q=function(t){var e=x.Defaults.ConnectionType||x.getDefaultConnectionType(),n=x.Defaults.EndpointType||le,i=C.CurrentLibrary.getParent;t.container?t.parent=t.container:t.sourceEndpoint?t.parent=t.sourceEndpoint.parent:t.source.constructor==n?t.parent=t.source.parent:t.parent=i(t.source),t._jsPlumb=x;var o=new e(t);return o.id="con_"+V(),J("click","click",o),J("dblclick","dblclick",o),J("contextmenu","contextmenu",o),o},K=function(t,e,n){if(e=e||{},t.suspendedEndpoint||R(O,t.scope,t),!e.doNotFireConnectionEvent&&!1!==e.fireEvent){var i={connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]};x.fire("jsPlumbConnection",i,n),x.fire("connection",i,n)}x.anchorManager.newConnection(t),Y(t.source)},J=function(t,e,n){n.bind(t,(function(t,i){x.fire(e,n,i)}))},tt=function(t){if(t.container)return t.container;var e=C.CurrentLibrary.getTagName(t.source),n=C.CurrentLibrary.getParent(t.source);return e&&"td"===e.toLowerCase()?C.CurrentLibrary.getParent(n):n},et=function(t){var e=x.Defaults.EndpointType||le;t.parent=tt(t),t._jsPlumb=x;var n=new e(t);return n.id="ep_"+V(),J("click","endpointClick",n),J("dblclick","endpointDblClick",n),J("contextmenu","contextmenu",n),jsPlumbAdapter.headless||x.dragManager.endpointAdded(t.source),n},nt=function(t,e,n){var i=A[t];if(i&&i.length)for(var o=0;o<i.length;o++){for(var r=0;r<i[o].connections.length;r++){if(e(i[o].connections[r]))return}n&&n(i[o])}},it=function(t,e){null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t)},ot=function(t,e){for(var n=0;n<t.length;n++)it(t[n])},rt=function(t,e,n){e="block"===e;var i=null;n&&(i=e?function(t){t.setVisible(!0,!0,!0)}:function(t){t.setVisible(!1,!0,!0)});var o=s(t,"id");nt(o,(function(t){if(e&&n){var i=t.sourceId===o?1:0;t.endpoints[i].isVisible()&&t.setVisible(!0)}else t.setVisible(e)}),i)},at=function(t,e){var n=null;e&&(n=function(t){var e=t.isVisible();t.setVisible(!e)}),nt(t,(function(t){var e=t.isVisible();t.setVisible(!e)}),n)},st=function(t){var e,n=t.timestamp,i=t.recalc,o=t.offset,r=t.elId;if(Ut&&!n&&(n=Rt),!i&&n&&n===W[r])return T[r];i||!o?null!=(e=d(r))&&(F[r]=h(e),T[r]=p(e,x),W[r]=n):(T[r]=o,null==F[r]&&null!=(e=d(r))&&(F[r]=h(e)));return T[r]&&!T[r].right&&(T[r].right=T[r].left+F[r][0],T[r].bottom=T[r].top+F[r][1],T[r].width=F[r][0],T[r].height=F[r][1],T[r].centerx=T[r].left+T[r].width/2,T[r].centery=T[r].top+T[r].height/2),T[r]},lt=function(t){var e=T[t];return e||(e=st({elId:t})),{o:e,s:F[t]}},ct=function(t,e,n){var i=d(t),o=s(i,"id");return o&&"undefined"!=o||(2==arguments.length&&null!=arguments[1]?o=e:(1==arguments.length||3==arguments.length&&!arguments[2])&&(o="jsPlumb_"+E+"_"+V()),n||l(i,"id",o)),o},ut=function(t,e,n){return t=t||function(){},e=e||function(){},function(){var i=null;try{i=e.apply(this,arguments)}catch(t){f(x,"jsPlumb function failed : "+t)}if(null==n||i!==n)try{t.apply(this,arguments)}catch(t){f(x,"wrapped function failed : "+t)}return i}};this.connectorClass="_jsPlumb_connector",this.endpointClass="_jsPlumb_endpoint",this.overlayClass="_jsPlumb_overlay",this.Anchors={},this.Connectors={canvas:{},svg:{},vml:{}},this.Endpoints={canvas:{},svg:{},vml:{}},this.Overlays={canvas:{},svg:{},vml:{}},this.addClass=function(t,e){return C.CurrentLibrary.addClass(t,e)},this.removeClass=function(t,e){return C.CurrentLibrary.removeClass(t,e)},this.hasClass=function(t,e){return C.CurrentLibrary.hasClass(t,e)},this.addEndpoint=function(t,e,n){n=n||{};var i=C.extend({},n);C.extend(i,e),i.endpoint=i.endpoint||x.Defaults.Endpoint||C.Defaults.Endpoint,i.paintStyle=i.paintStyle||x.Defaults.EndpointStyle||C.Defaults.EndpointStyle;for(var o=[],r=(t=G(t)).length&&t.constructor!=String?t:[t],a=0;a<r.length;a++){var s=d(r[a]),l=ct(s);i.source=s,st({elId:l,timestamp:Rt});var c=et(i);i.parentAnchor&&(c.parentAnchor=i.parentAnchor),R(A,l,c);var u=T[l],p=F[l],h={anchorLoc:c.anchor.compute({xy:[u.left,u.top],wh:p,element:c,timestamp:Rt}),timestamp:Rt};Ut&&(h.recalc=!1),c.paint(h),o.push(c)}return 1==o.length?o[0]:o},this.addEndpoints=function(t,e,n){for(var i=[],r=0;r<e.length;r++){var a=x.addEndpoint(t,e[r],n);o(a)?Array.prototype.push.apply(i,a):i.push(a)}return i},this.animate=function(t,e,n){var i=d(t),o=s(t,"id");n=n||{};var r=C.CurrentLibrary.dragEvents.step,a=C.CurrentLibrary.dragEvents.complete;n[r]=ut(n[r],(function(){x.repaint(o)})),n[a]=ut(n[a],(function(){x.repaint(o)})),C.CurrentLibrary.animate(i,e,n)},this.checkCondition=function(t,e){var n=x.getListener(t),i=!0;if(n&&n.length>0)try{for(var o=0;o<n.length;o++)i=i&&n[o](e)}catch(e){f(x,"cannot check condition ["+t+"]"+e)}return i},this.checkASyncCondition=function(t,e,n,i){var o=x.getListener(t);if(o&&o.length>0)try{o[0](e,n,i)}catch(e){f(x,"cannot asynchronously check condition ["+t+"]"+e)}},this.connect=function(t,e){var n,i=function(t,e){var n=C.extend({sourceIsNew:!0,targetIsNew:!0},t);if(e&&C.extend(n,e),n.source&&n.source.endpoint&&(n.sourceEndpoint=n.source),n.source&&n.target.endpoint&&(n.targetEndpoint=n.target),t.uuids&&(n.sourceEndpoint=Z(t.uuids[0]),n.targetEndpoint=Z(t.uuids[1])),n.sourceEndpoint&&n.sourceEndpoint.isFull())f(x,"could not add connection; source endpoint is full");else{if(!n.targetEndpoint||!n.targetEndpoint.isFull()){if(n.sourceEndpoint&&(n.sourceIsNew=!1),n.targetEndpoint&&(n.targetIsNew=!1),!n.type&&n.sourceEndpoint&&(n.type=n.sourceEndpoint.connectionType),n.sourceEndpoint&&n.sourceEndpoint.connectorOverlays){n.overlays=n.overlays||[];for(var i=0;i<n.sourceEndpoint.connectorOverlays.length;i++)n.overlays.push(n.sourceEndpoint.connectorOverlays[i])}if(n.tooltip=t.tooltip,!n.tooltip&&n.sourceEndpoint&&n.sourceEndpoint.connectorTooltip&&(n.tooltip=n.sourceEndpoint.connectorTooltip),n.target&&!n.target.endpoint&&!n.targetEndpoint&&!n.newConnection){var o=ct(n.target),r=St[o],a=It[o];if(r){if(!Ht[o])return;var s=null!=a?a:x.addEndpoint(n.target,r);_t[o]&&(It[o]=s),n.targetEndpoint=s,s._makeTargetCreator=!0,n.targetIsNew=!0}}if(n.source&&!n.source.endpoint&&!n.sourceEndpoint&&!n.newConnection&&(o=ct(n.source),r=Ot[o],a=At[o],r)){if(!Tt[o])return;s=null!=a?a:x.addEndpoint(n.source,r),Lt[o]&&(At[o]=s),n.sourceEndpoint=s,n.sourceIsNew=!0}return n}f(x,"could not add connection; target endpoint is full")}}(t,e);return i&&(null==i.deleteEndpointsOnDetach&&(i.deleteEndpointsOnDetach=!0),n=Q(i),K(n,i)),n},this.deleteEndpoint=function(t){var e="string"==typeof t?L[t]:t;if(e){var n=e.getUuid();for(var i in n&&(L[n]=null),e.detachAll(),e.endpoint.cleanup&&e.endpoint.cleanup(),ot(e.endpoint.getDisplayElements()),x.anchorManager.deleteEndpoint(e),A){var o=A[i];if(o){for(var r=[],a=0;a<o.length;a++)o[a]!=e&&r.push(o[a]);A[i]=r}}jsPlumbAdapter.headless||x.dragManager.endpointDeleted(e)}},this.deleteEveryEndpoint=function(){for(var t in x.setSuspendDrawing(!0),A){var e=A[t];if(e&&e.length)for(var n=0;n<e.length;n++)x.deleteEndpoint(e[n])}A={},L={},x.setSuspendDrawing(!1,!0)};var dt=function(t,e,n){var i=x.Defaults.ConnectionType||x.getDefaultConnectionType(),o=t.constructor==i?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;e&&(x.fire("jsPlumbConnectionDetached",o,n),x.fire("connectionDetached",o,n)),x.anchorManager.connectionDetached(o)},pt=function(t){x.fire("connectionDrag",t)},ht=function(t){x.fire("connectionDragStop",t)};this.detach=function(){if(0!=arguments.length){var t=x.Defaults.ConnectionType||x.getDefaultConnectionType(),e=arguments[0].constructor==t,n=2==arguments.length&&e?arguments[1]||{}:arguments[0],i=!1!==n.fireEvent,o=n.forceDetach,r=e?arguments[0]:n.connection;if(r)(o||r.isDetachAllowed(r)&&r.endpoints[0].isDetachAllowed(r)&&r.endpoints[1].isDetachAllowed(r))&&(o||x.checkCondition("beforeDetach",r))&&r.endpoints[0].detach(r,!1,!0,i);else{var a=C.extend({},n);if(a.uuids)Z(a.uuids[0]).detachFrom(Z(a.uuids[1]),i);else if(a.sourceEndpoint&&a.targetEndpoint)a.sourceEndpoint.detachFrom(a.targetEndpoint);else{var s=ct(a.source),l=ct(a.target);nt(s,(function(t){(t.sourceId==s&&t.targetId==l||t.targetId==s&&t.sourceId==l)&&x.checkCondition("beforeDetach",t)&&t.endpoints[0].detach(t,!1,!0,i)}))}}}},this.detachAllConnections=function(t,e){e=e||{},t=d(t);var n=s(t,"id"),i=A[n];if(i&&i.length)for(var o=0;o<i.length;o++)i[o].detachAll(e.fireEvent)},this.detachEveryConnection=function(t){for(var e in t=t||{},A){var n=A[e];if(n&&n.length)for(var i=0;i<n.length;i++)n[i].detachAll(t.fireEvent)}O={}},this.draggable=function(t,e){if("object"==typeof t&&t.length)for(var n=0;n<t.length;n++){(i=d(t[n]))&&q(i,!0,e)}else if(t._nodes)for(n=0;n<t._nodes.length;n++){(i=d(t._nodes[n]))&&q(i,!0,e)}else{var i;(i=d(t))&&q(i,!0,e)}},this.extend=function(t,e){return C.CurrentLibrary.extend(t,e)},this.getDefaultEndpointType=function(){return le},this.getDefaultConnectionType=function(){return oe};var ft=function(t,e,n,i){for(var o=0;o<t.length;o++)t[o][e].apply(t[o],n);return i(t)},gt=function(t,e,n){for(var i=[],o=0;o<t.length;o++)i.push([t[o][e].apply(t[o],n),t[o]]);return i},mt=function(t,e,n){return function(){return ft(t,e,arguments,n)}},vt=function(t,e){return function(){return gt(t,e,arguments)}},yt=function(t,e){var n=[];if(t)if("string"==typeof t){if("*"===t)return t;n.push(t)}else if(e)n=t;else for(var i=0;i<t.length;i++)n.push(ct(d(t[i])));return n},bt=function(t,n,i){return"*"===t||(t.length>0?-1!=e(t,n):!i)};this.getConnections=function(t,e){t?t.constructor==String&&(t={scope:t}):t={};var n=t.scope||x.getDefaultScope(),i=yt(n,!0),o=yt(t.source),r=yt(t.target),a=!e&&i.length>1?{}:[],s=function(t,n){if(!e&&i.length>1){var o=a[t];null==o&&(o=[],a[t]=o),o.push(n)}else a.push(n)};for(var l in O)if(bt(i,l))for(var c=0;c<O[l].length;c++){var u=O[l][c];bt(o,u.sourceId)&&bt(r,u.targetId)&&s(l,u)}return a};var wt=function(t,e){return function(n){for(var i=0;i<t.length;i++)n(t[i]);return e(t)}},Ct=function(t){return function(e){return t[e]}},jt=function(t,e){return{setHover:mt(t,"setHover",e),removeAllOverlays:mt(t,"removeAllOverlays",e),setLabel:mt(t,"setLabel",e),addOverlay:mt(t,"addOverlay",e),removeOverlay:mt(t,"removeOverlay",e),removeOverlays:mt(t,"removeOverlays",e),showOverlay:mt(t,"showOverlay",e),hideOverlay:mt(t,"hideOverlay",e),showOverlays:mt(t,"showOverlays",e),hideOverlays:mt(t,"hideOverlays",e),setPaintStyle:mt(t,"setPaintStyle",e),setHoverPaintStyle:mt(t,"setHoverPaintStyle",e),setParameter:mt(t,"setParameter",e),setParameters:mt(t,"setParameters",e),setVisible:mt(t,"setVisible",e),setZIndex:mt(t,"setZIndex",e),repaint:mt(t,"repaint",e),addType:mt(t,"addType",e),toggleType:mt(t,"toggleType",e),removeType:mt(t,"removeType",e),getLabel:vt(t,"getLabel"),getOverlay:vt(t,"getOverlay"),isHover:vt(t,"isHover"),getParameter:vt(t,"getParameter"),getParameters:vt(t,"getParameters"),getPaintStyle:vt(t,"getPaintStyle"),getHoverPaintStyle:vt(t,"getHoverPaintStyle"),isVisible:vt(t,"isVisible"),getZIndex:vt(t,"getZIndex"),hasType:vt(t,"hasType"),getType:vt(t,"getType"),length:t.length,each:wt(t,e),get:Ct(t)}},Pt=function(t){var e=jt(t,Pt);return C.CurrentLibrary.extend(e,{setDetachable:mt(t,"setDetachable",Pt),setReattach:mt(t,"setReattach",Pt),setConnector:mt(t,"setConnector",Pt),detach:function(){for(var e=0;e<t.length;e++)x.detach(t[e])},isDetachable:vt(t,"isDetachable"),isReattach:vt(t,"isReattach")})},xt=function(t){var e=jt(t,xt);return C.CurrentLibrary.extend(e,{setEnabled:mt(t,"setEnabled",xt),isEnabled:vt(t,"isEnabled"),detachAll:function(){for(var e=0;e<t.length;e++)t[e].detachAll()},delete:function(){for(var e=0;e<t.length;e++)x.deleteEndpoint(t[e])}})};this.select=function(t){(t=t||{}).scope=t.scope||"*";var e=x.getConnections(t,!0);return Pt(e)},this.selectEndpoints=function(t){(t=t||{}).scope=t.scope||"*";var e=!t.element&&!t.source&&!t.target,n=e?"*":yt(t.element),i=e?"*":yt(t.source),o=e?"*":yt(t.target),r=yt(t.scope,!0),a=[];for(var s in A){var l=bt(n,s,!0),c=bt(i,s,!0),u="*"!=i,d=bt(o,s,!0),p="*"!=o;if(l||c||d)t:for(var h=0;h<A[s].length;h++){var f=A[s][h];if(bt(r,f.scope,!0)){var g=u&&i.length>0&&!f.isSource,m=p&&o.length>0&&!f.isTarget;if(g||m)continue t;a.push(f)}}}return xt(a)},this.getAllConnections=function(){return O},this.getDefaultScope=function(){return B},this.getEndpoint=Z,this.getEndpoints=function(t){return A[ct(t)]},this.getId=ct,this.getOffset=function(t){T[t];return st({elId:t})},this.getSelector=function(t){return C.CurrentLibrary.getSelector(t)},this.getSize=function(t){return F[t]||st({elId:t}),F[t]},this.appendElement=$;var Et=!1;this.isHoverSuspended=function(){return Et},this.setHoverSuspended=function(t){Et=t};var Dt=function(t){return function(){return jsPlumbAdapter.isRenderModeAvailable(t)}};this.isCanvasAvailable=Dt("canvas"),this.isSVGAvailable=Dt("svg"),this.isVMLAvailable=Dt("vml"),this.hide=function(t,e){rt(t,"none",e)},this.idstamp=V,this.init=function(){if(!k){x.setRenderMode(x.Defaults.RenderMode);var t=function(t){C.CurrentLibrary.bind(document,t,(function(e){if(!x.currentlyDragging&&U==C.CANVAS){for(var n in O)for(var i=O[n],o=0;o<i.length;o++){if(i[o].connector[t](e))return}for(var r in A){var a=A[r];for(o=0;o<a.length;o++)if(a[o].endpoint[t](e))return}}}))};t("click"),t("dblclick"),t("mousemove"),t("mousedown"),t("mouseup"),t("contextmenu"),k=!0,x.fire("ready")}},this.log=M,this.jsPlumbUIComponent=m,this.makeAnchor=function(){if(0==arguments.length)return null;var t=arguments[0],e=arguments[1],n=null;if(t.compute&&t.getOrientation)return t;if("string"==typeof t)n=C.Anchors[arguments[0]]({elementId:e,jsPlumbInstance:x});else if(o(t))if(o(t[0])||r(t[0]))if(2==t.length&&r(t[0])&&a(t[1])){var i=C.extend({elementId:e,jsPlumbInstance:x},t[1]);n=C.Anchors[t[0]](i)}else n=new Gt(t,null,e);else{var s={x:t[0],y:t[1],orientation:t.length>=4?[t[2],t[3]]:[0,0],offsets:6==t.length?[t[4],t[5]]:[0,0],elementId:e};(n=new Nt(s)).clone=function(){return new Nt(s)}}return n.id||(n.id="anchor_"+V()),n},this.makeAnchors=function(t,e,n){for(var i=[],r=0;r<t.length;r++)"string"==typeof t[r]?i.push(C.Anchors[t[r]]({elementId:e,jsPlumbInstance:n})):o(t[r])&&i.push(x.makeAnchor(t[r],e,n));return i},this.makeDynamicAnchor=function(t,e){return new Gt(t,e)};var St={},It={},_t={},Mt={},kt=function(t,e){t.paintStyle=t.paintStyle||x.Defaults.EndpointStyles[e]||x.Defaults.EndpointStyle||C.Defaults.EndpointStyles[e]||C.Defaults.EndpointStyle,t.hoverPaintStyle=t.hoverPaintStyle||x.Defaults.EndpointHoverStyles[e]||x.Defaults.EndpointHoverStyle||C.Defaults.EndpointHoverStyles[e]||C.Defaults.EndpointHoverStyle,t.anchor=t.anchor||x.Defaults.Anchors[e]||x.Defaults.Anchor||C.Defaults.Anchors[e]||C.Defaults.Anchor,t.endpoint=t.endpoint||x.Defaults.Endpoints[e]||x.Defaults.Endpoint||C.Defaults.Endpoints[e]||C.Defaults.Endpoint};this.makeTarget=function(t,e,n){var i=C.extend({_jsPlumb:x},n);C.extend(i,e),kt(i,1);var o=C.CurrentLibrary,r=i.scope||x.Defaults.Scope,a=!(!1===i.deleteEndpointsOnDetach),l=i.maxConnections||-1,c=i.onMaxConnections;_doOne=function(t){var e=ct(t);St[e]=i,_t[e]=i.uniqueEndpoint,Mt[e]=l,Ht[e]=!0,proxyComponent=new m(i);var n=C.extend({},i.dropOptions||{}),u=o.dragEvents.drop;n.scope=n.scope||r,n[u]=ut(n[u],(function(){var n=C.CurrentLibrary.getDropEvent(arguments),r=x.select({target:e}).length;x.currentlyDragging=!1;var l=d(o.getDragObject(arguments)),u=s(l,"dragId"),f=s(l,"originalScope"),g=z[u],m=g.endpoints[0];i.endpoint&&C.extend({},i.endpoint);if(!Ht[e]||Mt[e]>0&&r>=Mt[e])return c&&c({element:t,connection:g},n),!1;m.anchor.locked=!1,f&&o.setDragScope(l,f);var v=proxyComponent.isDropAllowed(g.sourceId,ct(t),g.scope,g,null);if(g.endpointsToDeleteOnDetach&&(m===g.endpointsToDeleteOnDetach[0]?g.endpointsToDeleteOnDetach[0]=null:m===g.endpointsToDeleteOnDetach[1]&&(g.endpointsToDeleteOnDetach[1]=null)),g.suspendedEndpoint&&(g.targetId=g.suspendedEndpoint.elementId,g.target=o.getElementObject(g.suspendedEndpoint.elementId),g.endpoints[1]=g.suspendedEndpoint),v){m.detach(g,!1,!0,!1);var y=It[e]||x.addEndpoint(t,i);if(i.uniqueEndpoint&&(It[e]=y),y._makeTargetCreator=!0,null!=y.anchor.positionFinder){var b=o.getUIPosition(arguments,x.getZoom()),w=p(t,x),j=h(t),P=y.anchor.positionFinder(b,w,j,y.anchor.constructorParams);y.anchor.x=P[0],y.anchor.y=P[1]}var E=x.connect({source:m,target:y,scope:f,previousConnection:g,container:g.parent,deleteEndpointsOnDetach:a,doNotFireConnectionEvent:m.endpointWillMoveAfterConnection});g.endpoints[1]._makeTargetCreator&&g.endpoints[1].connections.length<2&&x.deleteEndpoint(g.endpoints[1]),a&&(E.endpointsToDeleteOnDetach=[m,y]),E.repaint()}else g.suspendedEndpoint&&(g.isReattach()?(g.setHover(!1),g.floatingAnchorIndex=null,g.suspendedEndpoint.addConnection(g),x.repaint(m.elementId)):m.detach(g,!1,!0,!0,n))})),o.initDroppable(t,n,!0)};for(var u=(t=G(t)).length&&t.constructor!=String?t:[t],f=0;f<u.length;f++)_doOne(d(u[f]));return x},this.unmakeTarget=function(t,e){t=C.CurrentLibrary.getElementObject(t);var n=ct(t);return e||(delete St[n],delete _t[n],delete Mt[n],delete Ht[n]),x},this.makeTargets=function(t,e,n){for(var i=0;i<t.length;i++)x.makeTarget(t[i],e,n)};var Ot={},At={},Lt={},Tt={},Wt={},zt={},Ht={};this.makeSource=function(t,e,i){var o=C.extend({},i);C.extend(o,e),kt(o,0);for(var r=C.CurrentLibrary,a=o.maxConnections||-1,s=o.onMaxConnections,l=function(t){var i=ct(t),l=o.parent,c=null!=l?x.getId(r.getElementObject(l)):i;Ot[c]=o,Lt[c]=o.uniqueEndpoint,Tt[c]=!0;var u=r.dragEvents.stop,d=r.dragEvents.drag,p=C.extend({},o.dragOptions||{}),h=p.drag,f=p.stop,g=null,m=!1;zt[c]=a,p.scope=p.scope||o.scope,p[d]=ut(p[d],(function(){h&&h.apply(this,arguments),m=!1})),p[u]=ut(p[u],(function(){if(f&&f.apply(this,arguments),x.currentlyDragging=!1,0==g.connections.length)x.deleteEndpoint(g);else{r.unbind(g.canvas,"mousedown");var t=o.anchor||x.Defaults.Anchor,e=(g.anchor,g.connections[0]);if(g.anchor=x.makeAnchor(t,i,x),o.parent){var a=r.getElementObject(o.parent);if(a){var s=g.elementId,l=o.container||x.Defaults.Container||C.Defaults.Container;g.setElement(a,l),g.endpointWillMoveAfterConnection=!1,x.anchorManager.rehomeEndpoint(s,a),e.previousConnection=null,n(O[e.scope],(function(t){return t.id===e.id})),x.anchorManager.connectionDetached({sourceId:e.sourceId,targetId:e.targetId,connection:e}),K(e)}}g.repaint(),x.repaint(g.elementId),x.repaint(e.targetId)}}));var v=function(n){if(Tt[c]){var l=x.select({source:c}).length;if(zt[c]>=0&&l>=zt[c])return s&&s({element:t,maxConnections:a},n),!1;if(e.filter)if(!1===e.filter(r.getOriginalEvent(n),t))return;var u=st({elId:i}),d=((n.pageX||n.page.x)-u.left)/u.width,h=((n.pageY||n.page.y)-u.top)/u.height,f=d,v=h;if(o.parent){var y=r.getElementObject(o.parent),b=ct(y);u=st({elId:b}),f=((n.pageX||n.page.x)-u.left)/u.width,v=((n.pageY||n.page.y)-u.top)/u.height}var w={};if(C.extend(w,o),w.isSource=!0,w.anchor=[d,h,0,0],w.parentAnchor=[f,v,0,0],w.dragOptions=p,o.parent){var j=w.container||x.Defaults.Container||C.Defaults.Container;w.container=j||C.CurrentLibrary.getParent(o.parent)}g=x.addEndpoint(i,w),m=!0,g.endpointWillMoveAfterConnection=null!=o.parent,g.endpointWillMoveTo=o.parent?r.getElementObject(o.parent):null;var P=function(){m&&x.deleteEndpoint(g)};x.registerListener(g.canvas,"mouseup",P),x.registerListener(t,"mouseup",P),r.trigger(g.canvas,"mousedown",n)}};x.registerListener(t,"mousedown",v),Wt[i]=v},c=(t=G(t)).length&&t.constructor!=String?t:[t],u=0;u<c.length;u++)l(d(c[u]));return x},this.unmakeSource=function(t,e){t=C.CurrentLibrary.getElementObject(t);var n=ct(t),i=Wt[n];return i&&x.unregisterListener(_el,"mousedown",i),e||(delete Ot[n],delete Lt[n],delete Tt[n],delete Wt[n],delete zt[n]),x},this.unmakeEverySource=function(){for(var t in Tt)x.unmakeSource(t,!0);Ot={},Lt={},Tt={},Wt={}},this.unmakeEveryTarget=function(){for(var t in Ht)x.unmakeTarget(t,!0);return St={},_t={},Mt={},Ht={},x},this.makeSources=function(t,e,n){for(var i=0;i<t.length;i++)x.makeSource(t[i],e,n);return x};var Ft=function(t,e,n,i){var o="source"==t?Tt:Ht;if(r(e))o[e]=i?!o[e]:n;else if(e.length){e=G(e);for(var a=0;a<e.length;a++){var s=_el=C.CurrentLibrary.getElementObject(e[a]);o[s=ct(_el)]=i?!o[s]:n}}return x};this.setSourceEnabled=function(t,e){return Ft("source",t,e)},this.toggleSourceEnabled=function(t){return Ft("source",t,null,!0),x.isSourceEnabled(t)},this.isSource=function(t){return t=C.CurrentLibrary.getElementObject(t),null!=Tt[ct(t)]},this.isSourceEnabled=function(t){return t=C.CurrentLibrary.getElementObject(t),!0===Tt[ct(t)]},this.setTargetEnabled=function(t,e){return Ft("target",t,e)},this.toggleTargetEnabled=function(t){return Ft("target",t,null,!0)},this.isTarget=function(t){return t=C.CurrentLibrary.getElementObject(t),null!=Ht[ct(t)]},this.isTargetEnabled=function(t){return t=C.CurrentLibrary.getElementObject(t),!0===Ht[ct(t)]},this.ready=function(t){x.bind("ready",t)},this.repaint=function(t,e,n){if("object"==typeof t)for(var i=0;i<t.length;i++)Y(d(t[i]),e,n);else Y(d(t),e,n);return x},this.repaintEverything=function(){for(var t in A)Y(d(t));return x},this.removeAllEndpoints=function(t){var e=s(t,"id"),n=A[e];if(n)for(var i=0;i<n.length;i++)x.deleteEndpoint(n[i]);return A[e]=[],x};var Bt={};this.registerListener=function(t,e,n){C.CurrentLibrary.bind(t,e,n),R(Bt,e,{el:t,event:e,listener:n})},this.unregisterListener=function(t,e,i){C.CurrentLibrary.unbind(t,e,i),n(Bt,(function(t){return t.type==e&&t.listener==i}))},this.reset=function(){x.deleteEveryEndpoint(),x.unbind(),St={},It={},_t={},Mt={},Ot={},At={},Lt={},zt={},function(){for(var t in Bt)for(var e=0;e<Bt[t].length;e++){var n=Bt[t][e];C.CurrentLibrary.unbind(n.el,n.event,n.listener)}Bt={}}(),x.anchorManager.reset(),jsPlumbAdapter.headless||x.dragManager.reset()},this.setDefaultScope=function(t){return B=t,x},this.setDraggable=function(t,e){return X(t,(function(t,n){H[n]=e,C.CurrentLibrary.isDragSupported(t)&&C.CurrentLibrary.setDraggable(t,e)}))},this.setId=function(t,e,n){var i=t.constructor==String?t:x.getId(t),o=x.getConnections({source:i,scope:"*"},!0),r=x.getConnections({target:i,scope:"*"},!0);e=""+e,n||(t=C.CurrentLibrary.getElementObject(i),C.CurrentLibrary.setAttribute(t,"id",e)),t=C.CurrentLibrary.getElementObject(e),A[e]=A[i]||[];for(var a=0;a<A[e].length;a++)A[e][a].elementId=e,A[e][a].element=t,A[e][a].anchor.elementId=e;delete A[i],x.anchorManager.changeId(i,e);var s=function(n,i,o){for(var r=0;r<n.length;r++)n[r].endpoints[i].elementId=e,n[r].endpoints[i].element=t,n[r][o+"Id"]=e,n[r][o]=t};s(o,0,"source"),s(r,1,"target")},this.setIdChanged=function(t,e){x.setId(t,e,!0)},this.setDebugLog=function(t){M=t};var Ut=!1,Rt=null;this.setSuspendDrawing=function(t,e){Ut=t,Rt=t?(new Date).getTime():null,e&&x.repaintEverything()},this.isSuspendDrawing=function(){return Ut},this.CANVAS="canvas",this.SVG="svg",this.VML="vml",this.setRenderMode=function(t){return U=jsPlumbAdapter.setRenderMode(t)},this.getRenderMode=function(){return U},this.show=function(t,e){return rt(t,"block",e),x},this.sizeCanvas=function(t,e,n,i,o){return t&&(t.style.height=o+"px",t.height=o,t.style.width=i+"px",t.width=i,t.style.left=e+"px",t.style.top=n+"px"),x},this.getTestHarness=function(){return{endpointsByElement:A,endpointCount:function(t){var e=A[t];return e?e.length:0},connectionCount:function(t){var e=O[t=t||B];return e?e.length:0},getId:ct,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}},this.toggle=at,this.toggleVisible=at,this.toggleDraggable=function(t){return X(t,(function(t,e){var n=null!=H[e]&&H[e];return n=!n,H[e]=n,C.CurrentLibrary.setDraggable(t,n),n}))},this.wrap=ut,this.addListener=this.bind;var $t=function(t,e){var n=null,i=t;if("svg"===e.tagName.toLowerCase()&&e.parentNode?n=e.parentNode:e.offsetParent&&(n=e.offsetParent),null!=n){var o="body"===n.tagName.toLowerCase()?{left:0,top:0}:p(n,x),r="body"===n.tagName.toLowerCase()?{left:0,top:0}:{left:n.scrollLeft,top:n.scrollTop};i[0]=t[0]-o.left+r.left,i[1]=t[1]-o.top+r.top}return i},Nt=function(t){var e=this;this.x=t.x||0,this.y=t.y||0,this.elementId=t.elementId;var n=t.orientation||[0,0],i=null;this.offsets=t.offsets||[0,0],e.timestamp=null,this.compute=function(t){var n=t.xy,o=t.wh,r=t.element,a=t.timestamp;return a&&a===e.timestamp||(i=[n[0]+e.x*o[0]+e.offsets[0],n[1]+e.y*o[1]+e.offsets[1]],i=$t(i,r.canvas),e.timestamp=a),i},this.getOrientation=function(t){return n},this.equals=function(t){if(!t)return!1;var e=t.getOrientation(),n=this.getOrientation();return this.x==t.x&&this.y==t.y&&this.offsets[0]==t.offsets[0]&&this.offsets[1]==t.offsets[1]&&n[0]==e[0]&&n[1]==e[1]},this.getCurrentLocation=function(){return i}},Vt=function(t){var e=t.reference,n=t.referenceCanvas,i=h(d(n)),o=null,r=null;this.x=0,this.y=0,this.isFloating=!0,this.compute=function(t){var e=t.xy,n=t.element,o=[e[0]+i[0]/2,e[1]+i[1]/2];return o=$t(o,n.canvas),r=o,o},this.getOrientation=function(t){if(o)return o;var n=e.getOrientation(t);return[0*Math.abs(n[0])*-1,0*Math.abs(n[1])*-1]},this.over=function(t){o=t.getOrientation()},this.out=function(){o=null},this.getCurrentLocation=function(){return r}},Gt=function(t,e,n){this.isSelective=!0,this.isDynamic=!0;for(var i=[],o=function(t){return t.constructor==Nt?t:x.makeAnchor(t,n,x)},r=0;r<t.length;r++)i[r]=o(t[r]);this.addAnchor=function(t){i.push(o(t))},this.getAnchors=function(){return i},this.locked=!1;var a=i.length>0?i[0]:null,s=(i.length,this),l=function(t,e,n,i,o){var r=i[0]+t.x*o[0],a=i[1]+t.y*o[1],s=i[0]+o[0]/2,l=i[1]+o[1]/2;return Math.sqrt(Math.pow(e-r,2)+Math.pow(n-a,2))+Math.sqrt(Math.pow(s-r,2)+Math.pow(l-a,2))},c=e||function(t,e,n,i,o){for(var r=n[0]+i[0]/2,a=n[1]+i[1]/2,s=-1,c=1/0,u=0;u<o.length;u++){var d=l(o[u],r,a,t,e);d<c&&(s=u+0,c=d)}return o[s]};this.compute=function(t){var e=t.xy,n=t.wh,o=(t.timestamp,t.txy),r=t.twh;return s.locked||null==o||null==r||(t.timestamp=null,a=c(e,n,o,r,i),s.x=a.x,s.y=a.y),a.compute(t)},this.getCurrentLocation=function(){return null!=a?a.getCurrentLocation():null},this.getOrientation=function(t){return null!=a?a.getOrientation(t):[0,0]},this.over=function(t){null!=a&&a.over(t)},this.out=function(){null!=a&&a.out()}},Yt={},Xt={},Zt={},qt="horizontal",Qt="vertical",Kt="diagonal",Jt="identity",te=function(t,e,n,i){if(t===e)return{orientation:Jt,a:["top","top"]};var o=Math.atan2(i.centery-n.centery,i.centerx-n.centerx),r=Math.atan2(n.centery-i.centery,n.centerx-i.centerx),a=n.left<=i.left&&n.right>=i.left||n.left<=i.right&&n.right>=i.right||n.left<=i.left&&n.right>=i.right||i.left<=n.left&&i.right>=n.right,s=n.top<=i.top&&n.bottom>=i.top||n.top<=i.bottom&&n.bottom>=i.bottom||n.top<=i.top&&n.bottom>=i.bottom||i.top<=n.top&&i.bottom>=n.bottom;if(a||s)return a?{orientation:qt,a:n.top<i.top?["bottom","top"]:["top","bottom"],theta:o,theta2:r}:{orientation:Qt,a:n.left<i.left?["right","left"]:["left","right"],theta:o,theta2:r};var l=null;return i.left>n.left&&i.top>n.top?l=["right","top"]:i.left>n.left&&n.top>i.top?l=["top","left"]:i.left<n.left&&i.top<n.top?l=["top","right"]:i.left<n.left&&i.top>n.top&&(l=["left","top"]),{orientation:Kt,a:l,theta:o,theta2:r}},ee=function(t){return function(e,n){return!1===(t?e[0][0]<n[0][0]||e[0][1]>n[0][1]:e[0][0]>n[0][0]||e[0][1]>n[0][1])?-1:1}},ne={top:function(t,e){return t[0]>e[0]?1:-1},right:ee(!0),bottom:ee(!0),left:function(t,e){return(t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0])>(e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0])||t[0][1]>e[0][1]?1:-1}},ie=function(t,e){var n=F[t],i=T[t],o=function(e,n,i,o,r,a,s){if(o.length>0)for(var l=function(t,e,n,i,o,r,a){for(var s=[],l=e[o?0:1]/(i.length+1),c=0;c<i.length;c++){var u=(c+1)*l,d=r*e[o?1:0];a&&(u=e[o?0:1]-u);var p=o?u:d,h=n[0]+p,f=p/e[0],g=o?d:u,m=n[1]+g,v=g/e[1];s.push([h,m,f,v,i[c][1],i[c][2]])}return s}(0,n,i,(f=ne[e],o.sort(f)),r,a,"right"===e||"top"===e),c=function(t,e){var n=$t([e[0],e[1]],t.canvas);Xt[t.id]=[n[0],n[1],e[2],e[3]],Zt[t.id]=s},u=0;u<l.length;u++){var d=l[u][4],p=d.endpoints[0].elementId===t,h=d.endpoints[1].elementId===t;p?c(d.endpoints[0],l[u]):h&&c(d.endpoints[1],l[u])}var f};o("bottom",n,[i.left,i.top],e.bottom,!0,1,[0,1]),o("top",n,[i.left,i.top],e.top,!0,0,[0,-1]),o("left",n,[i.left,i.top],e.left,!1,0,[-1,0]),o("right",n,[i.left,i.top],e.right,!1,1,[1,0])};x.anchorManager=new function(){var e={},o={},r=this,a={};this.reset=function(){e={},o={},a={}},this.newConnection=function(t){var e=t.sourceId,n=t.targetId,i=t.endpoints,r=!0,a=function(t,a,s,l,c){e==n&&s.isContinuous&&(C.CurrentLibrary.removeElement(i[1].canvas),r=!1),R(o,l,[c,a,s.constructor==Gt])};a(0,i[0],i[0].anchor,n,t),r&&a(0,i[1],i[1].anchor,e,t)},this.connectionDetached=function(t){var e=t.connection||t,i=e.sourceId,s=e.targetId,l=e.endpoints,c=function(t,e,i,r,a){i.constructor==Vt||n(o[r],(function(t){return t[0].id==a.id}))};c(0,l[1],l[1].anchor,i,e),c(0,l[0],l[0].anchor,s,e);var u=e.sourceId,d=e.targetId,p=e.endpoints[0].id,h=e.endpoints[1].id,f=function(t,e){if(t){var i=function(t){return t[4]==e};n(t.top,i),n(t.left,i),n(t.bottom,i),n(t.right,i)}};f(a[u],p),f(a[d],h),r.redraw(u),r.redraw(d)},this.add=function(t,n){R(e,n,t)},this.changeId=function(t,n){o[n]=o[t],e[n]=e[t],delete o[t],delete e[t]},this.getConnectionsFor=function(t){return o[t]||[]},this.getEndpointsFor=function(t){return e[t]||[]},this.deleteEndpoint=function(t){n(e[t.elementId],(function(e){return e.id==t.id}))},this.clearFor=function(t){delete e[t],e[t]=[]};var s=function(e,n,o,r,a,s,l,c,u,d,p,h){var f=-1,g=r.endpoints[l],m=g.id,v=[[n,o],r,a,s,m],y=e[u],b=g._continuousAnchorEdge?e[g._continuousAnchorEdge]:null;if(b){var w=t(b,(function(t){return t[4]==m}));if(-1!=w){b.splice(w,1);for(var C=0;C<b.length;C++)i(p,b[C][1],(function(t){return t.id==b[C][1].id})),i(h,b[C][1].endpoints[l],(function(t){return t.id==b[C][1].endpoints[l].id}))}}for(C=0;C<y.length;C++)1==l&&y[C][3]===s&&-1==f&&(f=C),i(p,y[C][1],(function(t){return t.id==y[C][1].id})),i(h,y[C][1].endpoints[l],(function(t){return t.id==y[C][1].endpoints[l].id}));var j=c?-1!=f?f:0:y.length;y.splice(j,0,v),g._continuousAnchorEdge=u};this.redraw=function(t,n,r,l){if(!Ut){var c=e[t]||[],u=o[t]||[],d=[],p=[],h=[];r=r||g(),l=l||{left:0,top:0},n&&(n={left:n.left+l.left,top:n.top+l.top}),st({elId:t,offset:n,recalc:!1,timestamp:r});for(var f=T[t],m=F[t],v={},y=0;y<u.length;y++){var b=u[y][0],w=b.sourceId,C=b.targetId,j=b.endpoints[0].anchor.isContinuous,P=b.endpoints[1].anchor.isContinuous;if(j||P){var x=w+"_"+C,E=v[x],D=b.sourceId==t?1:0;j&&!a[w]&&(a[w]={top:[],right:[],bottom:[],left:[]}),P&&!a[C]&&(a[C]={top:[],right:[],bottom:[],left:[]}),t!=C&&st({elId:C,timestamp:r}),t!=w&&st({elId:w,timestamp:r});var S=lt(C),I=lt(w);C==w&&(j||P)?s(a[w],-Math.PI/2,0,b,!1,C,0,!1,"top",0,d,p):(E||(E=te(w,C,I.o,S.o),v[x]=E),j&&s(a[w],E.theta,0,b,!1,C,0,!1,E.a[0],0,d,p),P&&s(a[C],E.theta2,-1,b,!0,w,1,!0,E.a[1],0,d,p)),j&&i(h,w,(function(t){return t===w})),P&&i(h,C,(function(t){return t===C})),i(d,b,(function(t){return t.id==b.id})),(j&&0==D||P&&1==D)&&i(p,b.endpoints[D],(function(t){return t.id==b.endpoints[D].id}))}}for(y=0;y<c.length;y++)0==c[y].connections.length&&c[y].anchor.isContinuous&&(a[t]||(a[t]={top:[],right:[],bottom:[],left:[]}),s(a[t],-Math.PI/2,0,{endpoints:[c[y],c[y]],paint:function(){}},!1,t,0,!1,"top",0,d,p),i(h,t,(function(e){return e===t})));for(y=0;y<h.length;y++)ie(h[y],a[h[y]]);for(y=0;y<c.length;y++)c[y].paint({timestamp:r,offset:f,dimensions:m});for(y=0;y<p.length;y++)p[y].paint({timestamp:r,offset:f,dimensions:m});for(y=0;y<u.length;y++){var _=u[y][1];if(_.anchor.constructor==Gt){_.paint({elementWithPrecedence:t}),i(d,u[y][0],(function(t){return t.id==u[y][0].id}));for(var M=0;M<_.connections.length;M++)_.connections[M]!==u[y][0]&&i(d,_.connections[M],(function(t){return t.id==_.connections[M].id}))}else _.anchor.constructor==Nt&&i(d,u[y][0],(function(t){return t.id==u[y][0].id}))}var k=z[t];k&&k.paint({timestamp:r,recalc:!1,elId:t});for(y=0;y<d.length;y++)d[y].paint({elId:t,timestamp:r,recalc:!1})}},this.rehomeEndpoint=function(t,n){var i=e[t]||[],o=x.getId(n);if(o!==t){for(var a=0;a<i.length;a++)r.add(i[a],o);i.splice(0,i.length)}}},x.continuousAnchorFactory={get:function(t){var e=Yt[t.elementId];return e||(e={type:"Continuous",compute:function(t){return Xt[t.element.id]||[0,0]},getCurrentLocation:function(t){return Xt[t.id]||[0,0]},getOrientation:function(t){return Zt[t.id]||[0,0]},isDynamic:!0,isContinuous:!0},Yt[t.elementId]=e),e}},jsPlumbAdapter.headless||(x.dragManager=jsPlumbAdapter.getDragManager(x)),x.recalculateOffsets=x.dragManager.updateOffsets;var oe=function(t){var e,n,i=this,a=!0;i.idPrefix="_jsplumb_c_",i.defaultLabelLocation=.5,i.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.parent=t.parent,v.apply(this,arguments),this.isVisible=function(){return a},this.setVisible=function(t){a=t,i[t?"showOverlays":"hideOverlays"](),i.connector&&i.connector.canvas&&(i.connector.canvas.style.display=t?"block":"none"),i.repaint()},this.getTypeDescriptor=function(){return"connection"},this.getDefaultType=function(){return{parameters:{},scope:null,detachable:i._jsPlumb.Defaults.ConnectionsDetachable,rettach:i._jsPlumb.Defaults.ReattachConnections,paintStyle:i._jsPlumb.Defaults.PaintStyle||C.Defaults.PaintStyle,connector:i._jsPlumb.Defaults.Connector||C.Defaults.Connector,hoverPaintStyle:i._jsPlumb.Defaults.HoverPaintStyle||C.Defaults.HoverPaintStyle,overlays:i._jsPlumb.Defaults.ConnectorOverlays||C.Defaults.ConnectorOverlays}};var l=this.applyType;this.applyType=function(t){l(t),null!=t.detachable&&i.setDetachable(t.detachable),null!=t.reattach&&i.setReattach(t.reattach),t.scope&&(i.scope=t.scope),i.setConnector(t.connector)},n=i.setHover,i.setHover=function(t){var e=x.ConnectorZIndex||C.Defaults.ConnectorZIndex;e&&i.connector.setZIndex(e+(t?1:0)),i.connector.setHover.apply(i.connector,arguments),n.apply(i,arguments)},e=function(t){i.setHover(t,!1)},this.setConnector=function(n,a){null!=i.connector&&ot(i.connector.getDisplayElements(),i.parent);var s={_jsPlumb:i._jsPlumb,parent:t.parent,cssClass:t.cssClass,container:t.container,tooltip:i.tooltip};r(n)?this.connector=new C.Connectors[U][n](s):o(n)&&(1==n.length?this.connector=new C.Connectors[U][n[0]](s):this.connector=new C.Connectors[U][n[0]](C.extend(n[1],s))),i.canvas=i.connector.canvas,y(i.connector,i,e);var l=x.ConnectorZIndex||C.Defaults.ConnectorZIndex;l&&i.connector.setZIndex(l),a||i.repaint()},this.source=d(t.source),this.target=d(t.target),t.sourceEndpoint&&(this.source=t.sourceEndpoint.endpointWillMoveTo||t.sourceEndpoint.getElement()),t.targetEndpoint&&(this.target=t.targetEndpoint.getElement()),i.previousConnection=t.previousConnection,this.sourceId=s(this.source,"id"),this.targetId=s(this.target,"id"),this.scope=t.scope,this.endpoints=[],this.endpointStyles=[];var c=function(t,e){return t?x.makeAnchor(t,e,x):null},u=function(t,e,n,o,r,a,s){var l;if(t)i.endpoints[e]=t,t.addConnection(i);else{n.endpoints||(n.endpoints=[null,null]);var u=n.endpoints[e]||n.endpoint||x.Defaults.Endpoints[e]||C.Defaults.Endpoints[e]||x.Defaults.Endpoint||C.Defaults.Endpoint;n.endpointStyles||(n.endpointStyles=[null,null]),n.endpointHoverStyles||(n.endpointHoverStyles=[null,null]);var d=n.endpointStyles[e]||n.endpointStyle||x.Defaults.EndpointStyles[e]||C.Defaults.EndpointStyles[e]||x.Defaults.EndpointStyle||C.Defaults.EndpointStyle;null==d.fillStyle&&null!=a&&(d.fillStyle=a.strokeStyle),null==d.outlineColor&&null!=a&&(d.outlineColor=a.outlineColor),null==d.outlineWidth&&null!=a&&(d.outlineWidth=a.outlineWidth);var p=n.endpointHoverStyles[e]||n.endpointHoverStyle||x.Defaults.EndpointHoverStyles[e]||C.Defaults.EndpointHoverStyles[e]||x.Defaults.EndpointHoverStyle||C.Defaults.EndpointHoverStyle;null!=s&&(null==p&&(p={}),null==p.fillStyle&&(p.fillStyle=s.strokeStyle));var h=n.anchors?n.anchors[e]:n.anchor?n.anchor:c(x.Defaults.Anchors[e],r)||c(C.Defaults.Anchors[e],r)||c(x.Defaults.Anchor,r)||c(C.Defaults.Anchor,r),f=n.uuids?n.uuids[e]:null;l=et({paintStyle:d,hoverPaintStyle:p,endpoint:u,connections:[i],uuid:f,anchor:h,source:o,scope:n.scope,container:n.container,reattach:n.reattach||x.Defaults.ReattachConnections,detachable:n.detachable||x.Defaults.ConnectionsDetachable}),i.endpoints[e]=l,!1===n.drawEndpoints&&l.setVisible(!1,!0,!0)}return l},p=u(t.sourceEndpoint,0,t,i.source,i.sourceId,t.paintStyle,t.hoverPaintStyle);p&&R(A,this.sourceId,p);var h=u(t.targetEndpoint,1,t,i.target,i.targetId,t.paintStyle,t.hoverPaintStyle);h&&R(A,this.targetId,h),this.scope||(this.scope=this.endpoints[0].scope),i.endpointsToDeleteOnDetach=[null,null],t.deleteEndpointsOnDetach&&(t.sourceIsNew&&(i.endpointsToDeleteOnDetach[0]=i.endpoints[0]),t.targetIsNew&&(i.endpointsToDeleteOnDetach[1]=i.endpoints[1])),i.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||t.connector||x.Defaults.Connector||C.Defaults.Connector,!0),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||t.paintStyle||x.Defaults.PaintStyle||C.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||t.hoverPaintStyle||x.Defaults.HoverPaintStyle||C.Defaults.HoverPaintStyle,!0),this.paintStyleInUse=this.getPaintStyle(),st({elId:this.sourceId,timestamp:Rt}),st({elId:this.targetId,timestamp:Rt});var f=T[this.sourceId],m=F[this.sourceId],b=T[this.targetId],w=F[this.targetId],j=Rt||g(),P=this.endpoints[0].anchor.compute({xy:[f.left,f.top],wh:m,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[b.left,b.top],twh:w,tElement:this.endpoints[1],timestamp:j});this.endpoints[0].paint({anchorLoc:P,timestamp:j}),P=this.endpoints[1].anchor.compute({xy:[b.left,b.top],wh:w,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[f.left,f.top],twh:m,tElement:this.endpoints[0],timestamp:j}),this.endpoints[1].paint({anchorLoc:P,timestamp:j});var E=x.Defaults.ConnectionsDetachable;!1===t.detachable&&(E=!1),!1===i.endpoints[0].connectionsDetachable&&(E=!1),!1===i.endpoints[1].connectionsDetachable&&(E=!1),this.isDetachable=function(){return!0===E},this.setDetachable=function(t){E=!0===t};var D=t.reattach||i.endpoints[0].reattachConnections||i.endpoints[1].reattachConnections||x.Defaults.ReattachConnections;this.isReattach=function(){return!0===D},this.setReattach=function(t){D=!0===t};var S=t.cost||i.endpoints[0].getConnectionCost();i.getCost=function(){return S},i.setCost=function(t){S=t};var I=!(!1===t.bidirectional);null==t.bidirectional&&(I=i.endpoints[0].areConnectionsBidirectional()),i.isBidirectional=function(){return I};var _=C.extend({},this.endpoints[0].getParameters());C.extend(_,this.endpoints[1].getParameters()),C.extend(_,i.getParameters()),i.setParameters(_),this.getAttachedElements=function(){return i.endpoints},this.moveParent=function(t){var e=C.CurrentLibrary,n=e.getParent(i.connector.canvas);i.connector.bgCanvas&&(e.removeElement(i.connector.bgCanvas,n),e.appendElement(i.connector.bgCanvas,t)),e.removeElement(i.connector.canvas,n),e.appendElement(i.connector.canvas,t);for(var o=0;o<i.overlays.length;o++)i.overlays[o].isAppendedAtTopLevel&&(e.removeElement(i.overlays[o].canvas,n),e.appendElement(i.overlays[o].canvas,t),i.overlays[o].reattachListeners&&i.overlays[o].reattachListeners(i.connector));i.connector.reattachListeners&&i.connector.reattachListeners()};var M=null;this.paint=function(t){if(a){var e=(t=t||{}).elId,n=t.ui,o=t.recalc,r=t.timestamp,s=this.targetId;this.sourceId;if(null==r||r!=M){for(var l=st({elId:e,offset:n,recalc:o,timestamp:r}),c=st({elId:s,timestamp:r}),u=this.endpoints[0],d=this.endpoints[1],p=u.anchor.getCurrentLocation(u),h=d.anchor.getCurrentLocation(d),f=0,g=0;g<i.overlays.length;g++){(v=i.overlays[g]).isVisible()&&(f=Math.max(f,v.computeMaxSize()))}var m=this.connector.compute(p,h,this.endpoints[0],this.endpoints[1],this.endpoints[0].anchor,this.endpoints[1].anchor,i.paintStyleInUse.lineWidth,f,l,c);i.connector.paint(m,i.paintStyleInUse);for(g=0;g<i.overlays.length;g++){var v;(v=i.overlays[g]).isVisible&&(i.overlayPlacements[g]=v.draw(i.connector,i.paintStyleInUse,m))}}M=r}},this.repaint=function(t){var e=!(!1===(t=t||{}).recalc);this.paint({elId:this.sourceId,recalc:e,timestamp:t.timestamp})};var k=t.type||i.endpoints[0].connectionType||i.endpoints[1].connectionType;k&&i.addType(k)},re=function(t){var e=!1;return{drag:function(){if(e)return e=!1,!0;var n=C.CurrentLibrary.getUIPosition(arguments,x.getZoom()),i=t.element;i&&(C.CurrentLibrary.setOffset(i,n),Y(d(i),n))},stopDrag:function(){e=!0}}},ae=function(t,e,n,i,o){var r=new Vt({reference:e,referenceCanvas:i});return et({paintStyle:t,endpoint:n,anchor:r,source:o,scope:"__floating"})},se=function(t,e){var n=document.createElement("div");n.style.position="absolute";var i=d(n);$(n,e);var o=ct(i);st({elId:o}),t.id=o,t.element=i},le=function(e){var i=this;i.idPrefix="_jsplumb_e_",i.defaultLabelLocation=[.5,.5],i.defaultOverlayKeys=["Overlays","EndpointOverlays"],this.parent=e.parent,v.apply(this,arguments),e=e||{},this.getTypeDescriptor=function(){return"endpoint"},this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:i._jsPlumb.Defaults.MaxConnections,paintStyle:i._jsPlumb.Defaults.EndpointStyle||C.Defaults.EndpointStyle,endpoint:i._jsPlumb.Defaults.Endpoint||C.Defaults.Endpoint,hoverPaintStyle:i._jsPlumb.Defaults.EndpointHoverStyle||C.Defaults.EndpointHoverStyle,overlays:i._jsPlumb.Defaults.EndpointOverlays||C.Defaults.EndpointOverlays,connectorStyle:e.connectorStyle,connectorHoverStyle:e.connectorHoverStyle,connectorClass:e.connectorClass,connectorHoverClass:e.connectorHoverClass,connectorOverlays:e.connectorOverlays,connector:e.connector,connectorTooltip:e.connectorTooltip}};var a=this.applyType;this.applyType=function(t){a(t),null!=t.maxConnections&&(I=t.maxConnections),t.scope&&(i.scope=t.scope),i.connectorStyle=t.connectorStyle,i.connectorHoverStyle=t.connectorHoverStyle,i.connectorOverlays=t.connectorOverlays,i.connector=t.connector,i.connectorTooltip=t.connectorTooltip,i.connectionType=t.connectionType,i.connectorClass=t.connectorClass,i.connectorHoverClass=t.connectorHoverClass};var c=!0,u=!(!1===e.enabled);this.isVisible=function(){return c},this.setVisible=function(t,e,n){if(c=t,i.canvas&&(i.canvas.style.display=t?"block":"none"),i[t?"showOverlays":"hideOverlays"](),!e)for(var o=0;o<i.connections.length;o++)if(i.connections[o].setVisible(t),!n){var r=i===i.connections[o].endpoints[0]?1:0;1==i.connections[o].endpoints[r].connections.length&&i.connections[o].endpoints[r].setVisible(t,!0,!0)}},this.isEnabled=function(){return u},this.setEnabled=function(t){u=t};var h=e.source,f=e.uuid,g=null,m=null;f&&(L[f]=i);var b=s(h,"id");this.elementId=b,this.element=h;var w=e.connectionCost;this.getConnectionCost=function(){return w},this.setConnectionCost=function(t){w=t};var j=!1!==e.connectionsBidirectional;this.areConnectionsBidirectional=function(){return j},this.setConnectionsBidirectional=function(t){j=t},i.anchor=e.anchor?x.makeAnchor(e.anchor,b,x):e.anchors?x.makeAnchor(e.anchors,b,x):x.makeAnchor(x.Defaults.Anchor||"TopCenter",b,x),e._transient||x.anchorManager.add(i,b);var P=null;this.setEndpoint=function(t){var n={_jsPlumb:i._jsPlumb,parent:e.parent,container:e.container,tooltip:e.tooltip,connectorTooltip:e.connectorTooltip,endpoint:i};r(t)?P=new C.Endpoints[U][t](n):o(t)?(n=C.extend(t[1],n),P=new C.Endpoints[U][t[0]](n)):P=t.clone();var a=C.extend({},n);P.clone=function(){var t=new Object;return P.constructor.apply(t,[a]),t},i.endpoint=P,i.type=i.endpoint.type},this.setEndpoint(e.endpoint||x.Defaults.Endpoint||C.Defaults.Endpoint||"Dot");var E=i.setHover;i.setHover=function(){i.endpoint.setHover.apply(i.endpoint,arguments),E.apply(i,arguments)};var D=function(t){i.connections.length>0?i.connections[0].setHover(t,!1):i.setHover(t)};y(i.endpoint,i,D),this.setPaintStyle(e.paintStyle||e.style||x.Defaults.EndpointStyle||C.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(e.hoverPaintStyle||x.Defaults.EndpointHoverStyle||C.Defaults.EndpointHoverStyle,!0),this.paintStyleInUse=this.getPaintStyle();var S=this.getPaintStyle();this.connectorStyle=e.connectorStyle,this.connectorHoverStyle=e.connectorHoverStyle,this.connectorOverlays=e.connectorOverlays,this.connector=e.connector,this.connectorTooltip=e.connectorTooltip,this.connectorClass=e.connectorClass,this.connectorHoverClass=e.connectorHoverClass,this.isSource=e.isSource||!1,this.isTarget=e.isTarget||!1;var I=e.maxConnections||x.Defaults.MaxConnections;this.getAttachedElements=function(){return i.connections},this.canvas=this.endpoint.canvas,this.connections=e.connections||[],this.scope=e.scope||B,this.connectionType=e.connectionType,this.timestamp=null,i.reattachConnections=e.reattach||x.Defaults.ReattachConnections,i.connectionsDetachable=x.Defaults.ConnectionsDetachable,!1!==e.connectionsDetachable&&!1!==e.detachable||(i.connectionsDetachable=!1);var _=e.dragAllowedWhenFull||!0;e.onMaxConnections&&i.bind("maxConnections",e.onMaxConnections),this.computeAnchor=function(t){return i.anchor.compute(t)},this.addConnection=function(t){i.connections.push(t)},this.detach=function(e,o,r,a,s){var l=t(i.connections,(function(t){return t.id==e.id})),c=!1;if(a=!1!==a,l>=0&&(r||e._forceDetach||e.isDetachable()||e.isDetachAllowed(e))){var u=e.endpoints[0]==i?e.endpoints[1]:e.endpoints[0];if(r||e._forceDetach||i.isDetachAllowed(e)){if(i.connections.splice(l,1),!o&&(u.detach(e,!0,r),e.endpointsToDeleteOnDetach))for(var d=0;d<e.endpointsToDeleteOnDetach.length;d++){var p=e.endpointsToDeleteOnDetach[d];p&&0==p.connections.length&&x.deleteEndpoint(p)}ot(e.connector.getDisplayElements(),e.parent),n(O[e.scope],(function(t){return t.id==e.id})),c=!0,dt(e,!o&&a,s)}}return c},this.detachAll=function(t,e){for(;i.connections.length>0;)i.detach(i.connections[0],!1,!0,t,e)},this.detachFrom=function(t,e,n){for(var o=[],r=0;r<i.connections.length;r++)i.connections[r].endpoints[1]!=t&&i.connections[r].endpoints[0]!=t||o.push(i.connections[r]);for(r=0;r<o.length;r++)i.detach(o[r],!1,!0,e,n)&&o[r].setHover(!1,!1)},this.detachFromConnection=function(e){var n=t(i.connections,(function(t){return t.id==e.id}));n>=0&&i.connections.splice(n,1)},this.getElement=function(){return h},this.setElement=function(t,e){var o=ct(t);n(A[i.elementId],(function(t){return t.id==i.id})),h=d(t),b=ct(h),i.elementId=b;var r=tt({source:o,container:e}),a=G.getParent(i.canvas);G.removeElement(i.canvas,a),G.appendElement(i.canvas,r);for(var s=0;s<i.connections.length;s++)i.connections[s].moveParent(r),i.connections[s].sourceId=b,i.connections[s].source=h;R(A,o,i)},this.getUuid=function(){return f},this.makeInPlaceCopy=function(){var t=i.anchor.getCurrentLocation(i),e=i.anchor.getOrientation(i);return et({anchor:{compute:function(){return[t[0],t[1]]},getCurrentLocation:function(){return[t[0],t[1]]},getOrientation:function(){return e}},source:h,paintStyle:this.getPaintStyle(),endpoint:P,_transient:!0,scope:i.scope})},this.isConnectedTo=function(t){var e=!1;if(t)for(var n=0;n<i.connections.length;n++)if(i.connections[n].endpoints[1]==t){e=!0;break}return e},this.isFloating=function(){return null!=g},this.connectorSelector=function(){var t=i.connections[0];return i.isTarget&&t?t:i.connections.length<I||-1==I?null:t},this.isFull=function(){return!(i.isFloating()||I<1||i.connections.length<I)},this.setDragAllowedWhenFull=function(t){_=t},this.setStyle=i.setPaintStyle,this.equals=function(t){return this.anchor.equals(t.anchor)};var M=function(t){var e=0;if(null!=t)for(var n=0;n<i.connections.length;n++)if(i.connections[n].sourceId==t||i.connections[n].targetId==t){e=n;break}return i.connections[e]};if(this.paint=function(t){var e=(t=t||{}).timestamp,n=!(!1===t.recalc);if(!e||i.timestamp!==e){st({elId:b,timestamp:e,recalc:n});var o=t.offset||T[b];if(o){var r=t.anchorPoint,a=t.connectorPaintStyle;if(null==r){var s=t.dimensions||F[b];null!=o&&null!=s||(st({elId:b,timestamp:e}),o=T[b],s=F[b]);var l={xy:[o.left,o.top],wh:s,element:i,timestamp:e};if(n&&i.anchor.isDynamic&&i.connections.length>0){var c=M(t.elementWithPrecedence),u=c.endpoints[0]==i?1:0,d=0==u?c.sourceId:c.targetId,p=T[d],h=F[d];l.txy=[p.left,p.top],l.twh=h,l.tElement=c.endpoints[u]}r=i.anchor.compute(l)}var f=P.compute(r,i.anchor.getOrientation(i),i.paintStyleInUse,a||i.paintStyleInUse);P.paint(f,i.paintStyleInUse,i.anchor),i.timestamp=e;for(var g=0;g<i.overlays.length;g++){var m=i.overlays[g];m.isVisible&&(i.overlayPlacements[g]=m.draw(i.endpoint,i.paintStyleInUse,f))}}}},this.repaint=this.paint,this.removeConnection=this.detach,C.CurrentLibrary.isDragSupported(h)){var k={id:null,element:null},W=null,H=!1,$=null,N=re(k),V=function(){W=i.connectorSelector();var t=!0;if(i.isEnabled()||(t=!1),null!=W||e.isSource||(t=!1),e.isSource&&i.isFull()&&!_&&(t=!1),null==W||W.isDetachable()||(t=!1),!1===t)return C.CurrentLibrary.stopDrag&&C.CurrentLibrary.stopDrag(),N.stopDrag(),!1;W&&!i.isFull()&&e.isSource&&(W=null),st({elId:b}),(m=i.makeInPlaceCopy()).referenceEndpoint=i,m.paint(),se(k,i.parent);var n=d(m.canvas),o=p(n,x),r=$t([o.left,o.top],m.canvas);if(C.CurrentLibrary.setOffset(k.element,{left:r[0],top:r[1]}),i.parentAnchor&&(i.anchor=x.makeAnchor(i.parentAnchor,i.elementId,x)),l(d(i.canvas),"dragId",k.id),l(d(i.canvas),"elId",b),e.proxy&&i.setPaintStyle(e.proxy.paintStyle),g=ae(i.getPaintStyle(),i.anchor,P,i.canvas,k.element),null==W)i.anchor.locked=!0,i.setHover(!1,!1),W=Q({sourceEndpoint:i,targetEndpoint:g,source:i.endpointWillMoveTo||d(h),target:k.element,anchors:[i.anchor,g.anchor],paintStyle:e.connectorStyle,hoverPaintStyle:e.connectorHoverStyle,connector:e.connector,overlays:e.connectorOverlays,type:i.connectionType,cssClass:i.connectorClass,hoverClass:i.connectorHoverClass});else{H=!0,W.setHover(!1),rt(d(m.canvas),!1,!0);var a=W.endpoints[0].id==i.id?0:1;W.floatingAnchorIndex=a,i.detachFromConnection(W);var s=d(i.canvas),c=C.CurrentLibrary.getDragScope(s);l(s,"originalScope",c);var u=C.CurrentLibrary.getDropScope(s);C.CurrentLibrary.setDragScope(s,u),0==a?($=[W.source,W.sourceId,nt,c],W.source=k.element,W.sourceId=k.id):($=[W.target,W.targetId,nt,c],W.target=k.element,W.targetId=k.id),W.endpoints[0==a?1:0].anchor.locked=!0,W.suspendedEndpoint=W.endpoints[a],W.suspendedEndpoint.setHover(!1),g.referenceEndpoint=W.suspendedEndpoint,W.endpoints[a]=g,pt(W)}z[k.id]=W,g.addConnection(W),R(A,k.id,g),x.currentlyDragging=!0},G=C.CurrentLibrary,Y=e.dragOptions||{},X=C.extend({},G.defaultDragOptions),Z=G.dragEvents.start,q=G.dragEvents.stop,J=G.dragEvents.drag;(Y=C.extend(X,Y)).scope=Y.scope||i.scope,Y[Z]=ut(Y[Z],V),Y[J]=ut(Y[J],N.drag),Y[q]=ut(Y[q],(function(){var t=G.getDropEvent(arguments);x.currentlyDragging=!1,n(A[k.id],(function(t){return t.id==g.id})),ot([k.element[0],g.canvas]),it(m.canvas),x.anchorManager.clearFor(k.id);var e=null==W.floatingAnchorIndex?1:W.floatingAnchorIndex;W.endpoints[0==e?1:0].anchor.locked=!1,i.setPaintStyle(S),W.endpoints[e]==g&&(H&&W.suspendedEndpoint?(0==e?(W.source=$[0],W.sourceId=$[1]):(W.target=$[0],W.targetId=$[1]),C.CurrentLibrary.setDragScope($[2],$[3]),W.endpoints[e]=W.suspendedEndpoint,(W.isReattach()||W._forceReattach||W._forceDetach||!W.endpoints[0==e?1:0].detach(W,!1,!1,!0,t))&&(W.setHover(!1),W.floatingAnchorIndex=null,W.suspendedEndpoint.addConnection(W),x.repaint($[1])),W._forceDetach=null,W._forceReattach=null):(ot(W.connector.getDisplayElements(),i.parent),i.detachFromConnection(W))),i.anchor.locked=!1,i.paint({recalc:!1}),ht(W),W=null,m=null,delete A[g.elementId],g.anchor=null,g=null,x.currentlyDragging=!1}));var nt=d(i.canvas);C.CurrentLibrary.initDraggable(nt,Y,!0)}var rt=function(t,n,o,r){if((e.isTarget||n)&&C.CurrentLibrary.isDropSupported(h)){var a=e.dropOptions||x.Defaults.DropOptions||C.Defaults.DropOptions;(a=C.extend({},a)).scope=a.scope||i.scope;var l=C.CurrentLibrary.dragEvents.drop,c=C.CurrentLibrary.dragEvents.over,u=C.CurrentLibrary.dragEvents.out;a[l]=ut(a[l],(function(){var t=C.CurrentLibrary.getDropEvent(arguments),e=d(C.CurrentLibrary.getDragObject(arguments)),n=s(e,"dragId"),o=(s(e,"elId"),s(e,"originalScope")),a=z[n],l=a.suspendedEndpoint&&(a.suspendedEndpoint.id==i.id||i.referenceEndpoint&&a.suspendedEndpoint.id==i.referenceEndpoint.id);if(l)a._forceReattach=!0;else if(null!=a){var c=null==a.floatingAnchorIndex?1:a.floatingAnchorIndex;o&&C.CurrentLibrary.setDragScope(e,o);var u=null==r||r.isEnabled();if(i.isFull()&&i.fire("maxConnections",{endpoint:i,connection:a,maxConnections:I},t),!i.isFull()&&(0!=c||i.isSource)&&(1!=c||i.isTarget)&&u){var p=!0;a.suspendedEndpoint&&a.suspendedEndpoint.id!=i.id&&(0==c?(a.source=a.suspendedEndpoint.element,a.sourceId=a.suspendedEndpoint.elementId):(a.target=a.suspendedEndpoint.element,a.targetId=a.suspendedEndpoint.elementId),a.isDetachAllowed(a)&&a.endpoints[c].isDetachAllowed(a)&&a.suspendedEndpoint.isDetachAllowed(a)&&x.checkCondition("beforeDetach",a)||(p=!1)),0==c?(a.source=i.element,a.sourceId=i.elementId):(a.target=i.element,a.targetId=i.elementId);var h=function(){a.floatingAnchorIndex=null},f=function(){a.endpoints[c].detachFromConnection(a),a.suspendedEndpoint&&a.suspendedEndpoint.detachFromConnection(a),a.endpoints[c]=i,i.addConnection(a);var e=i.getParameters();for(var n in e)a.setParameter(n,e[n]);if(a.suspendedEndpoint){var o=a.suspendedEndpoint.getElement(),r=a.suspendedEndpoint.elementId;dt({source:0==c?o:a.source,target:1==c?o:a.target,sourceId:0==c?r:a.sourceId,targetId:1==c?r:a.targetId,sourceEndpoint:0==c?a.suspendedEndpoint:a.endpoints[0],targetEndpoint:1==c?a.suspendedEndpoint:a.endpoints[1],connection:a},!0,t)}else e.draggable&&C.CurrentLibrary.initDraggable(i.element,Y,!0);K(a,null,t),h()},g=function(){a.suspendedEndpoint&&(a.endpoints[c]=a.suspendedEndpoint,a.setHover(!1),a._forceDetach=!0,0==c?(a.source=a.suspendedEndpoint.element,a.sourceId=a.suspendedEndpoint.elementId):(a.target=a.suspendedEndpoint.element,a.targetId=a.suspendedEndpoint.elementId),a.suspendedEndpoint.addConnection(a),a.endpoints[0].repaint(),a.repaint(),x.repaint(a.source.elementId),a._forceDetach=!1),h()};(p=p&&i.isDropAllowed(a.sourceId,a.targetId,a.scope,a,i))?f():g()}x.currentlyDragging=!1,delete z[n],a.suspendedEndpoint=null}})),a[c]=ut(a[c],(function(){var t=C.CurrentLibrary.getDragObject(arguments),e=s(d(t),"dragId"),n=z[e];if(null!=n){var o=null==n.floatingAnchorIndex?1:n.floatingAnchorIndex,r=i.isTarget&&0!=n.floatingAnchorIndex||n.suspendedEndpoint&&i.referenceEndpoint&&i.referenceEndpoint.id==n.suspendedEndpoint.id;r&&n.endpoints[o].anchor.over(i.anchor)}})),a[u]=ut(a[u],(function(){var t=C.CurrentLibrary.getDragObject(arguments),e=s(d(t),"dragId"),n=z[e];if(null!=n){var o=null==n.floatingAnchorIndex?1:n.floatingAnchorIndex,r=i.isTarget&&0!=n.floatingAnchorIndex||n.suspendedEndpoint&&i.referenceEndpoint&&i.referenceEndpoint.id==n.suspendedEndpoint.id;r&&n.endpoints[o].anchor.out()}})),C.CurrentLibrary.initDroppable(t,a,!0,o)}};return rt(d(i.canvas),!0,!(e._transient||i.anchor.isFloating),i),e.type&&i.addType(e.type),i}},C=new w;"undefined"!=typeof window&&(window.jsPlumb=C),C.getInstance=function(t){var e=new w(t);return e.init(),e},"function"==typeof define&&define.amd&&define.amd.jsPlumb&&define("jsplumb",[],(function(){return C}));var j=function(t,e,n,i,o,r){return function(a){var s=(a=a||{}).jsPlumbInstance.makeAnchor([t,e,n,i,0,0],a.elementId,a.jsPlumbInstance);return s.type=o,r&&r(s,a),s}};C.Anchors.TopCenter=j(.5,0,0,-1,"TopCenter"),C.Anchors.BottomCenter=j(.5,1,0,1,"BottomCenter"),C.Anchors.LeftMiddle=j(0,.5,-1,0,"LeftMiddle"),C.Anchors.RightMiddle=j(1,.5,1,0,"RightMiddle"),C.Anchors.Center=j(.5,.5,0,0,"Center"),C.Anchors.TopRight=j(1,0,0,-1,"TopRight"),C.Anchors.BottomRight=j(1,1,0,1,"BottomRight"),C.Anchors.TopLeft=j(0,0,0,-1,"TopLeft"),C.Anchors.BottomLeft=j(0,1,0,1,"BottomLeft"),C.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)},C.Anchors.AutoDefault=function(t){var e=t.jsPlumbInstance.makeDynamicAnchor(C.Defaults.DynamicAnchors(t));return e.type="AutoDefault",e},C.Anchors.Assign=j(0,0,0,0,"Assign",(function(t,e){var n=e.position||"Fixed";t.positionFinder=n.constructor==String?e.jsPlumbInstance.AnchorPositionFinders[n]:n,t.constructorParams=e})),C.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)},C.AnchorPositionFinders={Fixed:function(t,e,n,i){return[(t.left-e.left)/n[0],(t.top-e.top)/n[1]]},Grid:function(t,e,n,i){var o=t.left-e.left,r=t.top-e.top,a=n[0]/i.grid[0],s=n[1]/i.grid[1],l=Math.floor(o/a),c=Math.floor(r/s);return[(l*a+a/2)/n[0],(c*s+s/2)/n[1]]}},C.Anchors.Perimeter=function(t){var e=(t=t||{}).anchorCount||60,n=t.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");var i=function(){for(var t=.5,n=2*Math.PI/e,i=0,o=[],r=0;r<e;r++){var a=t+t*Math.sin(i),s=t+t*Math.cos(i);o.push([a,s,0,0]),i+=n}return o},o=function(t){for(var n=e/t.length,i=[],o=function(t,o,r,a,s){for(var l=(r-t)/(n=e*s),c=(a-o)/n,u=0;u<n;u++)i.push([t+l*u,o+c*u,0,0])},r=0;r<t.length;r++)o.apply(null,t[r]);return i},r=function(t){for(var e=[],n=0;n<t.length;n++)e.push([t[n][0],t[n][1],t[n][2],t[n][3],1/t.length]);return o(e)},a=function(){return r([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},s={circle:i,ellipse:i,diamond:function(){return r([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},rectangle:a,square:a,triangle:function(){return r([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},path:function(t){for(var e=t.points,n=[],i=0,r=0;r<e.length-1;r++){var a=Math.sqrt(Math.pow(e[r][2]-e[r][0])+Math.pow(e[r][3]-e[r][1]));i+=a,n.push([e[r][0],e[r][1],e[r+1][0],e[r+1][1],a])}for(r=0;r<n.length;r++)n[r][4]=n[r][4]/i;return o(n)}};if(!s[n])throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var l=s[n](t);t.rotation&&(l=function(t,e){for(var n=[],i=e/180*Math.PI,o=0;o<t.length;o++){var r=t[o][0]-.5,a=t[o][1]-.5;n.push([r*Math.cos(i)-a*Math.sin(i)+.5,r*Math.sin(i)+a*Math.cos(i)+.5,t[o][2],t[o][3]])}return n}(l,t.rotation));var c=t.jsPlumbInstance.makeDynamicAnchor(l);return c.type="Perimeter",c}}(),function(){jsPlumb.DOMElementComponent=function(t){jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(t){}},jsPlumb.Connectors.Straight=function(){this.type="Straight";var t,e,n,i,o,r,a,s,l,c=this,u=null;this.compute=function(c,d,p,h,f,g,m,v){var y=Math.abs(c[0]-d[0]),b=Math.abs(c[1]-d[1]),w=.45*y,C=.45*b;y*=1.9,b*=1.9;var j=Math.min(c[0],d[0])-w,P=Math.min(c[1],d[1])-C,x=Math.max(2*m,v);return y<x&&(y=x,j=c[0]+(d[0]-c[0])/2-x/2,w=(y-Math.abs(c[0]-d[0]))/2),b<x&&(b=x,P=c[1]+(d[1]-c[1])/2-x/2,C=(b-Math.abs(c[1]-d[1]))/2),o=c[0]<d[0]?w:y-w,r=c[1]<d[1]?C:b-C,a=c[0]<d[0]?y-w:w,s=c[1]<d[1]?b-C:C,u=[j,P,y,b,o,r,a,s],n=a-o,i=s-r,t=jsPlumbUtil.gradient({x:o,y:r},{x:a,y:s}),e=-1/t,-1*(t*o-r),Math.atan(t),Math.atan(e),l=Math.sqrt(n*n+i*i),u},this.pointOnPath=function(t,e){if(0!=t||e){if(1!=t||e){var n=e?t>0?t:l+t:t*l;return jsPlumbUtil.pointOnLine({x:o,y:r},{x:a,y:s},n)}return{x:a,y:s}}return{x:o,y:r}},this.gradientAtPoint=function(e){return t},this.pointAlongPathFrom=function(t,e,n){var i=c.pointOnPath(t,n),l=1==t?{x:o+10*(a-o),y:r+10*(r-s)}:e<=0?{x:o,y:r}:{x:a,y:s};return e<=0&&Math.abs(e)>1&&(e*=-1),jsPlumbUtil.pointOnLine(i,l,e)}},jsPlumb.Connectors.Bezier=function(t){var e=this;t=t||{},this.majorAnchor=t.curviness||150,this.minorAnchor=10;var n,i,o,r,a,s,l,c,u,d;this.type="Bezier",this._findControlPoint=function(t,n,i,o,r,a,s){var l=a.getOrientation(o),c=s.getOrientation(r),u=l[0]!=c[0]||l[1]==c[1],d=[],p=e.majorAnchor,h=e.minorAnchor;return u?(0==c[0]?d.push(i[0]<n[0]?t[0]+h:t[0]-h):d.push(t[0]+p*c[0]),0==c[1]?d.push(i[1]<n[1]?t[1]+h:t[1]-h):d.push(t[1]+p*l[1])):(0==l[0]?d.push(n[0]<i[0]?t[0]+h:t[0]-h):d.push(t[0]-p*l[0]),0==l[1]?d.push(n[1]<i[1]?t[1]+h:t[1]-h):d.push(t[1]+p*c[1])),d},this.compute=function(t,p,h,f,g,m,v,y){v=Math.max(y,v||0),u=Math.abs(t[0]-p[0])+v,d=Math.abs(t[1]-p[1])+v,l=Math.min(t[0],p[0])-v/2,c=Math.min(t[1],p[1])-v/2,a=t[0]<p[0]?u-v/2:v/2,s=t[1]<p[1]?d-v/2:v/2,o=t[0]<p[0]?v/2:u-v/2,r=t[1]<p[1]?v/2:d-v/2,n=e._findControlPoint([a,s],t,p,h,f,g,m),i=e._findControlPoint([o,r],p,t,f,h,m,g);var b=Math.min(a,o),w=Math.min(n[0],i[0]),C=Math.min(b,w),j=Math.max(a,o),P=Math.max(n[0],i[0]),x=Math.max(j,P);if(x>u&&(u=x),C<0){l+=C;var E=Math.abs(C);u+=E,n[0]+=E,a+=E,o+=E,i[0]+=E}var D=Math.min(s,r),S=Math.min(n[1],i[1]),I=Math.min(D,S),_=Math.max(s,r),M=Math.max(n[1],i[1]),k=Math.max(_,M);if(k>d&&(d=k),I<0){c+=I;var O=Math.abs(I);d+=O,n[1]+=O,s+=O,r+=O,i[1]+=O}if(y&&u<y){var A=(y-u)/2;u=y,l-=A,a+=A,o+=A,n[0]=n[0]+A,i[0]=i[0]+A}if(y&&d<y){A=(y-d)/2;d=y,c-=A,s+=A,r+=A,n[1]=n[1]+A,i[1]=i[1]+A}return[l,c,u,d,a,s,o,r,n[0],n[1],i[0],i[1]]};var p=function(){return[{x:a,y:s},{x:n[0],y:n[1]},{x:i[0],y:i[1]},{x:o,y:r}]},h=function(t,e,n){return n&&(e=jsBezier.locationAlongCurveFrom(t,e>0?0:1,e)),e};this.pointOnPath=function(t,e){var n=p();return t=h(n,t,e),jsBezier.pointOnCurve(n,t)},this.gradientAtPoint=function(t,e){var n=p();return t=h(n,t,e),jsBezier.gradientAtPoint(n,t)},this.pointAlongPathFrom=function(t,e,n){var i=p();return t=h(i,t,n),jsBezier.pointAlongCurveFrom(i,t,e)}},jsPlumb.Connectors.Flowchart=function(t){this.type="Flowchart";var e,n,i=this,o=(t=t||{}).stub||t.minStubLength||30,r=jsPlumbUtil.isArray(o)?o[0]:o,a=jsPlumbUtil.isArray(o)?o[1]:o,s=t.gap||0,l=t.midpoint||.5,c=[],u=0,d=[],p=[],h=[],f=-1/0,g=-1/0,m=1/0,v=1/0,y=(t.grid,function(t,e,n,i,o,r){var a=0==c.length?n:c[c.length-1][0],s=0==c.length?i:c[c.length-1][1],l=t==a?1/0:0,d=Math.abs(t==a?e-s:t-a);c.push([t,e,a,s,l,d]),u+=d,f=Math.max(f,t),g=Math.max(g,e),m=Math.min(m,t),v=Math.min(v,e)}),b=function(t,e){e&&(t=t>0?t/u:(u+t)/u);for(var n=d.length-1,i=1,o=0;o<d.length;o++)if(d[o][1]>=t){n=o,i=(t-d[o][0])/p[o];break}return{segment:c[n],proportion:i,index:n}};this.compute=function(t,o,b,w,C,j,P,x,E,D){c=[],d=[],u=0,p=[],f=g=-1/0,m=v=1/0,i.lineWidth=P,e=o[0]<t[0],n=o[1]<t[1];var S=P||1,I=S/2+(r+a),_=S/2+(a+r),M=S/2+(r+a),k=S/2+(a+r),O=C.orientation||C.getOrientation(b),A=j.orientation||j.getOrientation(w),L=e?o[0]:t[0],T=n?o[1]:t[1],W=Math.abs(o[0]-t[0])+I+_,z=Math.abs(o[1]-t[1])+M+k;if(0==O[0]&&0==O[1]||0==A[0]&&0==A[1]){var H=W>z?0:1,F=[1,0][H];A=[],(O=[])[H]=t[H]>o[H]?-1:1,A[H]=t[H]>o[H]?1:-1,O[F]=0,A[F]=0}var B=e?W-_+s*O[0]:I+s*O[0],U=n?z-k+s*O[1]:M+s*O[1],R=e?I+s*A[0]:W-_+s*A[0],$=n?M+s*A[1]:z-k+s*A[1],N=B+O[0]*r,V=U+O[1]*r,G=R+A[0]*a,Y=$+A[1]*a,X=Math.abs(B-R)>r+a,Z=Math.abs(U-$)>r+a,q=N+(G-N)*l,Q=V+(Y-V)*l,K=O[0]*A[0]+O[1]*A[1],J=-1==K,tt=1==K;h=[L-=I,T-=M,W,z,B,U,R,$];var et=0==O[0]?"y":"x",nt=J?"opposite":tt?"orthogonal":"perpendicular",it=jsPlumbUtil.segment([B,U],[R,$]);-1==O["x"==et?0:1]&&(it={x:[null,4,3,2,1],y:[null,2,1,4,3]}[et][it]),y(N,V,B,U);var ot={oppositex:function(){if(b.elementId==w.elementId){var t=V+(1-C.y)*E.height+Math.max(r,a);return[[N,t],[G,t]]}return!X||1!=it&&2!=it?[[N,Q],[G,Q]]:[[q,U],[q,$]]},orthogonalx:function(){return 1==it||2==it?[[G,V]]:[[N,Y]]},perpendicularx:function(){var t=($+U)/2;return 1==it&&1==A[1]||2==it&&-1==A[1]?Math.abs(R-B)>Math.max(r,a)?[[G,V]]:[[N,V],[N,t],[G,t]]:3==it&&-1==A[1]||4==it&&1==A[1]?[[N,t],[G,t]]:3==it&&1==A[1]||4==it&&-1==A[1]?[[N,Y]]:1==it&&-1==A[1]||2==it&&1==A[1]?Math.abs(R-B)>Math.max(r,a)?[[q,V],[q,Y]]:[[N,Y]]:void 0},oppositey:function(){if(b.elementId==w.elementId){var t=N+(1-C.x)*E.width+Math.max(r,a);return[[t,V],[t,Y]]}return!Z||2!=it&&3!=it?[[q,V],[q,Y]]:[[B,Q],[R,Q]]},orthogonaly:function(){return 2==it||3==it?[[N,Y]]:[[G,V]]},perpendiculary:function(){var t=(R+B)/2;return 2==it&&-1==A[0]||3==it&&1==A[0]?Math.abs(R-B)>Math.max(r,a)?[[N,Y]]:[[N,Q],[G,Q]]:1==it&&-1==A[0]||4==it&&1==A[0]?[[t=(R+B)/2,V],[t,Y]]:1==it&&1==A[0]||4==it&&-1==A[0]?[[G,V]]:2==it&&1==A[0]||3==it&&-1==A[0]?Math.abs($-U)>Math.max(r,a)?[[N,Q],[G,Q]]:[[G,V]]:void 0}}[nt+et]();if(ot)for(var rt=0;rt<ot.length;rt++)y(ot[rt][0],ot[rt][1],B,U);return y(G,Y,B,U),y(R,$,B,U),function(){h.push(c.length);for(var t=0;t<c.length;t++)h.push(c[t][0]),h.push(c[t][1])}(),function(t,e,n,i){for(var o=0,r=0;r<c.length;r++)p[r]=c[r][5]/u,d[r]=[o,o+=c[r][5]/u]}(),g>h[3]&&(h[3]=g+2*P),f>h[2]&&(h[2]=f+2*P),h},this.pointOnPath=function(t,e){return i.pointAlongPathFrom(t,0,e)},this.gradientAtPoint=function(t,e){return c[b(t,e).index][4]},this.pointAlongPathFrom=function(t,e,n){var i=b(t,n),o=i.segment,r=i.proportion,a=c[i.index][5],s=c[i.index][4];return{x:s==1/0?o[2]:o[2]>o[0]?o[0]+(1-r)*a-e:o[2]+r*a+e,y:0==s?o[3]:o[3]>o[1]?o[1]+(1-r)*a-e:o[3]+r*a+e,segmentInfo:i}}},jsPlumb.Endpoints.Dot=function(t){this.type="Dot";var e=this;t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this.compute=function(t,n,i,o){var r=i.radius||e.radius;return[t[0]-r,t[1]-r,2*r,2*r,r]}},jsPlumb.Endpoints.Rectangle=function(t){this.type="Rectangle";var e=this;t=t||{},this.width=t.width||20,this.height=t.height||20,this.compute=function(t,n,i,o){var r=i.width||e.width,a=i.height||e.height;return[t[0]-r/2,t[1]-a/2,r,a]}};var t=function(t){jsPlumb.DOMElementComponent.apply(this,arguments);var e=[];this.getDisplayElements=function(){return e},this.appendDisplayElement=function(t){e.push(t)}};jsPlumb.Endpoints.Image=function(e){this.type="Image",t.apply(this,arguments);var n=this,i=!1,o=!1,r=e.width,a=e.height,s=null,l=e.endpoint;this.img=new Image,n.ready=!1,this.img.onload=function(){n.ready=!0,r=r||n.img.width,a=a||n.img.height,s&&s(n)},l.setImage=function(t,e){t.constructor==String||t.src;s=e,n.img.src=t,null!=n.canvas&&n.canvas.setAttribute("src",t)},l.setImage(e.src||e.url,e.onload),this.compute=function(t,e,i,o){return n.anchorPoint=t,n.ready?[t[0]-r/2,t[1]-a/2,r,a]:[0,0,0,0]},n.canvas=document.createElement("img"),i=!1,n.canvas.style.margin=0,n.canvas.style.padding=0,n.canvas.style.outline=0,n.canvas.style.position="absolute";var c=e.cssClass?" "+e.cssClass:"";n.canvas.className=jsPlumb.endpointClass+c,r&&n.canvas.setAttribute("width",r),a&&n.canvas.setAttribute("height",a),jsPlumb.appendElement(n.canvas,e.parent),n.attachListeners(n.canvas,n),n.cleanup=function(){o=!0};var u=function(t,e,s){if(!o){i||(n.canvas.setAttribute("src",n.img.src),n.appendDisplayElement(n.canvas),i=!0);var l=n.anchorPoint[0]-r/2,c=n.anchorPoint[1]-a/2;jsPlumb.sizeCanvas(n.canvas,l,c,r,a)}};this.paint=function(t,e,i){n.ready?u(t,e,i):window.setTimeout((function(){n.paint(t,e,i)}),200)}},jsPlumb.Endpoints.Blank=function(e){var n=this;this.type="Blank",t.apply(this,arguments),this.compute=function(t,e,n,i){return[t[0],t[1],10,0]},n.canvas=document.createElement("div"),n.canvas.style.display="block",n.canvas.style.width="1px",n.canvas.style.height="1px",n.canvas.style.background="transparent",n.canvas.style.position="absolute",n.canvas.className=n._jsPlumb.endpointClass,jsPlumb.appendElement(n.canvas,e.parent),this.paint=function(t,e,i){jsPlumb.sizeCanvas(n.canvas,t[0],t[1],t[2],t[3])}},jsPlumb.Endpoints.Triangle=function(t){this.type="Triangle",(t=t||{}).width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this.compute=function(t,e,n,i){var o=n.width||self.width,r=n.height||self.height;return[t[0]-o/2,t[1]-r/2,o,r]}};var e=function(t){var e=!0,n=this;this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=null==t.location?.5:t.location,this.endpointLoc=null==t.endpointLocation?[.5,.5]:t.endpointLocation,this.setVisible=function(t){e=t,n.component.repaint()},this.isVisible=function(){return e},this.hide=function(){n.setVisible(!1)},this.show=function(){n.setVisible(!0)},this.incrementLocation=function(t){n.loc+=t,n.component.repaint()},this.setLocation=function(t){n.loc=t,n.component.repaint()},this.getLocation=function(){return n.loc}};jsPlumb.Overlays.Arrow=function(t){this.type="Arrow",e.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};var n=this;this.length=t.length||20,this.width=t.width||20,this.id=t.id;var i=(t.direction||1)<0?-1:1,o=t.paintStyle||{lineWidth:1},r=t.foldback||.623;this.computeMaxSize=function(){return 1.5*n.width},this.cleanup=function(){},this.draw=function(t,e,a){var s,l,c,u,d;if(t.pointAlongPathFrom){if(jsPlumbUtil.isString(n.loc)||n.loc>1||n.loc<0){var p=parseInt(n.loc);s=t.pointAlongPathFrom(p,i*n.length/2,!0),l=t.pointOnPath(p,!0),c=jsPlumbUtil.pointOnLine(s,l,n.length)}else if(1==n.loc){if(s=t.pointOnPath(n.loc),l=t.pointAlongPathFrom(n.loc,-1),c=jsPlumbUtil.pointOnLine(s,l,n.length),-1==i){var h=c;c=s,s=h}}else if(0==n.loc){if(c=t.pointOnPath(n.loc),l=t.pointAlongPathFrom(n.loc,1),s=jsPlumbUtil.pointOnLine(c,l,n.length),-1==i){h=c;c=s,s=h}}else s=t.pointAlongPathFrom(n.loc,i*n.length/2),l=t.pointOnPath(n.loc),c=jsPlumbUtil.pointOnLine(s,l,n.length);u=jsPlumbUtil.perpendicularLineTo(s,c,n.width),d=jsPlumbUtil.pointOnLine(s,c,r*n.length);var f=Math.min(s.x,u[0].x,u[1].x),g=Math.max(s.x,u[0].x,u[1].x),m=Math.min(s.y,u[0].y,u[1].y),v=Math.max(s.y,u[0].y,u[1].y),y={hxy:s,tail:u,cxy:d},b=o.strokeStyle||e.strokeStyle,w=o.fillStyle||e.strokeStyle,C=o.lineWidth||e.lineWidth;return n.paint(t,y,C,b,w,a),[f,g,m,v]}return[0,0,0,0]}},jsPlumb.Overlays.PlainArrow=function(t){t=t||{};var e=jsPlumb.extend(t,{foldback:1});jsPlumb.Overlays.Arrow.call(this,e),this.type="PlainArrow"},jsPlumb.Overlays.Diamond=function(t){var e=(t=t||{}).length||40,n=jsPlumb.extend(t,{length:e/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,n),this.type="Diamond"};var n=function(t){jsPlumb.DOMElementComponent.apply(this,arguments),e.apply(this,arguments);var n,i=this,o=!1;t=t||{},this.id=t.id;var r=function(){n=t.create(t.component),(n=jsPlumb.CurrentLibrary.getDOMElement(n)).style.position="absolute";var e=t._jsPlumb.overlayClass+" "+(i.cssClass?i.cssClass:t.cssClass?t.cssClass:"");n.className=e,jsPlumb.appendElement(n,t.component.parent),t._jsPlumb.getId(n),i.attachListeners(n,i),i.canvas=n};this.getElement=function(){return null==n&&r(),n},this.getDimensions=function(){return jsPlumb.CurrentLibrary.getSize(jsPlumb.CurrentLibrary.getElementObject(i.getElement()))};var a=null,s=function(t){return null==a&&(a=i.getDimensions()),a};this.clearCachedDimensions=function(){a=null},this.computeMaxSize=function(){var t=s();return Math.max(t[0],t[1])};var l=i.setVisible;i.setVisible=function(t){l(t),n.style.display=t?"block":"none"},this.cleanup=function(){null!=n&&jsPlumb.CurrentLibrary.removeElement(n)},this.paint=function(t,e,r){o||(i.getElement(),t.appendDisplayElement(n),i.attachListeners(n,t),o=!0),n.style.left=r[0]+e.minx+"px",n.style.top=r[1]+e.miny+"px"},this.draw=function(t,e,n){var o=s();if(null!=o&&2==o.length){var r={x:0,y:0};if(t.pointOnPath){var a=i.loc,l=!1;(jsPlumbUtil.isString(i.loc)||i.loc<0||i.loc>1)&&(a=parseInt(i.loc),l=!0),r=t.pointOnPath(a,l)}else{var c=i.loc.constructor==Array?i.loc:i.endpointLoc;r={x:c[0]*n[2],y:c[1]*n[3]}}return minx=r.x-o[0]/2,miny=r.y-o[1]/2,i.paint(t,{minx:minx,miny:miny,td:o,cxy:r},n),[minx,minx+o[0],miny,miny+o[1]]}return[0,0,0,0]},this.reattachListeners=function(t){n&&i.reattachListenersForElement(n,i,t)}};jsPlumb.Overlays.Custom=function(t){this.type="Custom",n.apply(this,arguments)},jsPlumb.Overlays.Label=function(t){var e=this;this.labelStyle=t.labelStyle||jsPlumb.Defaults.LabelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null,t.create=function(){return document.createElement("div")},jsPlumb.Overlays.Custom.apply(this,arguments),this.type="Label";var n=t.label||"",i=(e=this,null);this.setLabel=function(t){n=t,i=null,e.clearCachedDimensions(),o(),e.component.repaint()};var o=function(){if("function"==typeof n){var t=n(e);e.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else null==i&&(i=n,e.getElement().innerHTML=i.replace(/\r\n/g,"<br/>"))};this.getLabel=function(){return n};var r=this.getDimensions;this.getDimensions=function(){return o(),r()}}}(),jsPlumb.Connectors.StateMachine=function(t){var e,n,i,o,r=null,a=[],s=t.curviness||10,l=t.margin||5,c=t.proximityLimit||80,u=t.orientation&&"clockwise"==t.orientation,d=t.loopbackRadius||25,p=!1,h=!1!==t.showLoopback;this.type="StateMachine",t=t||{},this.compute=function(t,f,g,m,v,y,b,w){var C=Math.abs(t[0]-f[0]),j=Math.abs(t[1]-f[1]),P=.45*C,x=.45*j;C*=1.9,j*=1.9,b=b||1;var E=Math.min(t[0],f[0])-P,D=Math.min(t[1],f[1])-x;if(h&&g.elementId==m.elementId){p=!0;var S=t[0],I=t[0],_=t[1]-l,M=t[1]-l,k=_-d;r=[E=S-d-b-d,D=k-d-b-d,C=2*b+4*d,j=2*b+4*d,S-E,k-D,d,u,S-E,_-D,I-E,M-D]}else{p=!1,e=t[0]<f[0]?P:C-P,n=t[1]<f[1]?x:j-x,i=t[0]<f[0]?C-P:P,o=t[1]<f[1]?j-x:x,0==t[2]&&(e-=l),1==t[2]&&(e+=l),0==t[3]&&(n-=l),1==t[3]&&(n+=l),0==f[2]&&(i-=l),1==f[2]&&(i+=l),0==f[3]&&(o-=l),1==f[3]&&(o+=l);var O=(e+i)/2,A=(n+o)/2,L=-1*O/A,T=Math.atan(L),W=(L==1/0||L==-1/0||Math.abs(s/2*Math.sin(T)),L==1/0||L==-1/0||Math.abs(s/2*Math.cos(T)),function(t,e,n,i){return t<=n&&i<=e?1:t<=n&&e<=i?2:n<=t&&i>=e?3:4}(e,n,i,o)),z=Math.sqrt(Math.pow(i-e,2)+Math.pow(o-n,2));a=function(t,e,n,i,o,r,a,s,l){return s<=l?[t,e]:1==n?i[3]<=0&&o[3]>=1?[t+(i[2]<.5?-1*r:r),e]:i[2]>=1&&o[2]<=0?[t,e+(i[3]<.5?-1*a:a)]:[t+-1*r,e+-1*a]:2==n?i[3]>=1&&o[3]<=0?[t+(i[2]<.5?-1*r:r),e]:i[2]>=1&&o[2]<=0?[t,e+(i[3]<.5?-1*a:a)]:[t+1*r,e+-1*a]:3==n?i[3]>=1&&o[3]<=0?[t+(i[2]<.5?-1*r:r),e]:i[2]<=0&&o[2]>=1?[t,e+(i[3]<.5?-1*a:a)]:[t+-1*r,e+-1*a]:4==n?i[3]<=0&&o[3]>=1?[t+(i[2]<.5?-1*r:r),e]:i[2]<=0&&o[2]>=1?[t,e+(i[3]<.5?-1*a:a)]:[t+1*r,e+-1*a]:void 0}(O,A,W,t,f,s,s,z,c);var H=Math.max(3*Math.abs(a[0]-e),3*Math.abs(a[0]-i),Math.abs(i-e),2*b,w),F=Math.max(3*Math.abs(a[1]-n),3*Math.abs(a[1]-o),Math.abs(o-n),2*b,w);if(C<H){var B=H-C;E-=B/2,e+=B/2,i+=B/2,C=H,a[0]+=B/2}if(j<F){var U=F-j;D-=U/2,n+=U/2,o+=U/2,j=F,a[1]+=U/2}r=[E,D,C,j,e,n,i,o,a[0],a[1]]}return r};var f=function(){return[{x:i,y:o},{x:a[0],y:a[1]},{x:a[0]+1,y:a[1]+1},{x:e,y:n}]},g=function(t,e,n){return n&&(e=jsBezier.locationAlongCurveFrom(t,e>0?0:1,e)),e};this.pointOnPath=function(t,e){if(p){e&&(t/=2*Math.PI*d),t>0&&t<1&&(t=1-t);var n=2*t*Math.PI+Math.PI/2;return{x:r[4]+r[6]*Math.cos(n),y:r[5]+r[6]*Math.sin(n)}}var i=f();return t=g(i,t,e),jsBezier.pointOnCurve(i,t)},this.gradientAtPoint=function(t,e){if(p)return e&&(t/=2*Math.PI*d),Math.atan(2*t*Math.PI);var n=f();return t=g(n,t,e),jsBezier.gradientAtPoint(n,t)},this.pointAlongPathFrom=function(t,e,n){if(p){n&&(t/=2*Math.PI*d),t>0&&t<1&&(t=1-t);var i=e/(2*Math.PI*r[6])*2*Math.PI,o=2*t*Math.PI-i+Math.PI/2;return{x:r[4]+r[6]*Math.cos(o),y:r[5]+r[6]*Math.sin(o)}}var a=f();return t=g(a,t,n),jsBezier.pointAlongCurveFrom(a,t,e)}},jsPlumb.Connectors.canvas.StateMachine=function(t){var e=this;(t=t||{}).drawGuideline,t.avoidSelector,jsPlumb.Connectors.StateMachine.apply(this,arguments),jsPlumb.CanvasConnector.apply(this,arguments),this._paint=function(t){if(10==t.length)e.ctx.beginPath(),e.ctx.moveTo(t[4],t[5]),e.ctx.bezierCurveTo(t[8],t[9],t[8],t[9],t[6],t[7]),e.ctx.stroke();else{e.ctx.save(),e.ctx.beginPath();var n=2*Math.PI,i=t[7];e.ctx.arc(t[4],t[5],t[6],0,n,i),e.ctx.stroke(),e.ctx.closePath(),e.ctx.restore()}},this.createGradient=function(t,e){return e.createLinearGradient(t[4],t[5],t[6],t[7])}},jsPlumb.Connectors.svg.StateMachine=function(){jsPlumb.Connectors.StateMachine.apply(this,arguments),jsPlumb.SvgConnector.apply(this,arguments),this.getPath=function(t){return 10==t.length?"M "+t[4]+" "+t[5]+" C "+t[8]+" "+t[9]+" "+t[8]+" "+t[9]+" "+t[6]+" "+t[7]:"M"+(t[8]+4)+" "+t[9]+" A "+t[6]+" "+t[6]+" 0 1,0 "+(t[8]-4)+" "+t[9]}},jsPlumb.Connectors.vml.StateMachine=function(){jsPlumb.Connectors.StateMachine.apply(this,arguments),jsPlumb.VmlConnector.apply(this,arguments);var t=jsPlumb.vml.convertValue;this.getPath=function(e){if(10==e.length)return"m"+t(e[4])+","+t(e[5])+" c"+t(e[8])+","+t(e[9])+","+t(e[8])+","+t(e[9])+","+t(e[6])+","+t(e[7])+" e";var n=t(e[8]-e[6]),i=t(e[9]-2*e[6]);return"ar "+n+","+i+","+(n+t(2*e[6]))+","+(i+t(2*e[6]))+","+t(e[8])+","+t(e[9])+","+t(e[8])+","+t(e[9])+" e"}},function(){var t={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},e=null;if(document.createStyleSheet&&document.namespaces){var n=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"];e=document.createStyleSheet();for(var i=0;i<n.length;i++)e.addRule(n[i],"behavior:url(#default#VML);position:absolute;");document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var o=1e3,r=function(t,e){for(var n in e)t[n]=e[n]},a=function(t,e,n,i,o,a){n=n||{};var l=document.createElement("jsplumb:"+t);return a?o.appendElement(l,i):jsPlumb.CurrentLibrary.appendElement(l,i),l.className=(n.class?n.class+" ":"")+"jsplumb_vml",s(l,e),r(l,n),l},s=function(t,e,n){t.style.left=e[0]+"px",t.style.top=e[1]+"px",t.style.width=e[2]+"px",t.style.height=e[3]+"px",t.style.position="absolute",n&&(t.style.zIndex=n)},l=jsPlumb.vml.convertValue=function(t){return Math.floor(t*o)},c=function(t,e,n,i){"transparent"===e?i.setOpacity(n,"0.0"):i.setOpacity(n,"1.0")},u=function(t,e,n,i){var o={};if(e.strokeStyle){o.stroked="true";var s=jsPlumbUtil.convertStyle(e.strokeStyle,!0);o.strokecolor=s,c(0,s,"stroke",n),o.strokeweight=e.lineWidth+"px"}else o.stroked="false";if(e.fillStyle){o.filled="true";var l=jsPlumbUtil.convertStyle(e.fillStyle,!0);o.fillcolor=l,c(0,l,"fill",n)}else o.filled="false";if(e.dashstyle)null==n.strokeNode?n.strokeNode=a("stroke",[0,0,0,0],{dashstyle:e.dashstyle},t,i):n.strokeNode.dashstyle=e.dashstyle;else if(e["stroke-dasharray"]&&e.lineWidth){for(var u=-1==e["stroke-dasharray"].indexOf(",")?" ":",",d=e["stroke-dasharray"].split(u),p="",h=0;h<d.length;h++)p+=Math.floor(d[h]/e.lineWidth)+u;null==n.strokeNode?n.strokeNode=a("stroke",[0,0,0,0],{dashstyle:p},t,i):n.strokeNode.dashstyle=p}r(t,o)},d=function(){var t=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(e){t.opacityNodes.stroke=a("stroke",[0,0,1,1],{opacity:"0.0"},e,t._jsPlumb),t.opacityNodes.fill=a("fill",[0,0,1,1],{opacity:"0.0"},e,t._jsPlumb)},this.setOpacity=function(e,n){var i=t.opacityNodes[e];i&&(i.opacity=""+n)};var e=[];this.getDisplayElements=function(){return e},this.appendDisplayElement=function(n,i){i||t.canvas.parentNode.appendChild(n),e.push(n)}},p=jsPlumb.VmlConnector=function(e){var n=this;n.strokeNode=null,n.canvas=null,d.apply(this,arguments);var i=n._jsPlumb.connectorClass+(e.cssClass?" "+e.cssClass:"");this.paint=function(l,c,d){if(null!=c){var p={path:n.getPath(l)};if(c.outlineColor){var h=c.outlineWidth||1,f=c.lineWidth+2*h,g={strokeStyle:jsPlumbUtil.convertStyle(c.outlineColor),lineWidth:f};for(var m in t)g[m]=c[m];null==n.bgCanvas?(p.class=i,p.coordsize=l[2]*o+","+l[3]*o,n.bgCanvas=a("shape",l,p,e.parent,n._jsPlumb,!0),s(n.bgCanvas,l,n.getZIndex()),n.appendDisplayElement(n.bgCanvas,!0),n.attachListeners(n.bgCanvas,n),n.initOpacityNodes(n.bgCanvas,["stroke"])):(p.coordsize=l[2]*o+","+l[3]*o,s(n.bgCanvas,l,n.getZIndex()),r(n.bgCanvas,p)),u(n.bgCanvas,g,n)}null==n.canvas?(p.class=i,p.coordsize=l[2]*o+","+l[3]*o,n.tooltip&&(p.label=n.tooltip),n.canvas=a("shape",l,p,e.parent,n._jsPlumb,!0),n.appendDisplayElement(n.canvas,!0),n.attachListeners(n.canvas,n),n.initOpacityNodes(n.canvas,["stroke"])):(p.coordsize=l[2]*o+","+l[3]*o,s(n.canvas,l,n.getZIndex()),r(n.canvas,p)),u(n.canvas,c,n,n._jsPlumb)}},this.reattachListeners=function(){n.canvas&&n.reattachListenersForElement(n.canvas,n)}},h=window.VmlEndpoint=function(t){d.apply(this,arguments);var e=null,n=this;n.canvas=document.createElement("div"),n.canvas.style.position="absolute";var i=n._jsPlumb.endpointClass+(t.cssClass?" "+t.cssClass:"");t._jsPlumb.appendElement(n.canvas,t.parent),n.tooltip&&n.canvas.setAttribute("label",n.tooltip),this.paint=function(t,o,a){var l={};jsPlumb.sizeCanvas(n.canvas,t[0],t[1],t[2],t[3]),null==e?(l.class=i,e=n.getVml([0,0,t[2],t[3]],l,a,n.canvas,n._jsPlumb),n.attachListeners(e,n),n.appendDisplayElement(e,!0),n.appendDisplayElement(n.canvas,!0),n.initOpacityNodes(e,["fill"])):(s(e,[0,0,t[2],t[3]]),r(e,l)),u(e,o,n)},this.reattachListeners=function(){e&&n.reattachListenersForElement(e,n)}};jsPlumb.Connectors.vml.Bezier=function(){jsPlumb.Connectors.Bezier.apply(this,arguments),p.apply(this,arguments),this.getPath=function(t){return"m"+l(t[4])+","+l(t[5])+" c"+l(t[8])+","+l(t[9])+","+l(t[10])+","+l(t[11])+","+l(t[6])+","+l(t[7])+" e"}},jsPlumb.Connectors.vml.Straight=function(){jsPlumb.Connectors.Straight.apply(this,arguments),p.apply(this,arguments),this.getPath=function(t){return"m"+l(t[4])+","+l(t[5])+" l"+l(t[6])+","+l(t[7])+" e"}},jsPlumb.Connectors.vml.Flowchart=function(){jsPlumb.Connectors.Flowchart.apply(this,arguments),p.apply(this,arguments),this.getPath=function(t){for(var e="m "+l(t[4])+","+l(t[5])+" l",n=0;n<t[8];n++)e=e+" "+l(t[9+2*n])+","+l(t[10+2*n]);return e=e+" "+l(t[6])+","+l(t[7])+" e"}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),h.apply(this,arguments),this.getVml=function(t,e,n,i,o){return a("oval",t,e,i,o)}},jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),h.apply(this,arguments),this.getVml=function(t,e,n,i,o){return a("rect",t,e,i,o)}},jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var f=function(t,e){t.apply(this,e),d.apply(this,e);var n=this;n.canvas=null,n.isAppendedAtTopLevel=!0;this.paint=function(t,e,i,c,u,d){var p={};c&&(p.stroked="true",p.strokecolor=jsPlumbUtil.convertStyle(c,!0)),i&&(p.strokeweight=i+"px"),u&&(p.filled="true",p.fillcolor=u);var h=Math.min(e.hxy.x,e.tail[0].x,e.tail[1].x,e.cxy.x),f=Math.min(e.hxy.y,e.tail[0].y,e.tail[1].y,e.cxy.y),g=Math.max(e.hxy.x,e.tail[0].x,e.tail[1].x,e.cxy.x),m=Math.max(e.hxy.y,e.tail[0].y,e.tail[1].y,e.cxy.y),v=[h,f,Math.abs(g-h),Math.abs(m-f)];p.path=function(t,e){return"m "+l(t.hxy.x)+","+l(t.hxy.y)+" l "+l(t.tail[0].x)+","+l(t.tail[0].y)+" "+l(t.cxy.x)+","+l(t.cxy.y)+" "+l(t.tail[1].x)+","+l(t.tail[1].y)+" x e"}(e),p.coordsize=d[2]*o+","+d[3]*o,v[0]=d[0],v[1]=d[1],v[2]=d[2],v[3]=d[3],null==n.canvas?(n.canvas=a("shape",v,p,t.canvas.parentNode,t._jsPlumb,!0),t.appendDisplayElement(n.canvas,!0),n.attachListeners(n.canvas,t),n.attachListeners(n.canvas,n)):(s(n.canvas,v),r(n.canvas,p))},this.reattachListeners=function(){n.canvas&&n.reattachListenersForElement(n.canvas,n)},this.cleanup=function(){null!=n.canvas&&jsPlumb.CurrentLibrary.removeElement(n.canvas)}};jsPlumb.Overlays.vml.Arrow=function(){f.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.vml.PlainArrow=function(){f.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.vml.Diamond=function(){f.apply(this,[jsPlumb.Overlays.Diamond,arguments])}}(),function(){var t={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},e="stroke-dasharray",n="linearGradient",i="radialGradient",o="fill",r="stroke",a="style",s="none",l="http://www.w3.org/2000/svg",c="http://www.w3.org/1999/xhtml",u=function(t,e){for(var n in e)t.setAttribute(n,""+e[n])},d=function(t,e){var n=document.createElementNS(l,t);return(e=e||{}).version="1.1",e.xmlns=c,u(n,e),n},p=function(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"},h=function(t){for(var e=0;e<t.childNodes.length;e++)t.childNodes[e].tagName!=n&&t.childNodes[e].tagName!=i||t.removeChild(t.childNodes[e])},f=function(l,c,u,p,f){if(u.gradient?function(t,e,s,l,c){var u="jsplumb_gradient_"+c._jsPlumb.idstamp();if(h(t),s.gradient.offset)p=d(i,{id:u}),t.appendChild(p);else{var p=d(n,{id:u,gradientUnits:"userSpaceOnUse"});t.appendChild(p)}for(var f=0;f<s.gradient.stops.length;f++){var g=f;g=8==l.length?l[4]<l[6]?f:s.gradient.stops.length-1-f:l[4]<l[6]?s.gradient.stops.length-1-f:f;var m=jsPlumbUtil.convertStyle(s.gradient.stops[g][1],!0),v=d("stop",{offset:Math.floor(100*s.gradient.stops[f][0])+"%","stop-color":m});p.appendChild(v)}var y=s.strokeStyle?r:o;e.setAttribute(a,y+":url(#"+u+")")}(l,c,u,p,f):(h(l),c.setAttribute(a,"")),c.setAttribute(o,u.fillStyle?jsPlumbUtil.convertStyle(u.fillStyle,!0):s),c.setAttribute(r,u.strokeStyle?jsPlumbUtil.convertStyle(u.strokeStyle,!0):s),u.lineWidth&&c.setAttribute("stroke-width",u.lineWidth),u.dashstyle&&u.lineWidth&&!u[e]){var g=-1==u.dashstyle.indexOf(",")?" ":",",m=u.dashstyle.split(g),v="";m.forEach((function(t){v+=Math.floor(t*u.lineWidth)+g})),c.setAttribute(e,v)}else u[e]&&c.setAttribute(e,u[e]);for(var y in t)u[y]&&c.setAttribute(t[y],u[y])},g=function(t,e,n){for(var i=n.split(" "),o=t.className.baseVal.split(" "),r=0;r<i.length;r++)if(e)-1==o.indexOf(i[r])&&o.push(i[r]);else{var a=o.indexOf(i[r]);-1!=a&&o.splice(a,1)}t.className.baseVal=o.join(" ")};jsPlumbUtil.svg={addClass:function(t,e){g(t,!0,e)},removeClass:function(t,e){g(t,!1,e)},node:d,attr:u,pos:p};var m=function(t){var e=this,n=t.pointerEventsSpec||"all";jsPlumb.jsPlumbUIComponent.apply(this,t.originalArgs),e.canvas=null,e.path=null,e.svg=null;var i=t.cssClass+" "+(t.originalArgs[0].cssClass||""),o={style:"",width:0,height:0,"pointer-events":n,position:"absolute"};e.tooltip&&(o.title=e.tooltip),e.svg=d("svg",o),t.useDivWrapper?(e.canvas=document.createElement("div"),e.canvas.style.position="absolute",jsPlumb.sizeCanvas(e.canvas,0,0,1,1),e.canvas.className=i,e.tooltip&&e.canvas.setAttribute("title",e.tooltip)):(u(e.svg,{class:i}),e.canvas=e.svg),t._jsPlumb.appendElement(e.canvas,t.originalArgs[0].parent),t.useDivWrapper&&e.canvas.appendChild(e.svg);var r=[e.canvas];this.getDisplayElements=function(){return r},this.appendDisplayElement=function(t){r.push(t)},this.paint=function(n,i,o){if(null!=i){var r=n[0],a=n[1];t.useDivWrapper&&(jsPlumb.sizeCanvas(e.canvas,n[0],n[1],n[2],n[3]),r=0,a=0);var s=p([r,a,n[2],n[3]]);e.getZIndex()&&(s+=";z-index:"+e.getZIndex()+";"),u(e.svg,{style:s,width:n[2],height:n[3]}),e._paint.apply(this,arguments)}}},v=jsPlumb.SvgConnector=function(t){var e=this;m.apply(this,[{cssClass:t._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",tooltip:t.tooltip,_jsPlumb:t._jsPlumb}]),this._paint=function(t,n){var i={d:e.getPath(t)},o=null;if(i["pointer-events"]="all",n.outlineColor){var r=n.outlineWidth||1,a=n.lineWidth+2*r;(o=jsPlumb.CurrentLibrary.extend({},n)).strokeStyle=jsPlumbUtil.convertStyle(n.outlineColor),o.lineWidth=a,null==e.bgPath?(e.bgPath=d("path",i),e.svg.appendChild(e.bgPath),e.attachListeners(e.bgPath,e)):u(e.bgPath,i),f(e.svg,e.bgPath,o,t,e)}null==e.path?(e.path=d("path",i),e.svg.appendChild(e.path),e.attachListeners(e.path,e)):u(e.path,i),f(e.svg,e.path,n,t,e)},this.reattachListeners=function(){e.bgPath&&e.reattachListenersForElement(e.bgPath,e),e.path&&e.reattachListenersForElement(e.path,e)}};jsPlumb.Connectors.svg.Bezier=function(t){jsPlumb.Connectors.Bezier.apply(this,arguments),v.apply(this,arguments),this.getPath=function(t){var e="M "+t[4]+" "+t[5];return e+=" C "+t[8]+" "+t[9]+" "+t[10]+" "+t[11]+" "+t[6]+" "+t[7]}},jsPlumb.Connectors.svg.Straight=function(t){jsPlumb.Connectors.Straight.apply(this,arguments),v.apply(this,arguments),this.getPath=function(t){return"M "+t[4]+" "+t[5]+" L "+t[6]+" "+t[7]}},jsPlumb.Connectors.svg.Flowchart=function(){var t=this;jsPlumb.Connectors.Flowchart.apply(this,arguments),v.apply(this,arguments),this.getPath=function(e){for(var n="M "+e[4]+","+e[5],i=e[4],o=e[5],r=0;r<e[8];r++){var a=e[9+2*r],s=e[10+2*r],l=e[9+2*(r+1)],c=e[10+2*(r+1)],u=a!=i&&s==o?a>l?1:-1:0,d=a==i&&s!=o?s>c?1:-1:0,p=t.lineWidth/2;i=a,o=s,n=(n=(n=n+" L "+a+" "+s)+" L "+(a+u*p)+" "+(s+d*p))+" M "+a+" "+s}return n=n+" L "+e[6]+","+e[7]}};var y=window.SvgEndpoint=function(t){var e=this;m.apply(this,[{cssClass:t._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:t._jsPlumb}]),this._paint=function(t,n){var i=jsPlumb.extend({},n);i.outlineColor&&(i.strokeWidth=i.outlineWidth,i.strokeStyle=jsPlumbUtil.convertStyle(i.outlineColor,!0)),null==e.node&&(e.node=e.makeNode(t,i),e.svg.appendChild(e.node),e.attachListeners(e.node,e)),f(e.svg,e.node,i,t,e),p(e.node)},this.reattachListeners=function(){e.node&&e.reattachListenersForElement(e.node,e)}};jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),y.apply(this,arguments),this.makeNode=function(t,e){return d("circle",{cx:t[2]/2,cy:t[3]/2,r:t[2]/2})}},jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),y.apply(this,arguments),this.makeNode=function(t,e){return d("rect",{width:t[2],height:t[3]})}},jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var b=function(t,e){t.apply(this,e),jsPlumb.jsPlumbUIComponent.apply(this,e),this.isAppendedAtTopLevel=!1;var n=this,i=null;this.paint=function(t,r,a,s,l){null==i&&(i=d("path",{"pointer-events":"all"}),t.svg.appendChild(i),n.attachListeners(i,t),n.attachListeners(i,n));var c=e&&1==e.length&&e[0].cssClass||"";u(i,{d:o(r),class:c,stroke:s||null,fill:l||null})};var o=function(t){return"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.reattachListeners=function(){i&&n.reattachListenersForElement(i,n)},this.cleanup=function(){null!=i&&jsPlumb.CurrentLibrary.removeElement(i)}};jsPlumb.Overlays.svg.Arrow=function(){b.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.svg.PlainArrow=function(){b.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.svg.Diamond=function(){b.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumb.Overlays.svg.GuideLines=function(){var t,e,n=null,i=this;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(r,a,s,l,c){null==n&&(n=d("path"),r.svg.appendChild(n),i.attachListeners(n,r),i.attachListeners(n,i),t=d("path"),r.svg.appendChild(t),i.attachListeners(t,r),i.attachListeners(t,i),e=d("path"),r.svg.appendChild(e),i.attachListeners(e,r),i.attachListeners(e,i)),u(n,{d:o(a[0],a[1]),stroke:"red",fill:null}),u(t,{d:o(a[2][0],a[2][1]),stroke:"blue",fill:null}),u(e,{d:o(a[3][0],a[3][1]),stroke:"green",fill:null})};var o=function(t,e){return"M "+t.x+","+t.y+" L"+e.x+","+e.y}}}(),function(){var t=function(t,n){return jsPlumb.CurrentLibrary.hasClass(e(t),n)},e=function(t){return jsPlumb.CurrentLibrary.getElementObject(t)},n=function(t){return jsPlumb.CurrentLibrary.getOffset(e(t))},i=function(t){return jsPlumb.CurrentLibrary.getPageXY(t)},o=function(t){return jsPlumb.CurrentLibrary.getClientXY(t)},r=function(){var r=this;r.overlayPlacements=[],jsPlumb.jsPlumbUIComponent.apply(this,arguments),jsPlumbUtil.EventGenerator.apply(this,arguments),this._over=function(t){var o=n(e(r.canvas)),a=i(t),s=a[0]-o.left,l=a[1]-o.top;if(s>0&&l>0&&s<r.canvas.width&&l<r.canvas.height){for(var c=0;c<r.overlayPlacements.length;c++){var u=r.overlayPlacements[c];if(u&&u[0]<=s&&u[1]>=s&&u[2]<=l&&u[3]>=l)return!0}var d=r.canvas.getContext("2d").getImageData(parseInt(s),parseInt(l),1,1);return 0!=d.data[0]||0!=d.data[1]||0!=d.data[2]||0!=d.data[3]}return!1};var a=!1,s=!1,l=!1,c=function(e,n){return null!=e&&t(e,n)};this.mousemove=function(t){i(t);var e=o(t),n=document.elementFromPoint(e[0],e[1]),s=c(n,"_jsPlumb_overlay"),l=c(n,"_jsPlumb_endpoint")||c(n,"_jsPlumb_connector");if(!a&&l&&r._over(t))return a=!0,r.fire("mouseenter",r,t),!0;!a||r._over(t)&&l||s||(a=!1,r.fire("mouseexit",r,t)),r.fire("mousemove",r,t)},this.click=function(t){a&&r._over(t)&&!l&&r.fire("click",r,t),l=!1},this.dblclick=function(t){a&&r._over(t)&&!l&&r.fire("dblclick",r,t),l=!1},this.mousedown=function(t){r._over(t)&&!s&&(s=!0,n(e(r.canvas)),r.fire("mousedown",r,t))},this.mouseup=function(t){s=!1,r.fire("mouseup",r,t)},this.contextmenu=function(t){a&&r._over(t)&&!l&&r.fire("contextmenu",r,t),l=!1}},a=function(t){var e=document.createElement("canvas");return t._jsPlumb.appendElement(e,t.parent),e.style.position="absolute",t.class&&(e.className=t.class),t._jsPlumb.getId(e,t.uuid),t.tooltip&&e.setAttribute("title",t.tooltip),e},s=function(t){r.apply(this,arguments);var e=[];this.getDisplayElements=function(){return e},this.appendDisplayElement=function(t){e.push(t)}},l=jsPlumb.CanvasConnector=function(t){s.apply(this,arguments);var e=function(t,e){if(n.ctx.save(),jsPlumb.extend(n.ctx,e),e.gradient){for(var i=n.createGradient(t,n.ctx),o=0;o<e.gradient.stops.length;o++)i.addColorStop(e.gradient.stops[o][0],e.gradient.stops[o][1]);n.ctx.strokeStyle=i}n._paint(t,e),n.ctx.restore()},n=this,i=n._jsPlumb.connectorClass+" "+(t.cssClass||"");n.canvas=a({class:i,_jsPlumb:n._jsPlumb,parent:t.parent,tooltip:t.tooltip}),n.ctx=n.canvas.getContext("2d"),n.appendDisplayElement(n.canvas),n.paint=function(t,i){if(null!=i){if(jsPlumb.sizeCanvas(n.canvas,t[0],t[1],t[2],t[3]),n.getZIndex()&&(n.canvas.style.zIndex=n.getZIndex()),null!=i.outlineColor){var o=i.outlineWidth||1,r=i.lineWidth+2*o,a={strokeStyle:i.outlineColor,lineWidth:r};e(t,a)}e(t,i)}}},c=function(t){var e=this;s.apply(this,arguments);var n=e._jsPlumb.endpointClass+" "+(t.cssClass||""),i={class:n,_jsPlumb:e._jsPlumb,parent:t.parent,tooltip:e.tooltip};e.canvas=a(i),e.ctx=e.canvas.getContext("2d"),e.appendDisplayElement(e.canvas),this.paint=function(t,n,i){if(jsPlumb.sizeCanvas(e.canvas,t[0],t[1],t[2],t[3]),null!=n.outlineColor){var o=n.outlineWidth||1,r=n.lineWidth+2*o;n.outlineColor}e._paint.apply(this,arguments)}};jsPlumb.Endpoints.canvas.Dot=function(t){jsPlumb.Endpoints.Dot.apply(this,arguments),c.apply(this,arguments);var e=this,n=function(t){try{return parseInt(t)}catch(e){if("%"==t.substring(t.length-1))return parseInt(t.substring(0,t-1))}},i=function(t){var i=e.defaultOffset,o=e.defaultInnerRadius;return t.offset&&(i=n(t.offset)),t.innerRadius&&(o=n(t.innerRadius)),[i,o]};this._paint=function(t,n,o){if(null!=n){var r=e.canvas.getContext("2d"),a=o.getOrientation(e);if(jsPlumb.extend(r,n),n.gradient){for(var s=i(n.gradient),l=1==a[1]?-1*s[0]:s[0],c=1==a[0]?-1*s[0]:s[0],u=r.createRadialGradient(t[4],t[4],t[4],t[4]+c,t[4]+l,s[1]),d=0;d<n.gradient.stops.length;d++)u.addColorStop(n.gradient.stops[d][0],n.gradient.stops[d][1]);r.fillStyle=u}r.beginPath(),r.arc(t[4],t[4],t[4],0,2*Math.PI,!0),r.closePath(),(n.fillStyle||n.gradient)&&r.fill(),n.strokeStyle&&r.stroke()}}},jsPlumb.Endpoints.canvas.Rectangle=function(t){var e=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments),c.apply(this,arguments),this._paint=function(t,n,i){var o=e.canvas.getContext("2d"),r=i.getOrientation(e);if(jsPlumb.extend(o,n),n.gradient){for(var a=1==r[1]?t[3]:0==r[1]?t[3]/2:0,s=-1==r[1]?t[3]:0==r[1]?t[3]/2:0,l=1==r[0]?t[2]:0==r[0]?t[2]/2:0,c=-1==r[0]?t[2]:0==r[0]?t[2]/2:0,u=o.createLinearGradient(l,a,c,s),d=0;d<n.gradient.stops.length;d++)u.addColorStop(n.gradient.stops[d][0],n.gradient.stops[d][1]);o.fillStyle=u}o.beginPath(),o.rect(0,0,t[2],t[3]),o.closePath(),(n.fillStyle||n.gradient)&&o.fill(),n.strokeStyle&&o.stroke()}},jsPlumb.Endpoints.canvas.Triangle=function(t){var e=this;jsPlumb.Endpoints.Triangle.apply(this,arguments),c.apply(this,arguments),this._paint=function(t,n,i){var o=t[2],r=t[3],a=(t[0],t[1],e.canvas.getContext("2d")),s=0,l=0,c=0,u=i.getOrientation(e);1==u[0]&&(s=o,l=r,c=180),-1==u[1]&&(s=o,c=90),1==u[1]&&(l=r,c=-90),a.fillStyle=n.fillStyle,a.translate(s,l),a.rotate(c*Math.PI/180),a.beginPath(),a.moveTo(0,0),a.lineTo(o/2,r/2),a.lineTo(0,r),a.closePath(),(n.fillStyle||n.gradient)&&a.fill(),n.strokeStyle&&a.stroke()}},jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Connectors.canvas.Bezier=function(){var t=this;jsPlumb.Connectors.Bezier.apply(this,arguments),l.apply(this,arguments),this._paint=function(e,n){t.ctx.beginPath(),t.ctx.moveTo(e[4],e[5]),t.ctx.bezierCurveTo(e[8],e[9],e[10],e[11],e[6],e[7]),t.ctx.stroke()},this.createGradient=function(e,n,i){return t.ctx.createLinearGradient(e[6],e[7],e[4],e[5])}},jsPlumb.Connectors.canvas.Straight=function(){var t=this,e=[null,[1,-1],[1,1],[-1,1],[-1,-1]];jsPlumb.Connectors.Straight.apply(this,arguments),l.apply(this,arguments),this._paint=function(n,i){if(t.ctx.beginPath(),i.dashstyle&&2==i.dashstyle.split(" ").length){var o=i.dashstyle.split(" ");2!=o.length&&(o=[2,2]);for(var r=[o[0]*i.lineWidth,o[1]*i.lineWidth],a=(n[6]-n[4])/(n[7]-n[5]),s=jsPlumbUtil.segment([n[4],n[5]],[n[6],n[7]]),l=e[s],c=Math.atan(a),u=Math.sqrt(Math.pow(n[6]-n[4],2)+Math.pow(n[7]-n[5],2)),d=Math.floor(u/(r[0]+r[1])),p=[n[4],n[5]],h=0;h<d;h++){t.ctx.moveTo(p[0],p[1]);var f=p[0]+Math.abs(Math.sin(c)*r[0])*l[0],g=p[1]+Math.abs(Math.cos(c)*r[0])*l[1],m=p[0]+Math.abs(Math.sin(c)*(r[0]+r[1]))*l[0],v=p[1]+Math.abs(Math.cos(c)*(r[0]+r[1]))*l[1];t.ctx.lineTo(f,g),p=[m,v]}t.ctx.moveTo(p[0],p[1]),t.ctx.lineTo(n[6],n[7])}else t.ctx.moveTo(n[4],n[5]),t.ctx.lineTo(n[6],n[7]);t.ctx.stroke()},this.createGradient=function(t,e){return e.createLinearGradient(t[4],t[5],t[6],t[7])}},jsPlumb.Connectors.canvas.Flowchart=function(){var t=this;jsPlumb.Connectors.Flowchart.apply(this,arguments),l.apply(this,arguments),this._paint=function(e,n){t.ctx.beginPath(),t.ctx.moveTo(e[4],e[5]);for(var i=0;i<e[8];i++)t.ctx.lineTo(e[9+2*i],e[10+2*i]);t.ctx.lineTo(e[6],e[7]),t.ctx.stroke()},this.createGradient=function(t,e){return e.createLinearGradient(t[4],t[5],t[6],t[7])}},jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.canvas.Custom=jsPlumb.Overlays.Custom;var u=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)},d=function(t,e){t.apply(this,e),u.apply(this,e),this.paint=function(t,e,n,i,o){var r=t.ctx;r.lineWidth=n,r.beginPath(),r.moveTo(e.hxy.x,e.hxy.y),r.lineTo(e.tail[0].x,e.tail[0].y),r.lineTo(e.cxy.x,e.cxy.y),r.lineTo(e.tail[1].x,e.tail[1].y),r.lineTo(e.hxy.x,e.hxy.y),r.closePath(),i&&(r.strokeStyle=i,r.stroke()),o&&(r.fillStyle=o,r.fill())}};jsPlumb.Overlays.canvas.Arrow=function(){d.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.canvas.PlainArrow=function(){d.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.canvas.Diamond=function(){d.apply(this,[jsPlumb.Overlays.Diamond,arguments])}}(),function(t){jsPlumb.CurrentLibrary={addClass:function(t,e){t=jsPlumb.CurrentLibrary.getElementObject(t);try{t[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.addClass(t[0],e)}catch(t){}t.addClass(e)},animate:function(t,e,n){t.animate(e,n)},appendElement:function(t,e){jsPlumb.CurrentLibrary.getElementObject(e).append(t)},ajax:function(e){(e=e||{}).type=e.type||"get",t.ajax(e)},bind:function(t,e,n){(t=jsPlumb.CurrentLibrary.getElementObject(t)).bind(e,n)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(e,n){return t.extend(e,n)},getAttribute:function(t,e){return t.attr(e)},getClientXY:function(t){return[t.clientX,t.clientY]},getDragObject:function(t){return t[1].draggable},getDragScope:function(t){return t.draggable("option","scope")},getDropEvent:function(t){return t[0]},getDropScope:function(t){return t.droppable("option","scope")},getDOMElement:function(t){return"string"==typeof t?document.getElementById(t):t.context||null!=t.length?t[0]:t},getElementObject:function(e){return t("string"==typeof e?"#"+e:e)},getOffset:function(t){return t.offset()},getOriginalEvent:function(t){return t.originalEvent},getPageXY:function(t){return[t.pageX,t.pageY]},getParent:function(t){return jsPlumb.CurrentLibrary.getElementObject(t).parent()},getScrollLeft:function(t){return t.scrollLeft()},getScrollTop:function(t){return t.scrollTop()},getSelector:function(e){return t(e)},getSize:function(t){return[t.outerWidth(),t.outerHeight()]},getTagName:function(t){var e=jsPlumb.CurrentLibrary.getElementObject(t);return e.length>0?e[0].tagName:null},getUIPosition:function(t,e){if(e=e||1,1==t.length)ret={left:t[0].pageX,top:t[0].pageY};else{var n=t[1],i=n.offset;ret=i||n.absolutePosition,n.position.left/=e,n.position.top/=e}return{left:ret.left/e,top:ret.top/e}},hasClass:function(t,e){return t.hasClass(e)},initDraggable:function(t,e,n){(e=e||{}).helper=null,n&&(e.scope=e.scope||jsPlumb.Defaults.Scope),t.draggable(e)},initDroppable:function(t,e){e.scope=e.scope||jsPlumb.Defaults.Scope,t.droppable(e)},isAlreadyDraggable:function(t){return(t=jsPlumb.CurrentLibrary.getElementObject(t)).hasClass("ui-draggable")},isDragSupported:function(t,e){return t.draggable},isDropSupported:function(t,e){return t.droppable},removeClass:function(t,e){t=jsPlumb.CurrentLibrary.getElementObject(t);try{t[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.removeClass(t[0],e)}catch(t){}t.removeClass(e)},removeElement:function(t,e){jsPlumb.CurrentLibrary.getElementObject(t).remove()},setAttribute:function(t,e,n){t.attr(e,n)},setDraggable:function(t,e){t.draggable("option","disabled",!e)},setDragScope:function(t,e){t.draggable("option","scope",e)},setOffset:function(t,e){jsPlumb.CurrentLibrary.getElementObject(t).offset(e)},trigger:function(t,e,n){jQuery._data(jsPlumb.CurrentLibrary.getElementObject(t)[0],"handle")(n)},unbind:function(t,e,n){(t=jsPlumb.CurrentLibrary.getElementObject(t)).unbind(e,n)}},t(document).ready(jsPlumb.init)}(jQuery),function(){void 0===Math.sgn&&(Math.sgn=function(t){return 0==t?0:0<t?1:-1});var t=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},e=function(t,e){return t.x*e.x+t.y*e.y},n=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},i=function(t,e){return{x:t.x*e,y:t.y*e}},o=Math.pow(2,-65),r=function(o,r){for(var l=[],c=r.length-1,u=2*c-1,d=[],p=[],h=[],f=[],g=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],m=0;m<=c;m++)d[m]=t(r[m],o);for(m=0;m<=c-1;m++)p[m]=t(r[m+1],r[m]),p[m]=i(p[m],3);for(m=0;m<=c-1;m++)for(var v=0;v<=c;v++)h[m]||(h[m]=[]),h[m][v]=e(p[m],d[v]);for(m=0;m<=u;m++)f[m]||(f[m]=[]),f[m].y=0,f[m].x=parseFloat(m)/u;for(u=c-1,d=0;d<=c+u;d++)for(m=Math.max(0,d-u),p=Math.min(d,c);m<=p;m++)j=d-m,f[m+j].y=f[m+j].y+h[j][m]*g[j][m];for(c=r.length-1,f=a(f,2*c-1,l,0),u=t(o,r[0]),h=n(u),m=g=0;m<f;m++)u=t(o,s(r,c,l[m],null,null)),(u=n(u))<h&&(h=u,g=l[m]);return u=t(o,r[c]),(u=n(u))<h&&(h=u,g=1),{location:g,distance:h}},a=function(t,e,n,i){var r,l,c=[],u=[],d=[],p=[],h=0;l=Math.sgn(t[0].y);for(var f=1;f<=e;f++)(r=Math.sgn(t[f].y))!=l&&h++,l=r;switch(h){case 0:return 0;case 1:if(i>=64)return n[0]=(t[0].x+t[e].x)/2,1;var g;h=t[0].y-t[e].y;for(l=t[e].x-t[0].x,f=t[0].x*t[e].y-t[e].x*t[0].y,r=max_distance_below=0,g=1;g<e;g++){var m=h*t[g].x+l*t[g].y+f;m>r?r=m:m<max_distance_below&&(max_distance_below=m)}if(r=1/(0*(g=l)-1*h)*(1*(f-r)-0*g),h=1/(0*(g=l)-1*h)*(1*(l=f-max_distance_below)-0*g),l=Math.min(r,h),Math.max(r,h)-l<o)return d=t[e].x-t[0].x,p=t[e].y-t[0].y,n[0]=0+1*(d*(t[0].y-0)-p*(t[0].x-0))*(1/(0*d-1*p)),1}for(s(t,e,.5,c,u),t=a(c,e,d,i+1),e=a(u,e,p,i+1),i=0;i<t;i++)n[i]=d[i];for(i=0;i<e;i++)n[i+t]=p[i];return t+e},s=function(t,e,n,i,o){for(var r=[[]],a=0;a<=e;a++)r[0][a]=t[a];for(t=1;t<=e;t++)for(a=0;a<=e-t;a++)r[t]||(r[t]=[]),r[t][a]||(r[t][a]={}),r[t][a].x=(1-n)*r[t-1][a].x+n*r[t-1][a+1].x,r[t][a].y=(1-n)*r[t-1][a].y+n*r[t-1][a+1].y;if(null!=i)for(a=0;a<=e;a++)i[a]=r[a][0];if(null!=o)for(a=0;a<=e;a++)o[a]=r[e-a][a];return r[e][0]},l={},c=function(t,e){for(var n=function(t){if(!(e=l[t])){var e,n=function(t){return function(){return t}},i=function(){return function(t){return t}},o=function(){return function(t){return 1-t}},r=function(t){return function(e){for(var n=1,i=0;i<t.length;i++)n*=t[i](e);return n}};(e=[]).push(new function(){return function(e){return Math.pow(e,t)}});for(var a=1;a<t;a++){for(var s=[new n(t)],c=0;c<t-a;c++)s.push(new i);for(c=0;c<a;c++)s.push(new o);e.push(new r(s))}e.push(new function(){return function(e){return Math.pow(1-e,t)}}),l[t]=e}return e}(t.length-1),i=0,o=0,r=0;r<t.length;r++)i+=t[r].x*n[r](e),o+=t[r].y*n[r](e);return{x:i,y:o}},u=function(t,e,n){for(var i=c(t,e),o=0,r=n>0?1:-1,a=null;o<Math.abs(n);)a=c(t,e+=.005*r),o+=Math.sqrt(Math.pow(a.x-i.x,2)+Math.pow(a.y-i.y,2)),i=a;return{point:a,location:e}},d=function(t,e){var n=c(t,e),i=c(t.slice(0,t.length-1),e),o=i.y-n.y;n=i.x-n.x;return 0==o?1/0:Math.atan(o/n)};window.jsBezier={distanceFromCurve:r,gradientAtPoint:d,gradientAtPointAlongCurveFrom:function(t,e,n){return(e=u(t,e,n)).location>1&&(e.location=1),e.location<0&&(e.location=0),d(t,e.location)},nearestPointOnCurve:function(t,e){var n=r(t,e);return{point:s(e,e.length-1,n.location,null,null),location:n.location}},pointOnCurve:c,pointAlongCurveFrom:function(t,e,n){return u(t,e,n).point},perpendicularToCurveAt:function(t,e,n,i){return e=u(t,e,null==i?0:i),t=d(t,e.location),i=Math.atan(-1/t),t=n/2*Math.sin(i),n=n/2*Math.cos(i),[{x:e.point.x+n,y:e.point.y+t},{x:e.point.x-n,y:e.point.y-t}]},locationAlongCurveFrom:function(t,e,n){return u(t,e,n).location}}}();
